[{
    "message": "Clients are not required to present a certificate for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_client_certificates_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Clients are not required to present a certificate for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth?tabs=azurecli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Utilizing and maintaining client certificates will require additional work to obtain and manage replacement and key rotation.",
        "compliance": {
            "CIS-2.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.8.14",
                "1.2.8.15",
                "1.3.1.16",
                "1.3.1.17",
                "1.3.2.16",
                "1.3.2.17",
                "1.4.2.15",
                "1.4.2.16",
                "1.5.1.14",
                "1.5.1.15",
                "2.2.7.10",
                "3.5.1.1.5",
                "3.5.1.1.6",
                "3.5.1.3.12",
                "3.5.1.3.13",
                "3.6.1.2.5",
                "3.6.1.2.6",
                "3.6.1.3.5",
                "3.6.1.3.6",
                "3.6.1.4.5",
                "3.6.1.4.6",
                "3.6.1.5",
                "3.6.1.6",
                "3.7.1.6",
                "3.7.1.7",
                "3.7.2.5",
                "3.7.2.6",
                "3.7.4.6",
                "3.7.4.7",
                "3.7.6.5",
                "3.7.6.6",
                "3.7.7.5",
                "3.7.7.6",
                "4.2.1.1.14",
                "4.2.1.1.15",
                "4.2.1.10",
                "8.3.2.29",
                "A1.1.3.14",
                "A1.1.3.15"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
        "title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'",
        "types": [],
        "uid": "prowler-azure-app_client_certificates_on-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under the Settings section, Click on Configuration, then General settings 5. Set the option Client certificate mode located under Incoming client certificates to Require",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_7#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set clientCertEnabled=true",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-identity-management#im-4-authenticate-server-and-services"
        ]
    },
    "risk_details": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Clients are not required to present a certificate for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_client_certificates_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Clients are not required to present a certificate for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth?tabs=azurecli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Utilizing and maintaining client certificates will require additional work to obtain and manage replacement and key rotation.",
        "compliance": {
            "CIS-2.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.8.14",
                "1.2.8.15",
                "1.3.1.16",
                "1.3.1.17",
                "1.3.2.16",
                "1.3.2.17",
                "1.4.2.15",
                "1.4.2.16",
                "1.5.1.14",
                "1.5.1.15",
                "2.2.7.10",
                "3.5.1.1.5",
                "3.5.1.1.6",
                "3.5.1.3.12",
                "3.5.1.3.13",
                "3.6.1.2.5",
                "3.6.1.2.6",
                "3.6.1.3.5",
                "3.6.1.3.6",
                "3.6.1.4.5",
                "3.6.1.4.6",
                "3.6.1.5",
                "3.6.1.6",
                "3.7.1.6",
                "3.7.1.7",
                "3.7.2.5",
                "3.7.2.6",
                "3.7.4.6",
                "3.7.4.7",
                "3.7.6.5",
                "3.7.6.6",
                "3.7.7.5",
                "3.7.7.6",
                "4.2.1.1.14",
                "4.2.1.1.15",
                "4.2.1.10",
                "8.3.2.29",
                "A1.1.3.14",
                "A1.1.3.15"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
        "title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'",
        "types": [],
        "uid": "prowler-azure-app_client_certificates_on-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under the Settings section, Click on Configuration, then General settings 5. Set the option Client certificate mode located under Incoming client certificates to Require",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_7#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set clientCertEnabled=true",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-identity-management#im-4-authenticate-server-and-services"
        ]
    },
    "risk_details": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Clients are not required to present a certificate for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_client_certificates_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Clients are not required to present a certificate for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/app-service-web-configure-tls-mutual-auth?tabs=azurecli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Utilizing and maintaining client certificates will require additional work to obtain and manage replacement and key rotation.",
        "compliance": {
            "CIS-2.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.8.14",
                "1.2.8.15",
                "1.3.1.16",
                "1.3.1.17",
                "1.3.2.16",
                "1.3.2.17",
                "1.4.2.15",
                "1.4.2.16",
                "1.5.1.14",
                "1.5.1.15",
                "2.2.7.10",
                "3.5.1.1.5",
                "3.5.1.1.6",
                "3.5.1.3.12",
                "3.5.1.3.13",
                "3.6.1.2.5",
                "3.6.1.2.6",
                "3.6.1.3.5",
                "3.6.1.3.6",
                "3.6.1.4.5",
                "3.6.1.4.6",
                "3.6.1.5",
                "3.6.1.6",
                "3.7.1.6",
                "3.7.1.7",
                "3.7.2.5",
                "3.7.2.6",
                "3.7.4.6",
                "3.7.4.7",
                "3.7.6.5",
                "3.7.6.6",
                "3.7.7.5",
                "3.7.7.6",
                "4.2.1.1.14",
                "4.2.1.1.15",
                "4.2.1.10",
                "8.3.2.29",
                "A1.1.3.14",
                "A1.1.3.15"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
        "title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'",
        "types": [],
        "uid": "prowler-azure-app_client_certificates_on-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under the Settings section, Click on Configuration, then General settings 5. Set the option Client certificate mode located under Incoming client certificates to Require",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_7#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set clientCertEnabled=true",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-identity-management#im-4-authenticate-server-and-services"
        ]
    },
    "risk_details": "The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Authentication is set up for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_auth_is_set_up",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Authentication is set up for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/overview-authentication-authorization",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This is only required for App Services which require authentication. Enabling on site like a marketing or support website will prevent unauthenticated access which would be undesirable. Adding Authentication requirement will increase cost of App Service and require additional security components to facilitate the authentication",
        "compliance": {
            "CIS-2.0": [
                "9.1"
            ],
            "CIS-2.1": [
                "9.1"
            ],
            "CIS-3.0": [
                "9.2"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.",
        "title": "Ensure App Service Authentication is set up for apps in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_auth_is_set_up-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, click on Authentication 5. If no identity providers are set up, then click Add identity provider 6. Choose other parameters as per your requirements and click on Add",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_2#terraform",
            "az webapp auth update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-app-service-authentication.html",
            "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#website-contributor"
        ]
    },
    "risk_details": "By Enabling App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider (Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Authentication is set up for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_auth_is_set_up",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Authentication is set up for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/overview-authentication-authorization",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This is only required for App Services which require authentication. Enabling on site like a marketing or support website will prevent unauthenticated access which would be undesirable. Adding Authentication requirement will increase cost of App Service and require additional security components to facilitate the authentication",
        "compliance": {
            "CIS-2.0": [
                "9.1"
            ],
            "CIS-2.1": [
                "9.1"
            ],
            "CIS-3.0": [
                "9.2"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.",
        "title": "Ensure App Service Authentication is set up for apps in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_auth_is_set_up-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, click on Authentication 5. If no identity providers are set up, then click Add identity provider 6. Choose other parameters as per your requirements and click on Add",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_2#terraform",
            "az webapp auth update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-app-service-authentication.html",
            "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#website-contributor"
        ]
    },
    "risk_details": "By Enabling App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider (Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Authentication is set up for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_auth_is_set_up",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Authentication is set up for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/overview-authentication-authorization",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This is only required for App Services which require authentication. Enabling on site like a marketing or support website will prevent unauthenticated access which would be undesirable. Adding Authentication requirement will increase cost of App Service and require additional security components to facilitate the authentication",
        "compliance": {
            "CIS-2.0": [
                "9.1"
            ],
            "CIS-2.1": [
                "9.1"
            ],
            "CIS-3.0": [
                "9.2"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.",
        "title": "Ensure App Service Authentication is set up for apps in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_auth_is_set_up-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, click on Authentication 5. If no identity providers are set up, then click Add identity provider 6. Choose other parameters as per your requirements and click on Add",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_2#terraform",
            "az webapp auth update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-app-service-authentication.html",
            "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#website-contributor"
        ]
    },
    "risk_details": "By Enabling App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider (Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP is not redirected to HTTPS for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_http_is_redirected_to_https",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP is not redirected to HTTPS for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "When it is enabled, every incoming HTTP request is redirected to the HTTPS port. This means an extra level of security will be added to the HTTP requests made to the app.",
        "compliance": {
            "CIS-2.0": [
                "9.2"
            ],
            "CIS-2.1": [
                "9.2"
            ],
            "CIS-3.0": [
                "9.1"
            ],
            "PCI-4.0": [
                "1.2.5.1",
                "1.2.5.6",
                "1.2.5.9",
                "1.2.5.10",
                "2.2.5.1",
                "2.2.5.6",
                "2.2.5.9",
                "2.2.5.10",
                "2.2.7.1",
                "2.2.7.4",
                "2.2.7.12",
                "2.2.7.13",
                "4.2.1.1.3",
                "4.2.1.1.8",
                "4.2.1.1.17",
                "4.2.1.1.18",
                "4.2.1.1",
                "4.2.1.4",
                "4.2.1.12",
                "4.2.1.13",
                "8.3.2.1",
                "8.3.2.7",
                "8.3.2.31",
                "8.3.2.32"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.",
        "title": "Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_http_is_redirected_to_https-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. In the General Settings section, set the HTTPS Only to On 6. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_5#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set httpsOnly=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-https-only-traffic.html#",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "Enabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is therefore important to support HTTPS for the security benefits.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP is not redirected to HTTPS for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_http_is_redirected_to_https",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP is not redirected to HTTPS for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "When it is enabled, every incoming HTTP request is redirected to the HTTPS port. This means an extra level of security will be added to the HTTP requests made to the app.",
        "compliance": {
            "CIS-2.0": [
                "9.2"
            ],
            "CIS-2.1": [
                "9.2"
            ],
            "CIS-3.0": [
                "9.1"
            ],
            "PCI-4.0": [
                "1.2.5.1",
                "1.2.5.6",
                "1.2.5.9",
                "1.2.5.10",
                "2.2.5.1",
                "2.2.5.6",
                "2.2.5.9",
                "2.2.5.10",
                "2.2.7.1",
                "2.2.7.4",
                "2.2.7.12",
                "2.2.7.13",
                "4.2.1.1.3",
                "4.2.1.1.8",
                "4.2.1.1.17",
                "4.2.1.1.18",
                "4.2.1.1",
                "4.2.1.4",
                "4.2.1.12",
                "4.2.1.13",
                "8.3.2.1",
                "8.3.2.7",
                "8.3.2.31",
                "8.3.2.32"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.",
        "title": "Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_http_is_redirected_to_https-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. In the General Settings section, set the HTTPS Only to On 6. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_5#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set httpsOnly=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-https-only-traffic.html#",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "Enabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is therefore important to support HTTPS for the security benefits.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP is not redirected to HTTPS for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_http_is_redirected_to_https",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP is not redirected to HTTPS for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-https",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "When it is enabled, every incoming HTTP request is redirected to the HTTPS port. This means an extra level of security will be added to the HTTP requests made to the app.",
        "compliance": {
            "CIS-2.0": [
                "9.2"
            ],
            "CIS-2.1": [
                "9.2"
            ],
            "CIS-3.0": [
                "9.1"
            ],
            "PCI-4.0": [
                "1.2.5.1",
                "1.2.5.6",
                "1.2.5.9",
                "1.2.5.10",
                "2.2.5.1",
                "2.2.5.6",
                "2.2.5.9",
                "2.2.5.10",
                "2.2.7.1",
                "2.2.7.4",
                "2.2.7.12",
                "2.2.7.13",
                "4.2.1.1.3",
                "4.2.1.1.8",
                "4.2.1.1.17",
                "4.2.1.1.18",
                "4.2.1.1",
                "4.2.1.4",
                "4.2.1.12",
                "4.2.1.13",
                "8.3.2.1",
                "8.3.2.7",
                "8.3.2.31",
                "8.3.2.32"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.",
        "title": "Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Service",
        "types": [],
        "uid": "prowler-azure-app_ensure_http_is_redirected_to_https-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. In the General Settings section, set the HTTPS Only to On 6. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_5#terraform",
            "az webapp update --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --set httpsOnly=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-https-only-traffic.html#",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "Enabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is therefore important to support HTTPS for the security benefits.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP/2.0 is not enabled for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_using_http20",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP/2.0 is not enabled for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-common?tabs=portal#general-settings",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-posture-vulnerability-management#pv-7-rapidly-and-automatically-remediate-software-vulnerabilities",
        "compliance": {
            "CIS-2.0": [
                "9.9"
            ],
            "CIS-2.1": [
                "9.8"
            ],
            "CIS-3.0": [
                "9.10"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.",
        "title": "Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App",
        "types": [],
        "uid": "prowler-azure-app_ensure_using_http20-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. Set HTTP version to 2.0 under General settings",
        "references": [
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --http20-enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-http-2-for-app-service-web-applications.html",
            "https://azure.microsoft.com/en-us/blog/announcing-http-2-support-in-azure-app-service/"
        ]
    },
    "risk_details": "Newer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP/2.0 is not enabled for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_using_http20",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP/2.0 is not enabled for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-common?tabs=portal#general-settings",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-posture-vulnerability-management#pv-7-rapidly-and-automatically-remediate-software-vulnerabilities",
        "compliance": {
            "CIS-2.0": [
                "9.9"
            ],
            "CIS-2.1": [
                "9.8"
            ],
            "CIS-3.0": [
                "9.10"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.",
        "title": "Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App",
        "types": [],
        "uid": "prowler-azure-app_ensure_using_http20-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. Set HTTP version to 2.0 under General settings",
        "references": [
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --http20-enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-http-2-for-app-service-web-applications.html",
            "https://azure.microsoft.com/en-us/blog/announcing-http-2-support-in-azure-app-service/"
        ]
    },
    "risk_details": "Newer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "HTTP/2.0 is not enabled for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ensure_using_http20",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "HTTP/2.0 is not enabled for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-common?tabs=portal#general-settings",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-posture-vulnerability-management#pv-7-rapidly-and-automatically-remediate-software-vulnerabilities",
        "compliance": {
            "CIS-2.0": [
                "9.9"
            ],
            "CIS-2.1": [
                "9.8"
            ],
            "CIS-3.0": [
                "9.10"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.",
        "title": "Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App",
        "types": [],
        "uid": "prowler-azure-app_ensure_using_http20-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Configuration 5. Set HTTP version to 2.0 under General settings",
        "references": [
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --http20-enabled true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-http-2-for-app-service-web-applications.html",
            "https://azure.microsoft.com/en-us/blog/announcing-http-2-support-in-azure-app-service/"
        ]
    },
    "risk_details": "Newer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "FTP is enabled for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ftp_deployment_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "FTP is enabled for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Any deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.",
        "compliance": {
            "CIS-2.0": [
                "9.10"
            ],
            "CIS-2.1": [
                "9.9"
            ],
            "CIS-3.0": [
                "9.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.",
        "title": "Ensure FTP deployments are Disabled",
        "types": [],
        "uid": "prowler-azure-app_ftp_deployment_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to the Azure Portal 2. Select App Services 3. Click on an app 4. Select Settings and then Configuration 5. Under General Settings, for the Platform Settings, the FTP state should be set to Disabled or FTPS Only",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-ftp-deployments-are-disabled#terraform",
            "az webapp config set --resource-group <resource group name> --name <app name> --ftps-state [disabled|FtpsOnly]",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/ftp-access-disabled.html"
        ]
    },
    "risk_details": "Azure FTP deployment endpoints are public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "FTP is enabled for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ftp_deployment_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "FTP is enabled for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Any deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.",
        "compliance": {
            "CIS-2.0": [
                "9.10"
            ],
            "CIS-2.1": [
                "9.9"
            ],
            "CIS-3.0": [
                "9.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.",
        "title": "Ensure FTP deployments are Disabled",
        "types": [],
        "uid": "prowler-azure-app_ftp_deployment_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to the Azure Portal 2. Select App Services 3. Click on an app 4. Select Settings and then Configuration 5. Under General Settings, for the Platform Settings, the FTP state should be set to Disabled or FTPS Only",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-ftp-deployments-are-disabled#terraform",
            "az webapp config set --resource-group <resource group name> --name <app name> --ftps-state [disabled|FtpsOnly]",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/ftp-access-disabled.html"
        ]
    },
    "risk_details": "Azure FTP deployment endpoints are public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "FTP is enabled for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_ftp_deployment_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "FTP is enabled for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/deploy-ftp?tabs=portal",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Any deployment workflows that rely on FTP or FTPs rather than the WebDeploy or HTTPs endpoints may be affected.",
        "compliance": {
            "CIS-2.0": [
                "9.10"
            ],
            "CIS-2.1": [
                "9.9"
            ],
            "CIS-3.0": [
                "9.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.3.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.",
        "title": "Ensure FTP deployments are Disabled",
        "types": [],
        "uid": "prowler-azure-app_ftp_deployment_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to the Azure Portal 2. Select App Services 3. Click on an app 4. Select Settings and then Configuration 5. Under General Settings, for the Platform Settings, the FTP state should be set to Disabled or FTPS Only",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-ftp-deployments-are-disabled#terraform",
            "az webapp config set --resource-group <resource group name> --name <app name> --ftps-state [disabled|FtpsOnly]",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/ftp-access-disabled.html"
        ]
    },
    "risk_details": "Azure FTP deployment endpoints are public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App as-01 does not have a diagnostic setting in subscription Azure for Students.",
    "metadata": {
        "event_code": "app_http_logs_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "App as-01 does not have a diagnostic setting in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-3-enable-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Log consumption and processing will incur additional cost.",
        "compliance": {
            "CIS-2.0": [
                "5.1.7"
            ],
            "CIS-2.1": [
                "5.1.6"
            ],
            "CIS-3.0": [
                "6.1.6"
            ],
            "PCI-4.0": [
                "10.2.1.1.1",
                "10.2.1.1.2",
                "10.2.1.1.4",
                "10.2.1.1.18",
                "10.2.1.1.19",
                "10.2.1.2.1",
                "10.2.1.2.2",
                "10.2.1.2.4",
                "10.2.1.2.15",
                "10.2.1.2.16",
                "10.2.1.3.1",
                "10.2.1.3.2",
                "10.2.1.3.4",
                "10.2.1.3.15",
                "10.2.1.3.16",
                "10.2.1.4.1",
                "10.2.1.4.2",
                "10.2.1.4.4",
                "10.2.1.4.15",
                "10.2.1.4.16",
                "10.2.1.5.1",
                "10.2.1.5.2",
                "10.2.1.5.4",
                "10.2.1.5.15",
                "10.2.1.5.16",
                "10.2.1.6.1",
                "10.2.1.6.2",
                "10.2.1.6.4",
                "10.2.1.6.15",
                "10.2.1.6.16",
                "10.2.1.7.1",
                "10.2.1.7.2",
                "10.2.1.7.4",
                "10.2.1.7.15",
                "10.2.1.7.16",
                "10.2.1.1",
                "10.2.1.2",
                "10.2.1.4",
                "10.2.1.15",
                "10.2.1.16",
                "10.2.2.1",
                "10.2.2.2",
                "10.2.2.4",
                "10.2.2.15",
                "10.2.2.16",
                "10.3.1.1",
                "10.3.1.2",
                "10.3.1.4",
                "10.3.1.15",
                "10.3.1.16",
                "10.6.3.1",
                "10.6.3.2",
                "10.6.3.4",
                "10.6.3.19",
                "10.6.3.20",
                "5.3.4.1",
                "5.3.4.2",
                "5.3.4.4",
                "5.3.4.18",
                "5.3.4.19",
                "A1.2.1.1",
                "A1.2.1.2",
                "A1.2.1.4",
                "A1.2.1.19",
                "A1.2.1.20"
            ],
            "ENS-RD2022": [
                "op.mon.3.az.nw.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AppServiceHTTPLogs diagnostic log category for Azure App Service instances to ensure all http requests are captured and centrally logged.",
        "title": "Ensure that logging for Azure AppService 'HTTP logs' is enabled",
        "types": [],
        "uid": "prowler-azure-app_http_logs_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to App Services For each App Service: 2. Go to Diagnostic Settings 3. Click Add Diagnostic Setting 4. Check the checkbox next to 'HTTP logs' 5. Configure a destination based on your specific logging consumption capability (for example Stream to an event hub and then consuming with SIEM integration for Event Hub logging).",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/ensure-that-app-service-enables-http-logging#terraform",
            "https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs"
        ]
    },
    "risk_details": "Capturing web requests can be important supporting information for security analysts performing monitoring and incident response activities. Once logging, these logs can be ingested into SIEM or other central aggregation point for the organization.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App as-02 does not have a diagnostic setting in subscription Azure for Students.",
    "metadata": {
        "event_code": "app_http_logs_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "App as-02 does not have a diagnostic setting in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-3-enable-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Log consumption and processing will incur additional cost.",
        "compliance": {
            "CIS-2.0": [
                "5.1.7"
            ],
            "CIS-2.1": [
                "5.1.6"
            ],
            "CIS-3.0": [
                "6.1.6"
            ],
            "PCI-4.0": [
                "10.2.1.1.1",
                "10.2.1.1.2",
                "10.2.1.1.4",
                "10.2.1.1.18",
                "10.2.1.1.19",
                "10.2.1.2.1",
                "10.2.1.2.2",
                "10.2.1.2.4",
                "10.2.1.2.15",
                "10.2.1.2.16",
                "10.2.1.3.1",
                "10.2.1.3.2",
                "10.2.1.3.4",
                "10.2.1.3.15",
                "10.2.1.3.16",
                "10.2.1.4.1",
                "10.2.1.4.2",
                "10.2.1.4.4",
                "10.2.1.4.15",
                "10.2.1.4.16",
                "10.2.1.5.1",
                "10.2.1.5.2",
                "10.2.1.5.4",
                "10.2.1.5.15",
                "10.2.1.5.16",
                "10.2.1.6.1",
                "10.2.1.6.2",
                "10.2.1.6.4",
                "10.2.1.6.15",
                "10.2.1.6.16",
                "10.2.1.7.1",
                "10.2.1.7.2",
                "10.2.1.7.4",
                "10.2.1.7.15",
                "10.2.1.7.16",
                "10.2.1.1",
                "10.2.1.2",
                "10.2.1.4",
                "10.2.1.15",
                "10.2.1.16",
                "10.2.2.1",
                "10.2.2.2",
                "10.2.2.4",
                "10.2.2.15",
                "10.2.2.16",
                "10.3.1.1",
                "10.3.1.2",
                "10.3.1.4",
                "10.3.1.15",
                "10.3.1.16",
                "10.6.3.1",
                "10.6.3.2",
                "10.6.3.4",
                "10.6.3.19",
                "10.6.3.20",
                "5.3.4.1",
                "5.3.4.2",
                "5.3.4.4",
                "5.3.4.18",
                "5.3.4.19",
                "A1.2.1.1",
                "A1.2.1.2",
                "A1.2.1.4",
                "A1.2.1.19",
                "A1.2.1.20"
            ],
            "ENS-RD2022": [
                "op.mon.3.az.nw.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AppServiceHTTPLogs diagnostic log category for Azure App Service instances to ensure all http requests are captured and centrally logged.",
        "title": "Ensure that logging for Azure AppService 'HTTP logs' is enabled",
        "types": [],
        "uid": "prowler-azure-app_http_logs_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to App Services For each App Service: 2. Go to Diagnostic Settings 3. Click Add Diagnostic Setting 4. Check the checkbox next to 'HTTP logs' 5. Configure a destination based on your specific logging consumption capability (for example Stream to an event hub and then consuming with SIEM integration for Event Hub logging).",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/ensure-that-app-service-enables-http-logging#terraform",
            "https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs"
        ]
    },
    "risk_details": "Capturing web requests can be important supporting information for security analysts performing monitoring and incident response activities. Once logging, these logs can be ingested into SIEM or other central aggregation point for the organization.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App as-03 does not have a diagnostic setting in subscription Azure for Students.",
    "metadata": {
        "event_code": "app_http_logs_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "App as-03 does not have a diagnostic setting in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-3-enable-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Log consumption and processing will incur additional cost.",
        "compliance": {
            "CIS-2.0": [
                "5.1.7"
            ],
            "CIS-2.1": [
                "5.1.6"
            ],
            "CIS-3.0": [
                "6.1.6"
            ],
            "PCI-4.0": [
                "10.2.1.1.1",
                "10.2.1.1.2",
                "10.2.1.1.4",
                "10.2.1.1.18",
                "10.2.1.1.19",
                "10.2.1.2.1",
                "10.2.1.2.2",
                "10.2.1.2.4",
                "10.2.1.2.15",
                "10.2.1.2.16",
                "10.2.1.3.1",
                "10.2.1.3.2",
                "10.2.1.3.4",
                "10.2.1.3.15",
                "10.2.1.3.16",
                "10.2.1.4.1",
                "10.2.1.4.2",
                "10.2.1.4.4",
                "10.2.1.4.15",
                "10.2.1.4.16",
                "10.2.1.5.1",
                "10.2.1.5.2",
                "10.2.1.5.4",
                "10.2.1.5.15",
                "10.2.1.5.16",
                "10.2.1.6.1",
                "10.2.1.6.2",
                "10.2.1.6.4",
                "10.2.1.6.15",
                "10.2.1.6.16",
                "10.2.1.7.1",
                "10.2.1.7.2",
                "10.2.1.7.4",
                "10.2.1.7.15",
                "10.2.1.7.16",
                "10.2.1.1",
                "10.2.1.2",
                "10.2.1.4",
                "10.2.1.15",
                "10.2.1.16",
                "10.2.2.1",
                "10.2.2.2",
                "10.2.2.4",
                "10.2.2.15",
                "10.2.2.16",
                "10.3.1.1",
                "10.3.1.2",
                "10.3.1.4",
                "10.3.1.15",
                "10.3.1.16",
                "10.6.3.1",
                "10.6.3.2",
                "10.6.3.4",
                "10.6.3.19",
                "10.6.3.20",
                "5.3.4.1",
                "5.3.4.2",
                "5.3.4.4",
                "5.3.4.18",
                "5.3.4.19",
                "A1.2.1.1",
                "A1.2.1.2",
                "A1.2.1.4",
                "A1.2.1.19",
                "A1.2.1.20"
            ],
            "ENS-RD2022": [
                "op.mon.3.az.nw.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AppServiceHTTPLogs diagnostic log category for Azure App Service instances to ensure all http requests are captured and centrally logged.",
        "title": "Ensure that logging for Azure AppService 'HTTP logs' is enabled",
        "types": [],
        "uid": "prowler-azure-app_http_logs_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Go to App Services For each App Service: 2. Go to Diagnostic Settings 3. Click Add Diagnostic Setting 4. Check the checkbox next to 'HTTP logs' 5. Configure a destination based on your specific logging consumption capability (for example Stream to an event hub and then consuming with SIEM integration for Event Hub logging).",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/ensure-that-app-service-enables-http-logging#terraform",
            "https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs"
        ]
    },
    "risk_details": "Capturing web requests can be important supporting information for security analysts performing monitoring and incident response activities. Once logging, these logs can be ingested into SIEM or other central aggregation point for the organization.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There are no AppInsight configured in subscription Azure for Students.",
    "metadata": {
        "event_code": "appinsights_ensure_is_configured",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no AppInsight configured in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Because Application Insights relies on a Log Analytics Workspace, an organization will incur additional expenses when using this service.",
        "compliance": {
            "CIS-2.0": [
                "5.3.1"
            ],
            "CIS-2.1": [
                "5.3.1"
            ],
            "CIS-3.0": [
                "6.3.1"
            ],
            "PCI-4.0": [
                "10.2.1.1.3",
                "10.2.1.2.3",
                "10.2.1.3.3",
                "10.2.1.4.3",
                "10.2.1.5.3",
                "10.2.1.6.3",
                "10.2.1.7.3",
                "10.2.1.3",
                "10.2.2.3",
                "10.4.1.1.1",
                "10.4.1.1",
                "10.4.2.1",
                "10.6.3.3",
                "10.7.1.1",
                "10.7.2.1",
                "5.3.4.3",
                "A1.2.1.3",
                "A3.3.1.1",
                "A3.5.1.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.2"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.13"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Application Insights within Azure act as an Application Performance Monitoring solution providing valuable data into how well an application performs and additional information when performing incident response. The types of log data collected include application metrics, telemetry data, and application trace logging data providing organizations with detailed information about application activity and application transactions. Both data sets help organizations adopt a proactive and retroactive means to handle security and performance related metrics within their modern applications.",
        "title": "Ensure Application Insights are Configured.",
        "types": [],
        "uid": "prowler-azure-appinsights_ensure_is_configured-31661dbb-923c-429d-b434-b6bd19dcd287-global-AppInsights"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "appinsights"
            },
            "labels": [],
            "name": "AppInsights",
            "type": "Microsoft.Insights/components",
            "uid": "AppInsights"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to Application Insights 2. Under the Basics tab within the PROJECT DETAILS section, select the Subscription 3. Select the Resource group 4. Within the INSTANCE DETAILS, enter a Name 5. Select a Region 6. Next to Resource Mode, select Workspace-based 7. Within the WORKSPACE DETAILS, select the Subscription for the log analytics workspace 8. Select the appropriate Log Analytics Workspace 9. Click Next:Tags > 10. Enter the appropriate Tags as Name, Value pairs. 11. Click Next:Review+Create 12. Click Create.",
        "references": [
            "az monitor app-insights component create --app <app name> --resource-group <resource group name> --location <location> --kind 'web' --retention-time <INT days to retain logs> --workspace <log analytics workspace ID> -- subscription <subscription ID>",
            "https://www.tenable.com/audits/items/CIS_Microsoft_Azure_Foundations_v2.0.0_L2.audit:8a7a608d180042689ad9d3f16aa359f1"
        ]
    },
    "risk_details": "Configuring Application Insights provides additional data not found elsewhere within Azure as part of a much larger logging and monitoring program within an organization's Information Security practice. The types and contents of these logs will act as both a potential cost saving measure (application performance) and a means to potentially confirm the source of a potential incident (trace logging). Metrics and Telemetry data provide organizations with a proactive approach to cost savings by monitoring an application's performance, while the trace logging data provides necessary details in a reactive incident response scenario by helping organizations identify the potential source of an incident within their application.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Minimum TLS version is not set to 1.2 for app 'as-01' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Minimum TLS version is not set to 1.2 for app 'as-01' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, TLS Version feature will be set to 1.2 when a new app is created using the command-line tool or Azure Portal console.",
        "compliance": {
            "CIS-2.0": [
                "9.3"
            ],
            "CIS-2.1": [
                "9.3"
            ],
            "CIS-3.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.5.2",
                "1.2.5.3",
                "2.2.5.2",
                "2.2.5.3",
                "2.2.7.2",
                "4.2.1.1.6",
                "4.2.1.2",
                "8.3.2.5"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.",
        "title": "Ensure Web App is using the latest version of TLS encryption",
        "types": [],
        "uid": "prowler-azure-app_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on TLS/SSL settings 5. Under the Bindings pane, ensure that Minimum TLS Version set to 1.2 under Protocol Settings",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_6#terraform",
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --min-tls-version 1.2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/latest-version-of-tls-encryption-in-use.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Minimum TLS version is not set to 1.2 for app 'as-02' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Minimum TLS version is not set to 1.2 for app 'as-02' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, TLS Version feature will be set to 1.2 when a new app is created using the command-line tool or Azure Portal console.",
        "compliance": {
            "CIS-2.0": [
                "9.3"
            ],
            "CIS-2.1": [
                "9.3"
            ],
            "CIS-3.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.5.2",
                "1.2.5.3",
                "2.2.5.2",
                "2.2.5.3",
                "2.2.7.2",
                "4.2.1.1.6",
                "4.2.1.2",
                "8.3.2.5"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.",
        "title": "Ensure Web App is using the latest version of TLS encryption",
        "types": [],
        "uid": "prowler-azure-app_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on TLS/SSL settings 5. Under the Bindings pane, ensure that Minimum TLS Version set to 1.2 under Protocol Settings",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_6#terraform",
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --min-tls-version 1.2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/latest-version-of-tls-encryption-in-use.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Minimum TLS version is not set to 1.2 for app 'as-03' in subscription 'Azure for Students'.",
    "metadata": {
        "event_code": "app_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Minimum TLS version is not set to 1.2 for app 'as-03' in subscription 'Azure for Students'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-ssl-bindings#enforce-tls-versions",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, TLS Version feature will be set to 1.2 when a new app is created using the command-line tool or Azure Portal console.",
        "compliance": {
            "CIS-2.0": [
                "9.3"
            ],
            "CIS-2.1": [
                "9.3"
            ],
            "CIS-3.0": [
                "9.4"
            ],
            "PCI-4.0": [
                "1.2.5.2",
                "1.2.5.3",
                "2.2.5.2",
                "2.2.5.3",
                "2.2.7.2",
                "4.2.1.1.6",
                "4.2.1.2",
                "8.3.2.5"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.",
        "title": "Ensure Web App is using the latest version of TLS encryption",
        "types": [],
        "uid": "prowler-azure-app_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites/config",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on TLS/SSL settings 5. Under the Bindings pane, ensure that Minimum TLS Version set to 1.2 under Protocol Settings",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_6#terraform",
            "az webapp config set --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME> --min-tls-version 1.2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/latest-version-of-tls-encryption-in-use.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-3-encrypt-sensitive-data-in-transit"
        ]
    },
    "risk_details": "App service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App 'as-01' in subscription 'Azure for Students' has an identity configured.",
    "metadata": {
        "event_code": "app_register_with_identity",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "App 'as-01' in subscription 'Azure for Students' has an identity configured.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-authentication-provider-aad?tabs=workforce-tenant",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Managed service identity via Azure AD is disabled.",
        "compliance": {
            "CIS-2.0": [
                "9.5"
            ],
            "CIS-2.1": [
                "9.4"
            ],
            "CIS-3.0": [
                "9.5"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services securely without the need for usernames and passwords.",
        "title": "Ensure that Register with Azure Active Directory is enabled on App Service",
        "types": [],
        "uid": "prowler-azure-app_register_with_identity-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01",
                    "name": "as-01",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01/config/web",
                        "name": "as-01",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-01",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Identity 5. Under the System assigned pane, set Status to On",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-iam-policies/bc_azr_iam_1#terraform",
            "az webapp identity assign --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME>",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-registration-with-microsoft-entra-id.html",
            "https://learn.microsoft.com/en-us/azure/app-service/scenario-secure-app-authentication-app-service"
        ]
    },
    "risk_details": "App Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App 'as-02' in subscription 'Azure for Students' has an identity configured.",
    "metadata": {
        "event_code": "app_register_with_identity",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "App 'as-02' in subscription 'Azure for Students' has an identity configured.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-authentication-provider-aad?tabs=workforce-tenant",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Managed service identity via Azure AD is disabled.",
        "compliance": {
            "CIS-2.0": [
                "9.5"
            ],
            "CIS-2.1": [
                "9.4"
            ],
            "CIS-3.0": [
                "9.5"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services securely without the need for usernames and passwords.",
        "title": "Ensure that Register with Azure Active Directory is enabled on App Service",
        "types": [],
        "uid": "prowler-azure-app_register_with_identity-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-02"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02",
                    "name": "as-02",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02/config/web",
                        "name": "as-02",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-02",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-02"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Identity 5. Under the System assigned pane, set Status to On",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-iam-policies/bc_azr_iam_1#terraform",
            "az webapp identity assign --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME>",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-registration-with-microsoft-entra-id.html",
            "https://learn.microsoft.com/en-us/azure/app-service/scenario-secure-app-authentication-app-service"
        ]
    },
    "risk_details": "App Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "App 'as-03' in subscription 'Azure for Students' has an identity configured.",
    "metadata": {
        "event_code": "app_register_with_identity",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "App 'as-03' in subscription 'Azure for Students' has an identity configured.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/app-service/configure-authentication-provider-aad?tabs=workforce-tenant",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Managed service identity via Azure AD is disabled.",
        "compliance": {
            "CIS-2.0": [
                "9.5"
            ],
            "CIS-2.1": [
                "9.4"
            ],
            "CIS-3.0": [
                "9.5"
            ],
            "ENS-RD2022": [
                "op.acc.1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services securely without the need for usernames and passwords.",
        "title": "Ensure that Register with Azure Active Directory is enabled on App Service",
        "types": [],
        "uid": "prowler-azure-app_register_with_identity-31661dbb-923c-429d-b434-b6bd19dcd287-West Europe-as-03"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "West Europe",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03",
                    "name": "as-03",
                    "configurations": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03/config/web",
                        "name": "as-03",
                        "linux_fx_version": "",
                        "java_version": null,
                        "php_version": "",
                        "python_version": "",
                        "http20_enabled": false,
                        "ftps_state": "AllAllowed",
                        "min_tls_version": "1.1"
                    },
                    "identity": {
                        "principal_id": "",
                        "tenant_id": "",
                        "type": ""
                    },
                    "location": "West Europe",
                    "client_cert_mode": "Ignore",
                    "auth_enabled": true,
                    "https_only": false,
                    "monitor_diagnostic_settings": [],
                    "kind": "app,linux"
                }
            },
            "group": {
                "name": "app"
            },
            "labels": [],
            "name": "as-03",
            "type": "Microsoft.Web/sites",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Web/sites/as-03"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "West Europe"
    },
    "remediation": {
        "desc": "1. Login to Azure Portal using https://portal.azure.com 2. Go to App Services 3. Click on each App 4. Under Setting section, Click on Identity 5. Under the System assigned pane, set Status to On",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-iam-policies/bc_azr_iam_1#terraform",
            "az webapp identity assign --resource-group <RESOURCE_GROUP_NAME> --name <APP_NAME>",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/AppService/enable-registration-with-microsoft-entra-id.html",
            "https://learn.microsoft.com/en-us/azure/app-service/scenario-secure-app-authentication-app-service"
        ]
    },
    "risk_details": "App Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Container Registry acr01332 from subscription Azure for Students has its admin user enabled.",
    "metadata": {
        "event_code": "containerregistry_admin_user_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Container Registry acr01332 from subscription Azure for Students has its admin user enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-authentication?tabs=azure-cli#admin-account",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "The transition away from using the admin user to RBAC will facilitate a more secure and manageable access model, minimizing the potential risk of unauthorized access to your container images.",
        "compliance": {}
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that the admin user is disabled and Role-Based Access Control (RBAC) is used instead since it could grant unrestricted access to the registry",
        "title": "Ensure admin user is disabled for Azure Container Registry",
        "types": [],
        "uid": "prowler-azure-containerregistry_admin_user_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-acr01332"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332",
                    "name": "acr01332",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "sku": "Standard",
                    "login_server": "acr01332.azurecr.io",
                    "public_network_access": true,
                    "admin_user_enabled": true,
                    "monitor_diagnostic_settings": [],
                    "private_endpoint_connections": []
                }
            },
            "group": {
                "name": "containerregistry"
            },
            "labels": [],
            "name": "acr01332",
            "type": "ContainerRegistry",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Disable the admin user on Azure Container Registry through the Azure Portal: 1. Navigate to your Container Registry. 2. In the settings, select 'Access keys'. 3. Ensure the 'Admin user' checkbox is not ticked. For all actions relying on registry access, switch to using Role-Based Access Control.",
        "references": [
            "az acr update --name <RegistryName> --resource-group <ResourceGroupName> --admin-enabled false",
            "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-authentication?tabs=azure-cli#admin-account"
        ]
    },
    "risk_details": "If the admin user is enabled, it may lead to unauthorized access to the container registry and its resources, which could compromise the confidentiality, integrity, and availability of the images stored within.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Container Registry acr01332 from subscription Azure for Students allows unrestricted network access.",
    "metadata": {
        "event_code": "containerregistry_not_publicly_accessible",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Container Registry acr01332 from subscription Azure for Students allows unrestricted network access.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-access-selected-networks",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This feature is only available for Premium SKU registries.",
        "compliance": {
            "ISO27001-2022": [
                "A.8.1",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that public network access to the Azure Container Registry is restricted.",
        "title": "Restrict public network access to the Container Registry",
        "types": [],
        "uid": "prowler-azure-containerregistry_not_publicly_accessible-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-acr01332"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332",
                    "name": "acr01332",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "sku": "Standard",
                    "login_server": "acr01332.azurecr.io",
                    "public_network_access": true,
                    "admin_user_enabled": true,
                    "monitor_diagnostic_settings": [],
                    "private_endpoint_connections": []
                }
            },
            "group": {
                "name": "containerregistry"
            },
            "labels": [],
            "name": "acr01332",
            "type": "ContainerRegistry",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that the necessary virtual network configurations or IP rules are in place to allow access from required services once public access is restricted. Review the network access settings regularly to maintain a secure environment. To restrict public network access to your Azure Container Registry: 1. Navigate to your Container Registry in the Azure Portal. 2. Under 'Settings'->'Networking', configure the 'Public network access' settings to 'Disabled'. 3. Set up virtual network service endpoints or private endpoints as needed for secure access. 4. Review and adjust IP access rules as necessary.",
        "references": [
            "az acr update --name <registry-name> --default-action Deny",
            "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-access-selected-networks"
        ]
    },
    "risk_details": "Public accessibility exposes the Container Registry to potential attacks, unauthorized usage, and data breaches. Restricting access minimizes the surface area for attacks and ensures that only authorized networks can access the registry.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Container Registry acr01332 from subscription Azure for Students does not use a private link.",
    "metadata": {
        "event_code": "containerregistry_uses_private_link",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Container Registry acr01332 from subscription Azure for Students does not use a private link.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/private-link/private-link-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This feature is only available for Premium SKU registries.",
        "compliance": {}
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that a private link is used for accessing the Azure Container Registry to enhance security and restrict access to the registry over the public internet.",
        "title": "Ensure to use a private link for accessing the Azure Container Registry",
        "types": [],
        "uid": "prowler-azure-containerregistry_uses_private_link-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-acr01332"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332",
                    "name": "acr01332",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "sku": "Standard",
                    "login_server": "acr01332.azurecr.io",
                    "public_network_access": true,
                    "admin_user_enabled": true,
                    "monitor_diagnostic_settings": [],
                    "private_endpoint_connections": []
                }
            },
            "group": {
                "name": "containerregistry"
            },
            "labels": [],
            "name": "acr01332",
            "type": "ContainerRegistry",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.ContainerRegistry/registries/acr01332"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Create a private link for Azure Container Registry through the Azure Portal: 1. Navigate to your Container Registry. 2. In the settings, select 'Networking'. 3. Select 'Private access'. 4. Configure a private endpoint for the registry.",
        "references": [
            "az network private-endpoint create  --connection-name <ConnectionName> --resource-group <ResourceGroupName> --name <Name> --private-connection-resource-id <RegistryId> --vnet-name <VnetName> --subnet <SubnetName> --group-ids registry",
            "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-private-link"
        ]
    },
    "risk_details": "Without using a private link, the Azure Container Registry may be exposed to the public internet, increasing the risk of unauthorized access and potential data breaches.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not another correct email configured for subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_additional_email_configured_with_a_security_contact",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not another correct email configured for subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.19"
            ],
            "CIS-2.1": [
                "2.1.18"
            ],
            "CIS-3.0": [
                "3.1.13"
            ],
            "PCI-4.0": [
                "A1.2.3.1"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.1"
            ],
            "ISO27001-2022": [
                "A.5.5"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.19"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.",
        "title": "Ensure 'Additional email addresses' is Configured with a Security Contact Email",
        "types": [],
        "uid": "prowler-azure-defender_additional_email_configured_with_a_security_contact-31661dbb-923c-429d-b434-b6bd19dcd287-global-default"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default",
                    "name": "default",
                    "emails": "",
                    "phone": "",
                    "alert_notifications_minimal_severity": "",
                    "alert_notifications_state": "",
                    "notified_roles": [
                        ""
                    ],
                    "notified_roles_state": ""
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "default",
            "type": "AzureEmailNotifications",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. From Azure Home select the Portal Menu 2. Select Microsoft Defender for Cloud 3. Click on Environment Settings 4. Click on the appropriate Management Group, Subscription, or Workspace 5. Click on Email notifications 6. Enter a valid security contact email address (or multiple addresses separated by commas) in the Additional email addresses field 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-security-contact-emails-is-set#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/security-contact-email.html",
            "https://learn.microsoft.com/en-us/rest/api/defenderforcloud/security-contacts/list?view=rest-defenderforcloud-2020-01-01-preview&tabs=HTTP"
        ]
    },
    "risk_details": "Microsoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender Auto Provisioning Log Analytics Agents from subscription Azure for Students is set to OFF.",
    "metadata": {
        "event_code": "defender_auto_provisioning_log_analytics_agent_vms_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender Auto Provisioning Log Analytics Agents from subscription Azure for Students is set to OFF.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security-center/security-center-data-security",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.15"
            ],
            "CIS-2.1": [
                "2.1.14"
            ],
            "CIS-3.0": [
                "3.1.1.1"
            ],
            "ENS-RD2022": [
                "op.mon.3.r2.az.de.1",
                "mp.s.4.r1.az.nt.5"
            ],
            "MITRE-ATTACK": [
                "T1190"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.",
        "title": "Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'",
        "types": [],
        "uid": "prowler-azure-defender_auto_provisioning_log_analytics_agent_vms_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-default"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/autoProvisioningSettings/default",
                    "resource_name": "default",
                    "resource_type": "Microsoft.Security/autoProvisioningSettings",
                    "auto_provision": "Off"
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "default",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/autoProvisioningSettings/default"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Ensure comprehensive visibility into possible security vulnerabilities, including missing updates, misconfigured operating system security settings, and active threats, allowing for timely mitigation and improved overall security posture",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/SecurityCenter/automatic-provisioning-of-monitoring-agent.html",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/monitoring-components"
        ]
    },
    "risk_details": "Missing critical security information about your Azure VMs, such as security alerts, security recommendations, and change tracking.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Container image scan is disabled in subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_container_images_scan_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Container image scan is disabled in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-check-health",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "When using an Azure container registry, you might occasionally encounter problems. For example, you might not be able to pull a container image because of an issue with Docker in your local environment. Or, a network issue might prevent you from connecting to the registry.",
        "compliance": {
            "PCI-4.0": [
                "11.3.1.2.1",
                "11.3.1.3.3",
                "11.3.1.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1525"
            ],
            "ISO27001-2022": [
                "A.5.19",
                "A.5.21",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Scan images being deployed to Azure (AKS) for vulnerabilities. Vulnerability scanning for images stored in Azure Container Registry is generally available in Azure Security Center. This capability is powered by Qualys, a leading provider of information security. When you push an image to Container Registry, Security Center automatically scans it, then checks for known vulnerabilities in packages or dependencies defined in the file. When the scan completes (after about 10 minutes), Security Center provides details and a security classification for each vulnerability detected, along with guidance on how to remediate issues and protect vulnerable attack surfaces.",
        "title": "Ensure Image Vulnerability Scanning using Azure Defender image scanning or a third party provider",
        "types": [],
        "uid": "prowler-azure-defender_container_images_scan_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-global-Containers"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Containers",
                    "resource_name": "Containers",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Containers",
            "type": "Microsoft.Security",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Containers"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "",
        "references": [
            "https://learn.microsoft.com/en-us/azure/container-registry/scan-images-defender"
        ]
    },
    "risk_details": "Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to local cloud resources. Azure Defender and other third party products allow images to be scanned for known vulnerabilities.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for App Services from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_app_services_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for App Services from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.1": [
                "2.1.2"
            ],
            "CIS-3.0": [
                "3.1.6.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1059",
                "T1204",
                "T1552",
                "T1486",
                "T1499",
                "T1496",
                "T1087"
            ],
            "ISO27001-2022": [
                "A.5.19",
                "A.5.21",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for App Services Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for App Services Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_app_services_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan App Services"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/AppServices",
                    "resource_name": "AppServices",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan App Services",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/AppServices"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-app-service#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-app-service.html"
        ]
    },
    "risk_details": "Turning on Microsoft Defender for App Service enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for ARM from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_arm_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for ARM from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.12"
            ],
            "CIS-2.1": [
                "2.1.11"
            ],
            "CIS-3.0": [
                "3.1.9.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1562",
                "T1486",
                "T1499",
                "T1087",
                "T1580",
                "T1538",
                "T1526",
                "T1069"
            ],
            "ISO27001-2022": [
                "A.5.19",
                "A.5.21",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Azure Resource Manager Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Azure Resource Manager Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_arm_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan ARM"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Arm",
                    "resource_name": "Arm",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan ARM",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Arm"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Enable  Microsoft Defender for Azure Resource Manager",
        "references": []
    },
    "risk_details": "Scanning resource requests lets you be alerted every time there is suspicious activity in order to prevent a security threat from being introduced.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Azure SQL DB Servers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_azure_sql_databases_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Azure SQL DB Servers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.4"
            ],
            "CIS-2.1": [
                "2.1.3"
            ],
            "CIS-3.0": [
                "3.1.7.3"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.19",
                "A.5.21",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'  ",
        "title": "Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'  ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_azure_sql_databases_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-SqlServers"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServers",
                    "resource_name": "SqlServers",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "SqlServers",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServers"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is disabled for all your SQL database servers. Defender for Cloud monitors your SQL database servers for threats such as SQL injection, brute-force attacks, and privilege abuse. The security service provides action-oriented security alerts with details of the suspicious activity and guidance on how to mitigate the security threats.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-azure-sql-database-servers#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-azure-sql.html"
        ]
    },
    "risk_details": "Turning on Microsoft Defender for Azure SQL Databases enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Containers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_containers_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Containers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.8"
            ],
            "CIS-2.1": [
                "2.1.8"
            ],
            "CIS-3.0": [
                "3.1.4.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1525",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Containers Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Containers Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_containers_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Containers"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Containers",
                    "resource_name": "Containers",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Containers",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Containers"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is not enabled for your Azure cloud containers. Enabling the Defender security service for Azure containers allows for advanced security defense against threats, using threat detection capabilities provided by the Microsoft Security Response Center (MSRC).",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-container-registries#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-container.html"
        ]
    },
    "risk_details": "Ensure that Microsoft Defender for Cloud is enabled for all your Azure containers. Turning on the Defender for Cloud service enables threat detection for containers, providing threat intelligence, anomaly detection, and behavior analytics.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Cosmos DB from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_cosmosdb_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Cosmos DB from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.9"
            ],
            "CIS-2.1": [
                "2.1.6"
            ],
            "CIS-3.0": [
                "3.1.7.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Cosmos DB Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Cosmos DB Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_cosmosdb_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan Cosmos DB"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/CosmosDbs",
                    "resource_name": "CosmosDbs",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan Cosmos DB",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/CosmosDbs"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
        "references": [
            "Enable Microsoft Defender for Cosmos DB"
        ]
    },
    "risk_details": "In scanning Cosmos DB requests within a subscription, requests are compared to a heuristic list of potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Databases from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_databases_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Databases from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.3"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Databases Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Databases Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_databases_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-SqlServers"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServers",
                    "resource_name": "SqlServers",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "SqlServers",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServers"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Enable Microsoft Defender for Azure SQL Databases",
        "references": []
    },
    "risk_details": "Enabling Microsoft Defender for Azure SQL Databases allows your organization more granular control of the infrastructure running your database software",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for DNS from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_dns_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for DNS from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.11"
            ],
            "CIS-2.1": [
                "2.1.10"
            ],
            "CIS-3.0": [
                "3.1.16"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.21"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for DNS Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for DNS Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_dns_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan DNS"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Dns",
                    "resource_name": "Dns",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan DNS",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/Dns"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
        "references": []
    },
    "risk_details": "DNS lookups within a subscription are scanned and compared to a dynamic list of websites that might be potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for KeyVaults from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_keyvault_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for KeyVaults from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.10"
            ],
            "CIS-2.1": [
                "2.1.9"
            ],
            "CIS-3.0": [
                "3.1.8.1"
            ],
            "PCI-4.0": [
                "3.5.1.31",
                "3.5.1.32",
                "8.3.2.50",
                "8.3.2.51"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499",
                "T1580"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for KeyVault Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for KeyVault Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_keyvault_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan KeyVaults"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/KeyVaults",
                    "resource_name": "KeyVaults",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan KeyVaults",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/KeyVaults"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Ensure that Microsoft Defender for Cloud is enabled for Azure key vaults. Key Vault is the Azure cloud service that safeguards encryption keys and secrets like certificates, connection-based strings, and passwords.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-key-vault#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-key-vault.html"
        ]
    },
    "risk_details": "By default, Microsoft Defender for Cloud is disabled for Azure key vaults. Defender for Cloud detects unusual and potentially harmful attempts to access or exploit your Azure Key Vault data. This layer of protection allows you to address threats without being a security expert, and without the need to use and manage third-party security monitoring tools or services.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Open-Source Relational Databases from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_os_relational_databases_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Open-Source Relational Databases from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.6"
            ],
            "CIS-2.1": [
                "2.1.5"
            ],
            "CIS-3.0": [
                "3.1.7.2"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_os_relational_databases_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan Open-Source Relational Databases"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/OpenSourceRelationalDatabases",
                    "resource_name": "OpenSourceRelationalDatabases",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan Open-Source Relational Databases",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/OpenSourceRelationalDatabases"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Enabling Microsoft Defender for Open-source relational databases allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).",
        "references": []
    },
    "risk_details": "Turning on Microsoft Defender for Open-source relational databases enables threat detection for Open-source relational databases, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Servers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_server_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Servers from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.1",
                "2.1.2"
            ],
            "CIS-2.1": [
                "2.1.1"
            ],
            "CIS-3.0": [
                "2.2.8",
                "3.1.3.1"
            ],
            "ENS-RD2022": [
                "op.mon.3.r1.az.ev.1",
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ],
            "ProwlerThreatScore-1.0": [
                "1.1.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Servers Is Set to 'On'",
        "title": "Ensure That Microsoft Defender for Servers Is Set to 'On'",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_server_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan Servers"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/VirtualMachines",
                    "resource_name": "VirtualMachines",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan Servers",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/VirtualMachines"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Enabling Microsoft Defender for Cloud standard pricing tier allows for better security assessment with threat detection provided by the Microsoft Security Response Center (MSRC), advanced security policies, adaptive application control, network threat detection, and regulatory compliance management.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-servers#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/microsoft-defender-vm-server.html"
        ]
    },
    "risk_details": "Turning on Microsoft Defender for Servers enables threat detection for Servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for SQL Server VMs from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_sql_servers_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for SQL Server VMs from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.5"
            ],
            "CIS-2.1": [
                "2.1.4"
            ],
            "CIS-3.0": [
                "3.1.7.4"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_sql_servers_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan SQL Server VMs"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServerVirtualMachines",
                    "resource_name": "SqlServerVirtualMachines",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan SQL Server VMs",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/SqlServerVirtualMachines"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is disabled for the Microsoft SQL servers running on virtual machines. Defender for Cloud for SQL Server virtual machines continuously monitors your SQL database servers for threats such as SQL injection, brute-force attacks, and privilege abuse. The security service provides security alerts together with details of the suspicious activity and guidance on how to mitigate to the security threats.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-sql-servers-on-machines#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-sql-server-virtual-machines.html"
        ]
    },
    "risk_details": "Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Defender plan Defender for Storage Accounts from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "metadata": {
        "event_code": "defender_ensure_defender_for_storage_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Storage Accounts from subscription Azure for Students is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.7"
            ],
            "CIS-2.1": [
                "2.1.7"
            ],
            "CIS-3.0": [
                "3.1.5.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.5"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1537",
                "T1530",
                "T1485",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.19",
                "A.5.21",
                "A.5.22",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure That Microsoft Defender for Storage Is Set To 'On' ",
        "title": "Ensure That Microsoft Defender for Storage Is Set To 'On' ",
        "types": [],
        "uid": "prowler-azure-defender_ensure_defender_for_storage_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-Defender plan Storage Accounts"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/StorageAccounts",
                    "resource_name": "StorageAccounts",
                    "pricing_tier": "Free",
                    "free_trial_remaining_time": 2592000.0,
                    "extensions": {}
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "Defender plan Storage Accounts",
            "type": "AzureDefenderPlan",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/pricings/StorageAccounts"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "By default, Microsoft Defender for Cloud is disabled for your storage accounts. Enabling the Defender security service for Azure storage accounts allows for advanced security defense using threat detection capabilities provided by the Microsoft Security Response Center (MSRC). MSRC investigates all reports of security vulnerabilities affecting Microsoft products and services, including Azure cloud services.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-defender-is-set-to-on-for-storage#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-storage.html"
        ]
    },
    "risk_details": "Ensure that Microsoft Defender for Cloud is enabled for your Microsoft Azure storage accounts. Defender for storage accounts is an Azure-native layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit your Azure cloud storage accounts.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "No IoT Security Solutions found in the subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_ensure_iot_hub_defender_is_on",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "No IoT Security Solutions found in the subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://azure.microsoft.com/en-us/services/iot-defender/#overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling Microsoft Defender for IoT will incur additional charges dependent on the level of usage.",
        "compliance": {
            "CIS-2.0": [
                "2.2.1"
            ],
            "CIS-2.1": [
                "2.2.1"
            ],
            "CIS-3.0": [
                "3.2.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.5.19",
                "A.5.21",
                "A.5.25",
                "A.5.28",
                "A.5.29",
                "A.8.7",
                "A.8.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Microsoft Defender for IoT acts as a central security hub for IoT devices within your organization.",
        "title": "Ensure That Microsoft Defender for IoT Hub Is Set To 'On'",
        "types": [],
        "uid": "prowler-azure-defender_ensure_iot_hub_defender_is_on-31661dbb-923c-429d-b434-b6bd19dcd287-global-IoT Hub Defender"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "IoT Hub Defender",
            "type": "DefenderIoT",
            "uid": "IoT Hub Defender"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Go to IoT Hub. 2. Select a IoT Hub to validate. 3. Select Overview in Defender for IoT. 4. Click on Secure your IoT solution, and complete the onboarding.",
        "references": [
            "https://learn.microsoft.com/en-us/azure/defender-for-iot/device-builders/quickstart-onboard-iot-hub"
        ]
    },
    "risk_details": "IoT devices are very rarely patched and can be potential attack vectors for enterprise networks. Updating their network configuration to use a central security hub allows for detection of these breaches.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Microsoft Defender for Cloud Apps is enabled for subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_ensure_mcas_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Microsoft Defender for Cloud Apps is enabled for subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-in/azure/defender-for-cloud/defender-for-cloud-introduction#secure-cloud-applications",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Microsoft Defender for Cloud Apps works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",
        "compliance": {
            "CIS-2.0": [
                "2.1.21"
            ],
            "CIS-2.1": [
                "2.1.20"
            ],
            "CIS-3.0": [
                "3.1.1.2"
            ],
            "PCI-4.0": [
                "11.5.1.1.2",
                "11.5.1.2"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.3"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.22"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "This integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS' - see additional info) to communicate with Microsoft Defender for Cloud.",
        "title": "Ensure that Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected",
        "types": [],
        "uid": "prowler-azure-defender_ensure_mcas_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-global-MCAS"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/settings/MCAS",
                    "resource_type": "Microsoft.Security/settings",
                    "kind": "DataExportSettings",
                    "enabled": true
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "MCAS",
            "type": "DefenderSettings",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/settings/MCAS"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. From Azure Home select the Portal Menu. 2. Select Microsoft Defender for Cloud. 3. Select Environment Settings blade. 4. Select the subscription. 5. Check App Service Defender Plan to On. 6. Select Save.",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-cloud-apps-integration.html#",
            "https://docs.microsoft.com/en-us/rest/api/securitycenter/settings/list"
        ]
    },
    "risk_details": "Microsoft Defender for Cloud offers an additional layer of protection by using Azure Resource Manager events, which is considered to be the control plane for Azure. By analyzing the Azure Resource Manager records, Microsoft Defender for Cloud detects unusual or potentially harmful operations in the Azure subscription environment. Several of the preceding analytics are powered by Microsoft Defender for Cloud Apps. To benefit from these analytics, subscription must have a Cloud App Security license. Microsoft Defender for Cloud Apps works only with Standard Tier subscriptions.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Notifiy alerts are not enabled for severity high in subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_ensure_notify_alerts_severity_is_high",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Notifiy alerts are not enabled for severity high in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.20"
            ],
            "CIS-2.1": [
                "2.1.19"
            ],
            "CIS-3.0": [
                "3.1.14"
            ],
            "ENS-RD2022": [
                "op.mon.3.az.nw.1",
                "op.mon.3.r3.az.de.1",
                "mp.com.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.20"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.",
        "title": "Ensure That 'Notify about alerts with the following severity' is Set to 'High'",
        "types": [],
        "uid": "prowler-azure-defender_ensure_notify_alerts_severity_is_high-31661dbb-923c-429d-b434-b6bd19dcd287-global-default"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default",
                    "name": "default",
                    "emails": "",
                    "phone": "",
                    "alert_notifications_minimal_severity": "",
                    "alert_notifications_state": "",
                    "notified_roles": [
                        ""
                    ],
                    "notified_roles_state": ""
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "default",
            "type": "AzureEmailNotifications",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. From Azure Home select the Portal Menu 2. Select Microsoft Defender for Cloud 3. Click on Environment Settings 4. Click on the appropriate Management Group, Subscription, or Workspace 5. Click on Email notifications 6. Enter a valid security contact email address (or multiple addresses separated by commas) in the Additional email addresses field 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_4#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/enable-high-severity-email-notifications.html",
            "https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/list"
        ]
    },
    "risk_details": "Microsoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "The Owner role is not notified for subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_ensure_notify_emails_to_owners",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "The Owner role is not notified for subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security-center/security-center-provide-security-contact-details",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.18"
            ],
            "CIS-2.1": [
                "2.1.17"
            ],
            "CIS-3.0": [
                "3.1.12"
            ],
            "ENS-RD2022": [
                "op.mon.3.r4.az.de.1"
            ],
            "MITRE-ATTACK": [
                "T1190",
                "T1486"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.18"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable security alert emails to subscription owners.",
        "title": "Ensure That 'All users with the following roles' is set to 'Owner'",
        "types": [],
        "uid": "prowler-azure-defender_ensure_notify_emails_to_owners-31661dbb-923c-429d-b434-b6bd19dcd287-global-default"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default",
                    "name": "default",
                    "emails": "",
                    "phone": "",
                    "alert_notifications_minimal_severity": "",
                    "alert_notifications_state": "",
                    "notified_roles": [
                        ""
                    ],
                    "notified_roles_state": ""
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "default",
            "type": "AzureEmailNotifications",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/securityContacts/default"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. From Azure Home select the Portal Menu 2. Select Microsoft Defender for Cloud 3. Click on Environment Settings 4. Click on the appropriate Management Group, Subscription, or Workspace 5. Click on Email notifications 6. In the drop down of the All users with the following roles field select Owner 7. Click Save",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/email-to-subscription-owners.html",
            "https://docs.microsoft.com/en-us/rest/api/securitycenter/securitycontacts/list"
        ]
    },
    "risk_details": "Enabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Microsoft Defender for Endpoint integration is enabled for subscription Azure for Students.",
    "metadata": {
        "event_code": "defender_ensure_wdatp_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Microsoft Defender for Endpoint integration is enabled for subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-in/azure/defender-for-cloud/integration-defender-for-endpoint?tabs=windows",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Microsoft Defender for Endpoint works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",
        "compliance": {
            "CIS-2.0": [
                "2.1.22"
            ],
            "CIS-2.1": [
                "2.1.21"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.2"
            ],
            "MITRE-ATTACK": [
                "T1190"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "This integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP' - see additional info) to communicate with Microsoft Defender for Cloud.",
        "title": "Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is selected",
        "types": [],
        "uid": "prowler-azure-defender_ensure_wdatp_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-global-WDATP"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/settings/WDATP",
                    "resource_type": "Microsoft.Security/settings",
                    "kind": "DataExportSettings",
                    "enabled": true
                }
            },
            "group": {
                "name": "defender"
            },
            "labels": [],
            "name": "WDATP",
            "type": "DefenderSettings",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Security/settings/WDATP"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/SecurityCenter/defender-endpoint-integration.html",
            "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/azure-server-integration?view=o365-worldwide"
        ]
    },
    "risk_details": "Microsoft Defender for Endpoint integration brings comprehensive Endpoint Detection and Response (EDR) capabilities within Microsoft Defender for Cloud. This integration helps to spot abnormalities, as well as detect and respond to advanced attacks on endpoints monitored by Microsoft Defender for Cloud. MDE works only with Standard Tier subscriptions.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There are no diagnostic settings capturing audit logs for Key Vault vv-kv-01 in subscription Azure for Students.",
    "metadata": {
        "event_code": "keyvault_logging_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no diagnostic settings capturing audit logs for Key Vault vv-kv-01 in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-logging",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Diagnostic AuditEvent logging is not enabled for Key Vault instances.",
        "compliance": {
            "CIS-2.0": [
                "5.1.5"
            ],
            "CIS-2.1": [
                "5.1.4"
            ],
            "CIS-3.0": [
                "6.1.4"
            ],
            "PCI-4.0": [
                "10.3.2.4",
                "10.3.3.6",
                "10.3.4.5",
                "3.5.1.5",
                "8.3.2.9",
                "A1.2.1.11"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.",
        "title": "Ensure that logging for Azure Key Vault is 'Enabled'",
        "types": [],
        "uid": "prowler-azure-keyvault_logging_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "1. Go to Key vaults 2. For each Key vault 3. Go to Diagnostic settings 4. Click on Edit Settings 5. Ensure that Archive to a storage account is Enabled 6. Ensure that AuditEvent is checked, and the retention days is set to 180 days or as appropriate",
        "references": [
            "az monitor diagnostic-settings create --name <diagnostic settings name> --resource <key vault resource ID> --logs'[{category:AuditEvents,enabled:true,retention-policy:{enabled:true,days:180}}]' --metrics'[{category:AllMetrics,enabled:true,retention-policy:{enabled:true,days:180}}]' <[--event-hub <event hub ID> --event-hub-rule <event hub auth rule ID> | --storage-account <storage account ID> |--workspace <log analytics workspace ID> | --marketplace-partner-id <full resource ID of third-party solution>]>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/KeyVault/enable-audit-event-logging-for-azure-key-vaults.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-8-ensure-security-of-key-and-certificate-repository"
        ]
    },
    "risk_details": "Monitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information, keys, and certificates managed by Azure Keyvault. Enabling logging for Key Vault saves information in an Azure storage account which the user provides. This creates a new container named insights-logs-auditevent automatically for the specified storage account. This same storage account can be used for collecting logs for multiple key vaults.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There are no diagnostic settings capturing audit logs for Key Vault kv-0169 in subscription Azure for Students.",
    "metadata": {
        "event_code": "keyvault_logging_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no diagnostic settings capturing audit logs for Key Vault kv-0169 in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-logging",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Diagnostic AuditEvent logging is not enabled for Key Vault instances.",
        "compliance": {
            "CIS-2.0": [
                "5.1.5"
            ],
            "CIS-2.1": [
                "5.1.4"
            ],
            "CIS-3.0": [
                "6.1.4"
            ],
            "PCI-4.0": [
                "10.3.2.4",
                "10.3.3.6",
                "10.3.4.5",
                "3.5.1.5",
                "8.3.2.9",
                "A1.2.1.11"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.",
        "title": "Ensure that logging for Azure Key Vault is 'Enabled'",
        "types": [],
        "uid": "prowler-azure-keyvault_logging_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169",
                    "name": "kv-0169",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [
                            {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169/privateEndpointConnections/psc-kv-01"
                            }
                        ],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0169",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Key vaults 2. For each Key vault 3. Go to Diagnostic settings 4. Click on Edit Settings 5. Ensure that Archive to a storage account is Enabled 6. Ensure that AuditEvent is checked, and the retention days is set to 180 days or as appropriate",
        "references": [
            "az monitor diagnostic-settings create --name <diagnostic settings name> --resource <key vault resource ID> --logs'[{category:AuditEvents,enabled:true,retention-policy:{enabled:true,days:180}}]' --metrics'[{category:AllMetrics,enabled:true,retention-policy:{enabled:true,days:180}}]' <[--event-hub <event hub ID> --event-hub-rule <event hub auth rule ID> | --storage-account <storage account ID> |--workspace <log analytics workspace ID> | --marketplace-partner-id <full resource ID of third-party solution>]>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/KeyVault/enable-audit-event-logging-for-azure-key-vaults.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-8-ensure-security-of-key-and-certificate-repository"
        ]
    },
    "risk_details": "Monitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information, keys, and certificates managed by Azure Keyvault. Enabling logging for Key Vault saves information in an Azure storage account which the user provides. This creates a new container named insights-logs-auditevent automatically for the specified storage account. This same storage account can be used for collecting logs for multiple key vaults.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There are no diagnostic settings capturing audit logs for Key Vault kv-0269 in subscription Azure for Students.",
    "metadata": {
        "event_code": "keyvault_logging_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no diagnostic settings capturing audit logs for Key Vault kv-0269 in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-logging",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, Diagnostic AuditEvent logging is not enabled for Key Vault instances.",
        "compliance": {
            "CIS-2.0": [
                "5.1.5"
            ],
            "CIS-2.1": [
                "5.1.4"
            ],
            "CIS-3.0": [
                "6.1.4"
            ],
            "PCI-4.0": [
                "10.3.2.4",
                "10.3.3.6",
                "10.3.4.5",
                "3.5.1.5",
                "8.3.2.9",
                "A1.2.1.11"
            ],
            "ENS-RD2022": [
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ],
            "ISO27001-2022": [
                "A.8.15"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.",
        "title": "Ensure that logging for Azure Key Vault is 'Enabled'",
        "types": [],
        "uid": "prowler-azure-keyvault_logging_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269",
                    "name": "kv-0269",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0269",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Key vaults 2. For each Key vault 3. Go to Diagnostic settings 4. Click on Edit Settings 5. Ensure that Archive to a storage account is Enabled 6. Ensure that AuditEvent is checked, and the retention days is set to 180 days or as appropriate",
        "references": [
            "az monitor diagnostic-settings create --name <diagnostic settings name> --resource <key vault resource ID> --logs'[{category:AuditEvents,enabled:true,retention-policy:{enabled:true,days:180}}]' --metrics'[{category:AllMetrics,enabled:true,retention-policy:{enabled:true,days:180}}]' <[--event-hub <event hub ID> --event-hub-rule <event hub auth rule ID> | --storage-account <storage account ID> |--workspace <log analytics workspace ID> | --marketplace-partner-id <full resource ID of third-party solution>]>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/KeyVault/enable-audit-event-logging-for-azure-key-vaults.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-8-ensure-security-of-key-and-certificate-repository"
        ]
    },
    "risk_details": "Monitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information, keys, and certificates managed by Azure Keyvault. Enabling logging for Key Vault saves information in an Azure storage account which the user provides. This creates a new container named insights-logs-auditevent automatically for the specified storage account. This same storage account can be used for collecting logs for multiple key vaults.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students is not using private endpoints.",
    "metadata": {
        "event_code": "keyvault_private_endpoints",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students is not using private endpoints.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Incorrect or poorly-timed changing of network configuration could result in service interruption. There are also additional costs tiers for running a private endpoint perpetabyte or more of networking traffic.",
        "compliance": {
            "CIS-2.0": [
                "8.7"
            ],
            "CIS-2.1": [
                "8.7"
            ],
            "CIS-3.0": [
                "3.3.7"
            ],
            "PCI-4.0": [
                "1.2.8.38",
                "1.3.1.42",
                "1.3.2.42",
                "1.4.2.40",
                "1.5.1.38",
                "A1.1.3.38"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2",
                "mp.com.4.r2.az.aks.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Private endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.",
        "title": "Ensure that Private Endpoints are Used for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_private_endpoints-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Please see the additional information about the requirements needed before starting this remediation procedure. From Azure Portal 1. From Azure Home open the Portal Menu in the top left. 2. Select Key Vaults. 3. Select a Key Vault to audit. 4. Select Networking in the left column. 5. Select Private endpoint connections from the top row. 6. Select + Create. 7. Select the subscription the Key Vault is within, and other desired configuration. 8. Select Next. 9. For resource type select Microsoft.KeyVault/vaults. 10. Select the Key Vault to associate the Private Endpoint with. 11. Select Next. 12. In the Virtual Networking field, select the network to assign the Endpoint. 13. Select other configuration options as desired, including an existing or new application security group. 14. Select Next. 15. Select the private DNS the Private Endpoints will use. 16. Select Next. 17. Optionally add Tags. 18. Select Next : Review + Create. 19. Review the information and select Create. Follow the Audit Procedure to determine if it has successfully applied. 20. Repeat steps 3-19 for each Key Vault. From Azure CLI 1. To create an endpoint, run the following command: az network private-endpoint create --resource-group <resourceGroup --vnet- name <vnetName> --subnet <subnetName> --name <PrivateEndpointName> -- private-connection-resource-id '/subscriptions/<AZURE SUBSCRIPTION ID>/resourceGroups/<resourceGroup>/providers/Microsoft.KeyVault/vaults/<keyVa ultName>' --group-ids vault --connection-name <privateLinkConnectionName> -- location <azureRegion> --manual-request 2. To manually approve the endpoint request, run the following command: az keyvault private-endpoint-connection approve --resource-group <resourceGroup> --vault-name <keyVaultName> \u2013name <privateLinkName> 4. Determine the Private Endpoint's IP address to connect the Key Vault to the Private DNS you have previously created: 5. Look for the property networkInterfaces then id, the value must be placed in the variable <privateEndpointNIC> within step 7. az network private-endpoint show -g <resourceGroupName> -n <privateEndpointName> 6. Look for the property networkInterfaces then id, the value must be placed on <privateEndpointNIC> in step 7. az network nic show --ids <privateEndpointName> 7. Create a Private DNS record within the DNS Zone you created for the Private Endpoint: az network private-dns record-set a add-record -g <resourcecGroupName> -z 'privatelink.vaultcore.azure.net' -n <keyVaultName> -a <privateEndpointNIC> 8. nslookup the private endpoint to determine if the DNS record is correct: nslookup <keyVaultName>.vault.azure.net nslookup <keyVaultName>.privatelink.vaultcore.azure.n",
        "references": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Private endpoints will keep network requests to Azure Key Vault limited to the endpoints attached to the resources that are whitelisted to communicate with each other. Assigning the Key Vault to a network without an endpoint will allow other resources on that network to view all traffic from the Key Vault to its destination. In spite of the complexity in configuration, this is recommended for high security secrets.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0169 from subscription Azure for Students is using private endpoints.",
    "metadata": {
        "event_code": "keyvault_private_endpoints",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Keyvault kv-0169 from subscription Azure for Students is using private endpoints.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Incorrect or poorly-timed changing of network configuration could result in service interruption. There are also additional costs tiers for running a private endpoint perpetabyte or more of networking traffic.",
        "compliance": {
            "CIS-2.0": [
                "8.7"
            ],
            "CIS-2.1": [
                "8.7"
            ],
            "CIS-3.0": [
                "3.3.7"
            ],
            "PCI-4.0": [
                "1.2.8.38",
                "1.3.1.42",
                "1.3.2.42",
                "1.4.2.40",
                "1.5.1.38",
                "A1.1.3.38"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2",
                "mp.com.4.r2.az.aks.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Private endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.",
        "title": "Ensure that Private Endpoints are Used for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_private_endpoints-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169",
                    "name": "kv-0169",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [
                            {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169/privateEndpointConnections/psc-kv-01"
                            }
                        ],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0169",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Please see the additional information about the requirements needed before starting this remediation procedure. From Azure Portal 1. From Azure Home open the Portal Menu in the top left. 2. Select Key Vaults. 3. Select a Key Vault to audit. 4. Select Networking in the left column. 5. Select Private endpoint connections from the top row. 6. Select + Create. 7. Select the subscription the Key Vault is within, and other desired configuration. 8. Select Next. 9. For resource type select Microsoft.KeyVault/vaults. 10. Select the Key Vault to associate the Private Endpoint with. 11. Select Next. 12. In the Virtual Networking field, select the network to assign the Endpoint. 13. Select other configuration options as desired, including an existing or new application security group. 14. Select Next. 15. Select the private DNS the Private Endpoints will use. 16. Select Next. 17. Optionally add Tags. 18. Select Next : Review + Create. 19. Review the information and select Create. Follow the Audit Procedure to determine if it has successfully applied. 20. Repeat steps 3-19 for each Key Vault. From Azure CLI 1. To create an endpoint, run the following command: az network private-endpoint create --resource-group <resourceGroup --vnet- name <vnetName> --subnet <subnetName> --name <PrivateEndpointName> -- private-connection-resource-id '/subscriptions/<AZURE SUBSCRIPTION ID>/resourceGroups/<resourceGroup>/providers/Microsoft.KeyVault/vaults/<keyVa ultName>' --group-ids vault --connection-name <privateLinkConnectionName> -- location <azureRegion> --manual-request 2. To manually approve the endpoint request, run the following command: az keyvault private-endpoint-connection approve --resource-group <resourceGroup> --vault-name <keyVaultName> \u2013name <privateLinkName> 4. Determine the Private Endpoint's IP address to connect the Key Vault to the Private DNS you have previously created: 5. Look for the property networkInterfaces then id, the value must be placed in the variable <privateEndpointNIC> within step 7. az network private-endpoint show -g <resourceGroupName> -n <privateEndpointName> 6. Look for the property networkInterfaces then id, the value must be placed on <privateEndpointNIC> in step 7. az network nic show --ids <privateEndpointName> 7. Create a Private DNS record within the DNS Zone you created for the Private Endpoint: az network private-dns record-set a add-record -g <resourcecGroupName> -z 'privatelink.vaultcore.azure.net' -n <keyVaultName> -a <privateEndpointNIC> 8. nslookup the private endpoint to determine if the DNS record is correct: nslookup <keyVaultName>.vault.azure.net nslookup <keyVaultName>.privatelink.vaultcore.azure.n",
        "references": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Private endpoints will keep network requests to Azure Key Vault limited to the endpoints attached to the resources that are whitelisted to communicate with each other. Assigning the Key Vault to a network without an endpoint will allow other resources on that network to view all traffic from the Key Vault to its destination. In spite of the complexity in configuration, this is recommended for high security secrets.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0269 from subscription Azure for Students is not using private endpoints.",
    "metadata": {
        "event_code": "keyvault_private_endpoints",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault kv-0269 from subscription Azure for Students is not using private endpoints.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/private-link/private-endpoint-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Incorrect or poorly-timed changing of network configuration could result in service interruption. There are also additional costs tiers for running a private endpoint perpetabyte or more of networking traffic.",
        "compliance": {
            "CIS-2.0": [
                "8.7"
            ],
            "CIS-2.1": [
                "8.7"
            ],
            "CIS-3.0": [
                "3.3.7"
            ],
            "PCI-4.0": [
                "1.2.8.38",
                "1.3.1.42",
                "1.3.2.42",
                "1.4.2.40",
                "1.5.1.38",
                "A1.1.3.38"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2",
                "mp.com.4.r2.az.aks.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Private endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.",
        "title": "Ensure that Private Endpoints are Used for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_private_endpoints-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269",
                    "name": "kv-0269",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0269",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Please see the additional information about the requirements needed before starting this remediation procedure. From Azure Portal 1. From Azure Home open the Portal Menu in the top left. 2. Select Key Vaults. 3. Select a Key Vault to audit. 4. Select Networking in the left column. 5. Select Private endpoint connections from the top row. 6. Select + Create. 7. Select the subscription the Key Vault is within, and other desired configuration. 8. Select Next. 9. For resource type select Microsoft.KeyVault/vaults. 10. Select the Key Vault to associate the Private Endpoint with. 11. Select Next. 12. In the Virtual Networking field, select the network to assign the Endpoint. 13. Select other configuration options as desired, including an existing or new application security group. 14. Select Next. 15. Select the private DNS the Private Endpoints will use. 16. Select Next. 17. Optionally add Tags. 18. Select Next : Review + Create. 19. Review the information and select Create. Follow the Audit Procedure to determine if it has successfully applied. 20. Repeat steps 3-19 for each Key Vault. From Azure CLI 1. To create an endpoint, run the following command: az network private-endpoint create --resource-group <resourceGroup --vnet- name <vnetName> --subnet <subnetName> --name <PrivateEndpointName> -- private-connection-resource-id '/subscriptions/<AZURE SUBSCRIPTION ID>/resourceGroups/<resourceGroup>/providers/Microsoft.KeyVault/vaults/<keyVa ultName>' --group-ids vault --connection-name <privateLinkConnectionName> -- location <azureRegion> --manual-request 2. To manually approve the endpoint request, run the following command: az keyvault private-endpoint-connection approve --resource-group <resourceGroup> --vault-name <keyVaultName> \u2013name <privateLinkName> 4. Determine the Private Endpoint's IP address to connect the Key Vault to the Private DNS you have previously created: 5. Look for the property networkInterfaces then id, the value must be placed in the variable <privateEndpointNIC> within step 7. az network private-endpoint show -g <resourceGroupName> -n <privateEndpointName> 6. Look for the property networkInterfaces then id, the value must be placed on <privateEndpointNIC> in step 7. az network nic show --ids <privateEndpointName> 7. Create a Private DNS record within the DNS Zone you created for the Private Endpoint: az network private-dns record-set a add-record -g <resourcecGroupName> -z 'privatelink.vaultcore.azure.net' -n <keyVaultName> -a <privateEndpointNIC> 8. nslookup the private endpoint to determine if the DNS record is correct: nslookup <keyVaultName>.vault.azure.net nslookup <keyVaultName>.privatelink.vaultcore.azure.n",
        "references": [
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Private endpoints will keep network requests to Azure Key Vault limited to the endpoints attached to the resources that are whitelisted to communicate with each other. Assigning the Key Vault to a network without an endpoint will allow other resources on that network to view all traffic from the Key Vault to its destination. In spite of the complexity in configuration, this is recommended for high security secrets.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students is using RBAC for access control.",
    "metadata": {
        "event_code": "keyvault_rbac_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students is using RBAC for access control.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-gb/azure/key-vault/general/rbac-migration#vault-access-policy-to-azure-rbac-migration-steps",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Implementation needs to be properly designed from the ground up, as this is a fundamental change to the way key vaults are accessed/managed. Changing permissions to key vaults will result in loss of service as permissions are re-applied. For the least amount of downtime, map your current groups and users to their corresponding permission needs.",
        "compliance": {
            "CIS-2.0": [
                "8.6"
            ],
            "CIS-2.1": [
                "8.6"
            ],
            "CIS-3.0": [
                "3.3.6"
            ],
            "PCI-4.0": [
                "3.5.1.1.7",
                "3.5.1.3.15",
                "3.6.1.2.7",
                "3.6.1.3.7",
                "3.6.1.4.7",
                "3.6.1.7",
                "3.7.1.8",
                "3.7.2.7",
                "3.7.4.8",
                "3.7.6.7",
                "3.7.7.7",
                "4.2.1.1.20",
                "7.2.1.9",
                "7.2.2.9",
                "7.2.3.5",
                "7.2.5.5",
                "7.3.1.5",
                "7.3.2.5",
                "7.3.3.5",
                "8.2.7.5",
                "8.2.8.7",
                "8.3.4.5"
            ],
            "ENS-RD2022": [
                "op.acc.2.az.r1.eid.1",
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "WARNING: Role assignments disappear when a Key Vault has been deleted (soft-delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.",
        "title": "Enable Role Based Access Control for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal Key Vaults can be configured to use Azure role-based access control on creation. For existing Key Vaults: 1. From Azure Home open the Portal Menu in the top left corner 2. Select Key Vaults 3. Select a Key Vault to audit 4. Select Access configuration 5. Set the Permission model radio button to Azure role-based access control, taking note of the warning message 6. Click Save 7. Select Access Control (IAM) 8. Select the Role Assignments tab 9. Reapply permissions as needed to groups or users",
        "references": [
            "https://docs.microsoft.com/en-gb/azure/role-based-access-control/role-assignments-portal?tabs=current"
        ]
    },
    "risk_details": "The new RBAC permissions model for Key Vaults enables a much finer grained access control for key vault secrets, keys, certificates, etc., than the vault access policy. This in turn will permit the use of privileged identity management over these roles, thus securing the key vaults with JIT Access management.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0169 from subscription Azure for Students is not using RBAC for access control.",
    "metadata": {
        "event_code": "keyvault_rbac_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault kv-0169 from subscription Azure for Students is not using RBAC for access control.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-gb/azure/key-vault/general/rbac-migration#vault-access-policy-to-azure-rbac-migration-steps",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Implementation needs to be properly designed from the ground up, as this is a fundamental change to the way key vaults are accessed/managed. Changing permissions to key vaults will result in loss of service as permissions are re-applied. For the least amount of downtime, map your current groups and users to their corresponding permission needs.",
        "compliance": {
            "CIS-2.0": [
                "8.6"
            ],
            "CIS-2.1": [
                "8.6"
            ],
            "CIS-3.0": [
                "3.3.6"
            ],
            "PCI-4.0": [
                "3.5.1.1.7",
                "3.5.1.3.15",
                "3.6.1.2.7",
                "3.6.1.3.7",
                "3.6.1.4.7",
                "3.6.1.7",
                "3.7.1.8",
                "3.7.2.7",
                "3.7.4.8",
                "3.7.6.7",
                "3.7.7.7",
                "4.2.1.1.20",
                "7.2.1.9",
                "7.2.2.9",
                "7.2.3.5",
                "7.2.5.5",
                "7.3.1.5",
                "7.3.2.5",
                "7.3.3.5",
                "8.2.7.5",
                "8.2.8.7",
                "8.3.4.5"
            ],
            "ENS-RD2022": [
                "op.acc.2.az.r1.eid.1",
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "WARNING: Role assignments disappear when a Key Vault has been deleted (soft-delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.",
        "title": "Enable Role Based Access Control for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169",
                    "name": "kv-0169",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [
                            {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169/privateEndpointConnections/psc-kv-01"
                            }
                        ],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0169",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From Azure Portal Key Vaults can be configured to use Azure role-based access control on creation. For existing Key Vaults: 1. From Azure Home open the Portal Menu in the top left corner 2. Select Key Vaults 3. Select a Key Vault to audit 4. Select Access configuration 5. Set the Permission model radio button to Azure role-based access control, taking note of the warning message 6. Click Save 7. Select Access Control (IAM) 8. Select the Role Assignments tab 9. Reapply permissions as needed to groups or users",
        "references": [
            "https://docs.microsoft.com/en-gb/azure/role-based-access-control/role-assignments-portal?tabs=current"
        ]
    },
    "risk_details": "The new RBAC permissions model for Key Vaults enables a much finer grained access control for key vault secrets, keys, certificates, etc., than the vault access policy. This in turn will permit the use of privileged identity management over these roles, thus securing the key vaults with JIT Access management.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0269 from subscription Azure for Students is not using RBAC for access control.",
    "metadata": {
        "event_code": "keyvault_rbac_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault kv-0269 from subscription Azure for Students is not using RBAC for access control.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-gb/azure/key-vault/general/rbac-migration#vault-access-policy-to-azure-rbac-migration-steps",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Implementation needs to be properly designed from the ground up, as this is a fundamental change to the way key vaults are accessed/managed. Changing permissions to key vaults will result in loss of service as permissions are re-applied. For the least amount of downtime, map your current groups and users to their corresponding permission needs.",
        "compliance": {
            "CIS-2.0": [
                "8.6"
            ],
            "CIS-2.1": [
                "8.6"
            ],
            "CIS-3.0": [
                "3.3.6"
            ],
            "PCI-4.0": [
                "3.5.1.1.7",
                "3.5.1.3.15",
                "3.6.1.2.7",
                "3.6.1.3.7",
                "3.6.1.4.7",
                "3.6.1.7",
                "3.7.1.8",
                "3.7.2.7",
                "3.7.4.8",
                "3.7.6.7",
                "3.7.7.7",
                "4.2.1.1.20",
                "7.2.1.9",
                "7.2.2.9",
                "7.2.3.5",
                "7.2.5.5",
                "7.3.1.5",
                "7.3.2.5",
                "7.3.3.5",
                "8.2.7.5",
                "8.2.8.7",
                "8.3.4.5"
            ],
            "ENS-RD2022": [
                "op.acc.2.az.r1.eid.1",
                "op.acc.5.r3.az.kv.1",
                "op.acc.6.r3.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "WARNING: Role assignments disappear when a Key Vault has been deleted (soft-delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.",
        "title": "Enable Role Based Access Control for Azure Key Vault",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269",
                    "name": "kv-0269",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0269",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From Azure Portal Key Vaults can be configured to use Azure role-based access control on creation. For existing Key Vaults: 1. From Azure Home open the Portal Menu in the top left corner 2. Select Key Vaults 3. Select a Key Vault to audit 4. Select Access configuration 5. Set the Permission model radio button to Azure role-based access control, taking note of the warning message 6. Click Save 7. Select Access Control (IAM) 8. Select the Role Assignments tab 9. Reapply permissions as needed to groups or users",
        "references": [
            "https://docs.microsoft.com/en-gb/azure/role-based-access-control/role-assignments-portal?tabs=current"
        ]
    },
    "risk_details": "The new RBAC permissions model for Key Vaults enables a much finer grained access control for key vault secrets, keys, certificates, etc., than the vault access policy. This in turn will permit the use of privileged identity management over these roles, thus securing the key vaults with JIT Access management.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "metadata": {
        "event_code": "keyvault_rbac_secret_expiration_set",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-whatis",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.",
        "compliance": {
            "CIS-2.0": [
                "8.3"
            ],
            "CIS-2.1": [
                "8.3"
            ],
            "CIS-3.0": [
                "3.3.3"
            ],
            "PCI-4.0": [
                "8.3.10.1.1",
                "8.3.5.1",
                "8.3.7.1",
                "8.3.9.1",
                "8.6.3.1"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
        "title": "Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_secret_expiration_set-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal: 1. Go to Key vaults. 2. For each Key vault, click on Secrets. 3. In the main pane, ensure that the status of the secret is Enabled. 4. For each enabled secret, ensure that an appropriate Expiration date is set. From Azure CLI: Update the Expiration date for the secret using the below command: az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z' Note: To view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required. To update the expiration date for the secrets: 1. Go to the Key vault, click on Access Control (IAM). 2. Click on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user. From PowerShell: Set-AzKeyVaultSecretAttribute -VaultName <Vault Name> -Name <Secret Name> - Expires <DateTime>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-secrets-policies/set-an-expiration-date-on-all-secrets#terraform",
            "az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z'",
            "https://docs.microsoft.com/en-us/rest/api/keyvault/about-keys--secrets-and-certificates#key-vault-secrets"
        ]
    },
    "risk_details": "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "metadata": {
        "event_code": "keyvault_rbac_secret_expiration_set",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-whatis",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.",
        "compliance": {
            "CIS-2.0": [
                "8.3"
            ],
            "CIS-2.1": [
                "8.3"
            ],
            "CIS-3.0": [
                "3.3.3"
            ],
            "PCI-4.0": [
                "8.3.10.1.1",
                "8.3.5.1",
                "8.3.7.1",
                "8.3.9.1",
                "8.6.3.1"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
        "title": "Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_secret_expiration_set-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal: 1. Go to Key vaults. 2. For each Key vault, click on Secrets. 3. In the main pane, ensure that the status of the secret is Enabled. 4. For each enabled secret, ensure that an appropriate Expiration date is set. From Azure CLI: Update the Expiration date for the secret using the below command: az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z' Note: To view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required. To update the expiration date for the secrets: 1. Go to the Key vault, click on Access Control (IAM). 2. Click on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user. From PowerShell: Set-AzKeyVaultSecretAttribute -VaultName <Vault Name> -Name <Secret Name> - Expires <DateTime>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-secrets-policies/set-an-expiration-date-on-all-secrets#terraform",
            "az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z'",
            "https://docs.microsoft.com/en-us/rest/api/keyvault/about-keys--secrets-and-certificates#key-vault-secrets"
        ]
    },
    "risk_details": "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "metadata": {
        "event_code": "keyvault_rbac_secret_expiration_set",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-whatis",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.",
        "compliance": {
            "CIS-2.0": [
                "8.3"
            ],
            "CIS-2.1": [
                "8.3"
            ],
            "CIS-3.0": [
                "3.3.3"
            ],
            "PCI-4.0": [
                "8.3.10.1.1",
                "8.3.5.1",
                "8.3.7.1",
                "8.3.9.1",
                "8.6.3.1"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
        "title": "Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_secret_expiration_set-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal: 1. Go to Key vaults. 2. For each Key vault, click on Secrets. 3. In the main pane, ensure that the status of the secret is Enabled. 4. For each enabled secret, ensure that an appropriate Expiration date is set. From Azure CLI: Update the Expiration date for the secret using the below command: az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z' Note: To view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required. To update the expiration date for the secrets: 1. Go to the Key vault, click on Access Control (IAM). 2. Click on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user. From PowerShell: Set-AzKeyVaultSecretAttribute -VaultName <Vault Name> -Name <Secret Name> - Expires <DateTime>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-secrets-policies/set-an-expiration-date-on-all-secrets#terraform",
            "az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z'",
            "https://docs.microsoft.com/en-us/rest/api/keyvault/about-keys--secrets-and-certificates#key-vault-secrets"
        ]
    },
    "risk_details": "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "metadata": {
        "event_code": "keyvault_rbac_secret_expiration_set",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students has the secret pgadmin-password-default without expiration date set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-whatis",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secrets cannot be used beyond their assigned expiry date respectively. Secrets need to be rotated periodically wherever they are used.",
        "compliance": {
            "CIS-2.0": [
                "8.3"
            ],
            "CIS-2.1": [
                "8.3"
            ],
            "CIS-3.0": [
                "3.3.3"
            ],
            "PCI-4.0": [
                "8.3.10.1.1",
                "8.3.5.1",
                "8.3.7.1",
                "8.3.9.1",
                "8.6.3.1"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
        "title": "Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
        "types": [],
        "uid": "prowler-azure-keyvault_rbac_secret_expiration_set-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal: 1. Go to Key vaults. 2. For each Key vault, click on Secrets. 3. In the main pane, ensure that the status of the secret is Enabled. 4. For each enabled secret, ensure that an appropriate Expiration date is set. From Azure CLI: Update the Expiration date for the secret using the below command: az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z' Note: To view the expiration date on all secrets in a Key Vault using Microsoft API, the List Key permission is required. To update the expiration date for the secrets: 1. Go to the Key vault, click on Access Control (IAM). 2. Click on Add role assignment and assign the role of Key Vault Secrets Officer to the appropriate user. From PowerShell: Set-AzKeyVaultSecretAttribute -VaultName <Vault Name> -Name <Secret Name> - Expires <DateTime>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-secrets-policies/set-an-expiration-date-on-all-secrets#terraform",
            "az keyvault secret set-attributes --name <secretName> --vault-name <vaultName> --expires Y-m-d'T'H:M:S'Z'",
            "https://docs.microsoft.com/en-us/rest/api/keyvault/about-keys--secrets-and-certificates#key-vault-secrets"
        ]
    },
    "risk_details": "The Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault vv-kv-01 from subscription Azure for Students is not recoverable.",
    "metadata": {
        "event_code": "keyvault_recoverable",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault vv-kv-01 from subscription Azure for Students is not recoverable.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-soft-delete-cli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Once purge-protection and soft-delete are enabled for a Key Vault, the action is irreversible.",
        "compliance": {
            "CIS-2.0": [
                "8.5"
            ],
            "CIS-2.1": [
                "8.5"
            ],
            "CIS-3.0": [
                "3.3.5"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects. It is recommended the Key Vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user. WARNING: A current limitation of the soft-delete feature across all Azure services is role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.",
        "title": "Ensure the Key Vault is Recoverable",
        "types": [],
        "uid": "prowler-azure-keyvault_recoverable-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-kv-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01",
                    "name": "vv-kv-01",
                    "location": "polandcentral",
                    "resource_group": "volt_value",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": true,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-admin-password",
                            "name": "db-admin-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:40:35+00:00",
                                "updated": "2025-04-19T19:40:35+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-read-password",
                            "name": "db-read-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:49:53+00:00",
                                "updated": "2025-04-19T19:49:53+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/db-vv-scrapper-password",
                            "name": "db-vv-scrapper-password",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:58:32+00:00",
                                "updated": "2025-04-19T19:58:32+00:00",
                                "expires": null
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01/secrets/pgadmin-password-default",
                            "name": "pgadmin-password-default",
                            "enabled": true,
                            "location": "polandcentral",
                            "attributes": {
                                "enabled": true,
                                "created": "2025-04-19T19:56:18+00:00",
                                "updated": "2025-04-19T19:56:18+00:00",
                                "expires": null
                            }
                        }
                    ],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "vv-kv-01",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.KeyVault/vaults/vv-kv-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "To enable 'Do Not Purge' and 'Soft Delete' for a Key Vault: From Azure Portal 1. Go to Key Vaults 2. For each Key Vault 3. Click Properties 4. Ensure the status of soft-delete reads Soft delete has been enabled on this key vault. 5. At the bottom of the page, click 'Enable Purge Protection' Note, once enabled you cannot disable it. From Azure CLI az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx- xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault /vaults/<keyVaultName> --set properties.enablePurgeProtection=true properties.enableSoftDelete=true From PowerShell Update-AzKeyVault -VaultName <vaultName -ResourceGroupName <resourceGroupName -EnablePurgeProtection",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-the-key-vault-is-recoverable#terraform",
            "az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault/vaults/<keyVaultName> --set properties.enablePurgeProtection=trueproperties.enableSoftDelete=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/KeyVault/enable-key-vault-recoverability.html#",
            "https://blogs.technet.microsoft.com/kv/2017/05/10/azure-key-vault-recovery-options/"
        ]
    },
    "risk_details": "There could be scenarios where users accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible. There are 2 Key Vault properties that play a role in permanent unavailability of a Key Vault: 1. enableSoftDelete: Setting this parameter to 'true' for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, key vault and its objects will subsequently be purged. 2. enablePurgeProtection: enableSoftDelete only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are scenarios in which the Key Vault and/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to 'true' ensures that the Key Vault and its objects cannot be purged. Enabling both the parameters on Key Vaults ensures that Key Vaults and their objects cannot be deleted/purged permanently.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0169 from subscription Azure for Students is not recoverable.",
    "metadata": {
        "event_code": "keyvault_recoverable",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault kv-0169 from subscription Azure for Students is not recoverable.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-soft-delete-cli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Once purge-protection and soft-delete are enabled for a Key Vault, the action is irreversible.",
        "compliance": {
            "CIS-2.0": [
                "8.5"
            ],
            "CIS-2.1": [
                "8.5"
            ],
            "CIS-3.0": [
                "3.3.5"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects. It is recommended the Key Vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user. WARNING: A current limitation of the soft-delete feature across all Azure services is role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.",
        "title": "Ensure the Key Vault is Recoverable",
        "types": [],
        "uid": "prowler-azure-keyvault_recoverable-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169",
                    "name": "kv-0169",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [
                            {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169/privateEndpointConnections/psc-kv-01"
                            }
                        ],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0169",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "To enable 'Do Not Purge' and 'Soft Delete' for a Key Vault: From Azure Portal 1. Go to Key Vaults 2. For each Key Vault 3. Click Properties 4. Ensure the status of soft-delete reads Soft delete has been enabled on this key vault. 5. At the bottom of the page, click 'Enable Purge Protection' Note, once enabled you cannot disable it. From Azure CLI az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx- xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault /vaults/<keyVaultName> --set properties.enablePurgeProtection=true properties.enableSoftDelete=true From PowerShell Update-AzKeyVault -VaultName <vaultName -ResourceGroupName <resourceGroupName -EnablePurgeProtection",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-the-key-vault-is-recoverable#terraform",
            "az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault/vaults/<keyVaultName> --set properties.enablePurgeProtection=trueproperties.enableSoftDelete=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/KeyVault/enable-key-vault-recoverability.html#",
            "https://blogs.technet.microsoft.com/kv/2017/05/10/azure-key-vault-recovery-options/"
        ]
    },
    "risk_details": "There could be scenarios where users accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible. There are 2 Key Vault properties that play a role in permanent unavailability of a Key Vault: 1. enableSoftDelete: Setting this parameter to 'true' for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, key vault and its objects will subsequently be purged. 2. enablePurgeProtection: enableSoftDelete only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are scenarios in which the Key Vault and/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to 'true' ensures that the Key Vault and its objects cannot be purged. Enabling both the parameters on Key Vaults ensures that Key Vaults and their objects cannot be deleted/purged permanently.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Keyvault kv-0269 from subscription Azure for Students is not recoverable.",
    "metadata": {
        "event_code": "keyvault_recoverable",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Keyvault kv-0269 from subscription Azure for Students is not recoverable.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/key-vault/key-vault-soft-delete-cli",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Once purge-protection and soft-delete are enabled for a Key Vault, the action is irreversible.",
        "compliance": {
            "CIS-2.0": [
                "8.5"
            ],
            "CIS-2.1": [
                "8.5"
            ],
            "CIS-3.0": [
                "3.3.5"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects. It is recommended the Key Vault be made recoverable by enabling the 'Do Not Purge' and 'Soft Delete' functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user. WARNING: A current limitation of the soft-delete feature across all Azure services is role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.",
        "title": "Ensure the Key Vault is Recoverable",
        "types": [],
        "uid": "prowler-azure-keyvault_recoverable-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-kv-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269",
                    "name": "kv-0269",
                    "location": "westeurope",
                    "resource_group": "terrasec",
                    "properties": {
                        "tenant_id": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
                        "enable_rbac_authorization": false,
                        "private_endpoint_connections": [],
                        "enable_soft_delete": true,
                        "enable_purge_protection": null
                    },
                    "keys": [],
                    "secrets": [],
                    "monitor_diagnostic_settings": []
                }
            },
            "group": {
                "name": "keyvault"
            },
            "labels": [],
            "name": "kv-0269",
            "type": "KeyVault",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.KeyVault/vaults/kv-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "To enable 'Do Not Purge' and 'Soft Delete' for a Key Vault: From Azure Portal 1. Go to Key Vaults 2. For each Key Vault 3. Click Properties 4. Ensure the status of soft-delete reads Soft delete has been enabled on this key vault. 5. At the bottom of the page, click 'Enable Purge Protection' Note, once enabled you cannot disable it. From Azure CLI az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx- xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault /vaults/<keyVaultName> --set properties.enablePurgeProtection=true properties.enableSoftDelete=true From PowerShell Update-AzKeyVault -VaultName <vaultName -ResourceGroupName <resourceGroupName -EnablePurgeProtection",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-the-key-vault-is-recoverable#terraform",
            "az resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx/resourceGroups/<resourceGroupName>/providers/Microsoft.KeyVault/vaults/<keyVaultName> --set properties.enablePurgeProtection=trueproperties.enableSoftDelete=true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/KeyVault/enable-key-vault-recoverability.html#",
            "https://blogs.technet.microsoft.com/kv/2017/05/10/azure-key-vault-recovery-options/"
        ]
    },
    "risk_details": "There could be scenarios where users accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible. There are 2 Key Vault properties that play a role in permanent unavailability of a Key Vault: 1. enableSoftDelete: Setting this parameter to 'true' for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, key vault and its objects will subsequently be purged. 2. enablePurgeProtection: enableSoftDelete only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are scenarios in which the Key Vault and/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to 'true' ensures that the Key Vault and its objects cannot be purged. Enabling both the parameters on Key Vaults ensures that Key Vaults and their objects cannot be deleted/purged permanently.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for creating Policy Assignments in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_create_policy_assignment",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating Policy Assignments in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.1"
            ],
            "CIS-2.1": [
                "5.2.1"
            ],
            "CIS-3.0": [
                "6.2.1"
            ],
            "ENS-RD2022": [
                "op.mon.2.r1.az.ma.1"
            ],
            "MITRE-ATTACK": [
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Create Policy Assignment event.",
        "title": "Ensure that Activity Log Alert exists for Create Policy Assignment",
        "types": [],
        "uid": "prowler-azure-monitor_alert_create_policy_assignment-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Policy assignment (policyAssignments). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create policy assignment (Microsoft.Authorization/policyAssignments). 12. Select the Actions tab. 13. To use an existing action group, click elect action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/write and level=<verbose | information | warning | error | critical> --scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription ID> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-alert-for-create-policy-assignment-events.html#trendmicro",
            "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log"
        ]
    },
    "risk_details": "Monitoring for create policy assignment events gives insight into changes done in 'Azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for creating/updating Network Security Groups in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_create_update_nsg",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Network Security Groups in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.3"
            ],
            "CIS-2.1": [
                "5.2.3"
            ],
            "CIS-3.0": [
                "6.2.3"
            ],
            "PCI-4.0": [
                "10.2.1.1.8",
                "10.4.2.2",
                "10.4.3.1",
                "10.6.3.8",
                "10.7.1.3",
                "10.7.2.3",
                "11.5.2.2",
                "11.6.1.2",
                "12.10.5.2",
                "A3.3.1.3",
                "A3.5.1.3"
            ],
            "ENS-RD2022": [
                "op.mon.2.r1.az.ma.1"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an Activity Log Alert for the Create or Update Network Security Group event.",
        "title": "Ensure that Activity Log Alert exists for Create or Update Network Security Group",
        "types": [],
        "uid": "prowler-azure-monitor_alert_create_update_nsg-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Network security groups. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Network Security Group (Microsoft.Network/networkSecurityGroups). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/write and level=verbose --scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' --subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-update-network-security-group-rule-alert-in-use.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Create or Update Network Security Group events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for creating/updating Public IP address rule in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_create_update_public_ip_address_rule",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Public IP address rule in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.9"
            ],
            "CIS-2.1": [
                "5.2.9"
            ],
            "CIS-3.0": [
                "6.2.9"
            ],
            "ENS-RD2022": [
                "op.mon.2.r1.az.ma.1"
            ],
            "MITRE-ATTACK": [
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.1",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.11"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Create or Update Public IP Addresses rule.",
        "title": "Ensure that Activity Log Alert exists for Create or Update Public IP Address rule",
        "types": [],
        "uid": "prowler-azure-monitor_alert_create_update_public_ip_address_rule-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Public IP addresses. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Public Ip Address (Microsoft.Network/publicIPAddresses). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Network/publicIPAddresses/write and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-or-update-public-ip-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Create or Update Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for creating/updating Security Solution in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_create_update_security_solution",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Security Solution in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.5"
            ],
            "CIS-2.1": [
                "5.2.5"
            ],
            "CIS-3.0": [
                "6.2.5"
            ],
            "ENS-RD2022": [
                "op.mon.2.r1.az.ma.1",
                "op.mon.3.r6.az.ma.1"
            ],
            "MITRE-ATTACK": [
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.5.16",
                "A.5.22",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Create or Update Security Solution event.",
        "title": "Ensure that Activity Log Alert exists for Create or Update Security Solution",
        "types": [],
        "uid": "prowler-azure-monitor_alert_create_update_security_solution-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Security Solutions (securitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/write and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-or-update-security-solution-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Create or Update Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for creating/updating SQL Server firewall rule in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_create_update_sqlserver_fr",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating SQL Server firewall rule in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.7"
            ],
            "CIS-2.1": [
                "5.2.7"
            ],
            "CIS-3.0": [
                "6.2.7"
            ],
            "PCI-4.0": [
                "10.2.1.1.9",
                "10.2.1.1.10",
                "10.2.1.1.22",
                "10.2.1.2.8",
                "10.2.1.2.19",
                "10.2.1.3.8",
                "10.2.1.3.19",
                "10.2.1.4.8",
                "10.2.1.4.19",
                "10.2.1.5.8",
                "10.2.1.5.19",
                "10.2.1.6.8",
                "10.2.1.6.19",
                "10.2.1.7.8",
                "10.2.1.7.19",
                "10.2.1.8",
                "10.2.1.19",
                "10.2.2.8",
                "10.2.2.19",
                "10.3.1.8",
                "10.3.1.19",
                "10.4.1.1.2",
                "10.4.1.2",
                "10.4.2.3",
                "10.6.3.9",
                "10.6.3.10",
                "10.6.3.24",
                "10.7.1.4",
                "10.7.2.4",
                "5.3.4.9",
                "5.3.4.22",
                "A1.2.1.10",
                "A1.2.1.23",
                "A3.3.1.4",
                "A3.5.1.4"
            ],
            "ENS-RD2022": [
                "op.mon.2.r1.az.ma.1"
            ],
            "MITRE-ATTACK": [
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Create or Update SQL Server Firewall Rule event.",
        "title": "Ensure that Activity Log Alert exists for Create or Update SQL Server Firewall Rule",
        "types": [],
        "uid": "prowler-azure-monitor_alert_create_update_sqlserver_fr-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Server Firewall Rule (servers/firewallRules). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create/Update server firewall rule (Microsoft.Sql/servers/firewallRules). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/write and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-or-update-or-delete-sql-server-firewall-rule-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Create or Update SQL Server Firewall Rule events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for deleting Network Security Groups in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_delete_nsg",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting Network Security Groups in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.4"
            ],
            "CIS-2.1": [
                "5.2.4"
            ],
            "CIS-3.0": [
                "6.2.4"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.2"
            ],
            "MITRE-ATTACK": [
                "T1485",
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Delete Network Security Group event.",
        "title": "Ensure that Activity Log Alert exists for Delete Network Security Group",
        "types": [],
        "uid": "prowler-azure-monitor_alert_delete_nsg-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Network security groups. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Network Security Group (Microsoft.Network/networkSecurityGroups). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/delete and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/delete-network-security-group-rule-alert-in-use.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for 'Delete Network Security Group' events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for deleting policy assignment in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_delete_policy_assignment",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting policy assignment in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/rest/api/monitor/activitylogalerts/createorupdate",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.2"
            ],
            "CIS-2.1": [
                "5.2.2"
            ],
            "CIS-3.0": [
                "6.2.2"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.2"
            ],
            "MITRE-ATTACK": [
                "T1485",
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Delete Policy Assignment event.",
        "title": "Ensure that Activity Log Alert exists for Delete Policy Assignment",
        "types": [],
        "uid": "prowler-azure-monitor_alert_delete_policy_assignment-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Policy assignment (policyAssignments). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete policy assignment (Microsoft.Authorization/policyAssignments). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/delete and level=<verbose | information | warning | error | critical> --scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/delete-policy-assignment-alert-in-use.html#trendmicro",
            "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log"
        ]
    },
    "risk_details": "Monitoring for delete policy assignment events gives insight into changes done in 'azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for deleting public IP address rule in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_delete_public_ip_address_rule",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting public IP address rule in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.10"
            ],
            "CIS-2.1": [
                "5.2.10"
            ],
            "CIS-3.0": [
                "6.2.10"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.2"
            ],
            "MITRE-ATTACK": [
                "T1485",
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.1",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.12"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Delete Public IP Address rule.",
        "title": "Ensure that Activity Log Alert exists for Delete Public IP Address rule",
        "types": [],
        "uid": "prowler-azure-monitor_alert_delete_public_ip_address_rule-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Public IP addresses. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Public Ip Address (Microsoft.Network/publicIPAddresses). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Network/publicIPAddresses/delete and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/delete-public-ip-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Delete Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for deleting Security Solution in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_delete_security_solution",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting Security Solution in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.6"
            ],
            "CIS-2.1": [
                "5.2.6"
            ],
            "CIS-3.0": [
                "6.2.6"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.2"
            ],
            "MITRE-ATTACK": [
                "T1485",
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.5.16",
                "A.5.22",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the Delete Security Solution event.",
        "title": "Ensure that Activity Log Alert exists for Delete Security Solution",
        "types": [],
        "uid": "prowler-azure-monitor_alert_delete_security_solution-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Security Solutions (securitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.curitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/delete and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/delete-security-solution-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Delete Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There is not an alert for deleting SQL Server firewall rule in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_alert_delete_sqlserver_fr",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting SQL Server firewall rule in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, no monitoring alerts are created.",
        "compliance": {
            "CIS-2.0": [
                "5.2.8"
            ],
            "CIS-2.1": [
                "5.2.8"
            ],
            "CIS-3.0": [
                "6.2.8"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.2"
            ],
            "MITRE-ATTACK": [
                "T1485",
                "T1496"
            ],
            "ISO27001-2022": [
                "A.5.7",
                "A.8.16"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Create an activity log alert for the 'Delete SQL Server Firewall Rule.'",
        "title": "Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule",
        "types": [],
        "uid": "prowler-azure-monitor_alert_delete_sqlserver_fr-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Server Firewall Rule (servers/firewallRules). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete server firewall rule (Microsoft.Sql/servers/firewallRules). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
        "references": [
            "az monitor activity-log alert create --resource-group '<resource group name>' --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/delete and level=<verbose | information | warning | error | critical>--scope '/subscriptions/<subscription ID>' --name '<activity log rule name>' -- subscription <subscription id> --action-group <action group ID> --location global",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/ActivityLog/create-or-update-or-delete-sql-server-firewall-rule-alert.html#trendmicro",
            "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
        ]
    },
    "risk_details": "Monitoring for Delete SQL Server Firewall Rule events gives insight into SQL network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "No diagnostic settings found in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_diagnostic_settings_exists",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "No diagnostic settings found in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "By default, diagnostic setting is not set.",
        "compliance": {
            "CIS-2.0": [
                "5.1.1"
            ],
            "CIS-2.1": [
                "5.1.1"
            ],
            "CIS-3.0": [
                "6.1.1"
            ],
            "ENS-RD2022": [
                "op.exp.8.r5.az.ds.1",
                "op.mon.2.r2.az.ma.1"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Diagnostic settings for exporting activity logs. Diagnostic settings are available for each individual resource within a subscription. Settings should be configured for all appropriate resources for your environment.",
        "title": "Ensure that a 'Diagnostic Setting' exists for Subscription Activity Logs ",
        "types": [],
        "uid": "prowler-azure-monitor_diagnostic_settings_exists-31661dbb-923c-429d-b434-b6bd19dcd287-global-Diagnostic Settings"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Diagnostic Settings",
            "type": "Monitor",
            "uid": "diagnostic_settings"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "To enable Diagnostic Settings on a Subscription: 1. Go to Monitor 2. Click on Activity Log 3. Click on Export Activity Logs 4. Click + Add diagnostic setting 5. Enter a Diagnostic setting name 6. Select Categories for the diagnostic settings 7. Select the appropriate Destination details (this may be Log Analytics, Storage Account, Event Hub, or Partner solution) 8. Click Save To enable Diagnostic Settings on a specific resource: 1. Go to Monitor 2. Click Diagnostic settings 3. Click on the resource that has a diagnostics status of disabled 4. Select Add Diagnostic Setting 5. Enter a Diagnostic setting name 6. Select the appropriate log, metric, and destination. (this may be Log Analytics, Storage Account, Event Hub, or Partner solution) 7. Click save Repeat these step for all resources as needed.",
        "references": [
            "az monitor diagnostic-settings subscription create --subscription <subscription id> --name <diagnostic settings name> --location <location> <[- -event-hub <event hub ID> --event-hub-auth-rule <event hub auth rule ID>] [-- storage-account <storage account ID>] [--workspace <log analytics workspace ID>] --logs '<JSON encoded categories>' (e.g. [{category:Security,enabled:true},{category:Administrative,enabled:true},{cat egory:Alert,enabled:true},{category:Policy,enabled:true}])",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Monitor/subscription-activity-log-diagnostic-settings.html#trendmicro",
            "https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs#export-the-activity-log-with-a-log-profile"
        ]
    },
    "risk_details": "A diagnostic setting controls how a diagnostic log is exported. By default, logs are retained only for 90 days. Diagnostic settings should be defined so that logs can be exported and stored for a longer duration in order to analyze security activities within an Azure subscription.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "There are no diagnostic settings capturing appropiate categories in subscription Azure for Students.",
    "metadata": {
        "event_code": "monitor_diagnostic_setting_with_appropriate_categories",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no diagnostic settings capturing appropiate categories in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "When the diagnostic setting is created using Azure Portal, by default no categories are selected.",
        "compliance": {
            "CIS-2.0": [
                "5.1.2"
            ],
            "CIS-2.1": [
                "5.1.2"
            ],
            "CIS-3.0": [
                "6.1.2"
            ],
            "PCI-4.0": [
                "10.2.1.1.7",
                "10.2.1.1.15",
                "10.2.1.2.7",
                "10.2.1.3.7",
                "10.2.1.4.7",
                "10.2.1.5.7",
                "10.2.1.6.7",
                "10.2.1.7.7",
                "10.2.1.7",
                "10.2.2.7",
                "10.3.1.7",
                "10.3.2.2",
                "10.3.3.4",
                "10.3.4.3",
                "10.4.1.1.3",
                "10.4.1.1.4",
                "10.4.1.3",
                "10.4.2.4",
                "10.5.1.3",
                "10.6.3.7",
                "10.6.3.15",
                "10.7.1.5",
                "10.7.2.5",
                "11.5.2.4",
                "11.6.1.4",
                "12.10.5.4",
                "5.3.4.7",
                "5.3.4.8",
                "A1.2.1.7",
                "A1.2.1.8",
                "A3.3.1.6",
                "A3.3.1.7",
                "A3.5.1.6",
                "A3.5.1.7"
            ],
            "ENS-RD2022": [
                "op.exp.8.az.md.1",
                "op.mon.2.az.md.1"
            ],
            "ISO27001-2022": [
                "A.5.16",
                "A.5.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Prerequisite: A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recommendation will not be available. Please review the recommendation at the beginning of this subsection titled: 'Ensure that a 'Diagnostic Setting' exists.' The diagnostic setting should be configured to log the appropriate activities from the control/management plane.",
        "title": "Ensure Diagnostic Setting captures appropriate categories",
        "types": [],
        "uid": "prowler-azure-monitor_diagnostic_setting_with_appropriate_categories-31661dbb-923c-429d-b434-b6bd19dcd287-global-Monitor"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "monitor"
            },
            "labels": [],
            "name": "Monitor",
            "type": "Monitor",
            "uid": "Monitor"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. Go to Azure Monitor 2. Click Activity log 3. Click on Export Activity Logs 4. Select the Subscription from the drop down menu 5. Click on Add diagnostic setting 6. Enter a name for your new Diagnostic Setting 7. Check the following categories: Administrative, Alert, Policy, and Security 8. Choose the destination details according to your organization's needs.",
        "references": [
            "az monitor diagnostic-settings subscription create --subscription <subscription id> --name <diagnostic settings name> --location <location> <[- -event-hub <event hub ID> --event-hub-auth-rule <event hub auth rule ID>] [-- storage-account <storage account ID>] [--workspace <log analytics workspace ID>] --logs '[{category:Security,enabled:true},{category:Administrative,enabled:true},{ca tegory:Alert,enabled:true},{category:Policy,enabled:true}]'>",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Monitor/diagnostic-setting-categories.html",
            "https://learn.microsoft.com/en-us/azure/storage/common/manage-storage-analytics-logs?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json&tabs=azure-portal"
        ]
    },
    "risk_details": "A diagnostic setting controls how the diagnostic log is exported. Capturing the diagnostic setting categories for appropriate control/management plane activities allows proper alerting.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Bastion Host from subscription Azure for Students does not exist",
    "metadata": {
        "event_code": "network_bastion_host_exists",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Bastion Host from subscription Azure for Students does not exist",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/bastion/bastion-overview#sku",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "The Azure Bastion service incurs additional costs and requires a specific virtual network configuration. The Standard tier offers additional configuration options compared to the Basic tier and may incur additional costs for those added features.",
        "compliance": {
            "CIS-2.0": [
                "7.1"
            ],
            "CIS-2.1": [
                "7.1"
            ],
            "CIS-3.0": [
                "8.1"
            ],
            "ENS-RD2022": [
                "mp.com.4.r4.az.nt.1"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.5"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Internet. The Azure Bastion service provides this access using TLS over 443/TCP, and subscribes to hardened configurations within an organization's Azure Active Directory service.",
        "title": "Ensure an Azure Bastion Host Exists",
        "types": [],
        "uid": "prowler-azure-network_bastion_host_exists-31661dbb-923c-429d-b434-b6bd19dcd287-global-Bastion Host"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "Bastion Host",
            "type": "Network",
            "uid": "Bastion Host"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "From Azure Portal* 1. Click on Bastions 2. Select the Subscription 3. Select the Resource group 4. Type a Name for the new Bastion host 5. Select a Region 6. Choose Standard next to Tier 7. Use the slider to set the Instance count 8. Select the Virtual network or Create new 9. Select the Subnet named AzureBastionSubnet. Create a Subnet named AzureBastionSubnet using a /26 CIDR range if it doesn't already exist. 10. Selct the appropriate Public IP address option. 11. If Create new is selected for the Public IP address option, provide a Public IP address name. 12. If Use existing is selected for Public IP address option, select an IP address from Choose public IP address 13. Click Next: Tags > 14. Configure the appropriate Tags 15. Click Next: Advanced > 16. Select the appropriate Advanced options 17. Click Next: Review + create > 18. Click Create From Azure CLI az network bastion create --location <location> --name <name of bastion host> --public-ip-address <public IP address name or ID> --resource-group <resource group name or ID> --vnet-name <virtual network containing subnet called 'AzureBastionSubnet'> --scale-units <integer> --sku Standard [--disable-copy- paste true|false] [--enable-ip-connect true|false] [--enable-tunneling true|false] From PowerShell Create the appropriate Virtual network settings and Public IP Address settings. $subnetName = 'AzureBastionSubnet' $subnet = New-AzVirtualNetworkSubnetConfig -Name $subnetName -AddressPrefix <IP address range in CIDR notation making sure to use a /26> $virtualNet = New-AzVirtualNetwork -Name <virtual network name> - ResourceGroupName <resource group name> -Location <location> -AddressPrefix <IP address range in CIDR notation> -Subnet $subnet $publicip = New-AzPublicIpAddress -ResourceGroupName <resource group name> - Name <public IP address name> -Location <location> -AllocationMethod Dynamic -Sku Standard",
        "references": [
            "az network bastion create --location <location> --name <name of bastion host> --public-ip-address <public IP address name or ID> --resource-group <resource group name or ID> --vnet-name <virtual network containing subnet called 'AzureBastionSubnet'> --scale-units <integer> --sku Standard [--disable-copy- paste true|false] [--enable-ip-connect true|false] [--enable-tunneling true|false]",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/bastion-host-exists.html",
            "https://learn.microsoft.com/en-us/powershell/module/az.network/get-azbastion?view=azps-9.2.0"
        ]
    },
    "risk_details": "The Azure Bastion service allows organizations a more secure means of accessing Azure Virtual Machines over the Internet without assigning public IP addresses to those Virtual Machines. The Azure Bastion service provides Remote Desktop Protocol (RDP) and Secure Shell (SSH) access to Virtual Machines using TLS within a web browser, thus preventing organizations from opening up 3389/TCP and 22/TCP to the Internet on Azure Virtual Machines. Additional benefits of the Bastion service includes Multi-Factor Authentication, Conditional Access Policies, and any other hardening measures configured within Azure Active Directory using a central point of access.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_eastus from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_captured_sent",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_eastus from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-4-enable-network-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "The impact of configuring NSG Flow logs is primarily one of cost and configuration. If deployed, it will create storage accounts that hold minimal amounts of data on a 5-day lifecycle before feeding to Log Analytics Workspace. This will increase the amount of data stored and used by Azure Monitor.",
        "compliance": {
            "CIS-2.0": [
                "5.1.6"
            ],
            "CIS-2.1": [
                "5.1.5"
            ],
            "CIS-3.0": [
                "6.1.5"
            ],
            "ENS-RD2022": [
                "op.mon.1.r1.az.nf.1",
                "op.mon.3.az.nw.1",
                "mp.s.4.r1.az.nt.1"
            ],
            "MITRE-ATTACK": [
                "T1048",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "title": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "types": [],
        "uid": "prowler-azure-network_flow_log_captured_sent-31661dbb-923c-429d-b434-b6bd19dcd287-eastus-NetworkWatcher_eastus"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "eastus",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_eastus",
                    "name": "NetworkWatcher_eastus",
                    "location": "eastus",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_eastus",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_eastus"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "eastus"
    },
    "remediation": {
        "desc": "1. Navigate to Network Watcher. 2. Select NSG flow logs. 3. Select + Create. 4. Select the desired Subscription. 5. Select + Select NSG. 6. Select a network security group. 7. Click Confirm selection. 8. Select or create a new Storage Account. 9. Input the retention in days to retain the log. 10. Click Next. 11. Under Configuration, select Version 2. 12. If rich analytics are required, select Enable Traffic Analytics, a processing interval, and a Log Analytics Workspace. 13. Select Next. 14. Optionally add Tags. 15. Select Review + create. 16. Select Create. Warning The remediation policy creates remediation deployment and names them by concatenating the subscription name and the resource group name. The MAXIMUM permitted length of a deployment name is 64 characters. Exceeding this will cause the remediation task to fail.",
        "references": [
            "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-portal"
        ]
    },
    "risk_details": "Network Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_polandcentral from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_captured_sent",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_polandcentral from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-4-enable-network-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "The impact of configuring NSG Flow logs is primarily one of cost and configuration. If deployed, it will create storage accounts that hold minimal amounts of data on a 5-day lifecycle before feeding to Log Analytics Workspace. This will increase the amount of data stored and used by Azure Monitor.",
        "compliance": {
            "CIS-2.0": [
                "5.1.6"
            ],
            "CIS-2.1": [
                "5.1.5"
            ],
            "CIS-3.0": [
                "6.1.5"
            ],
            "ENS-RD2022": [
                "op.mon.1.r1.az.nf.1",
                "op.mon.3.az.nw.1",
                "mp.s.4.r1.az.nt.1"
            ],
            "MITRE-ATTACK": [
                "T1048",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "title": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "types": [],
        "uid": "prowler-azure-network_flow_log_captured_sent-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-NetworkWatcher_polandcentral"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_polandcentral",
                    "name": "NetworkWatcher_polandcentral",
                    "location": "polandcentral",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_polandcentral",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_polandcentral"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "1. Navigate to Network Watcher. 2. Select NSG flow logs. 3. Select + Create. 4. Select the desired Subscription. 5. Select + Select NSG. 6. Select a network security group. 7. Click Confirm selection. 8. Select or create a new Storage Account. 9. Input the retention in days to retain the log. 10. Click Next. 11. Under Configuration, select Version 2. 12. If rich analytics are required, select Enable Traffic Analytics, a processing interval, and a Log Analytics Workspace. 13. Select Next. 14. Optionally add Tags. 15. Select Review + create. 16. Select Create. Warning The remediation policy creates remediation deployment and names them by concatenating the subscription name and the resource group name. The MAXIMUM permitted length of a deployment name is 64 characters. Exceeding this will cause the remediation task to fail.",
        "references": [
            "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-portal"
        ]
    },
    "risk_details": "Network Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_westeurope from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_captured_sent",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_westeurope from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-4-enable-network-logging-for-security-investigation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "The impact of configuring NSG Flow logs is primarily one of cost and configuration. If deployed, it will create storage accounts that hold minimal amounts of data on a 5-day lifecycle before feeding to Log Analytics Workspace. This will increase the amount of data stored and used by Azure Monitor.",
        "compliance": {
            "CIS-2.0": [
                "5.1.6"
            ],
            "CIS-2.1": [
                "5.1.5"
            ],
            "CIS-3.0": [
                "6.1.5"
            ],
            "ENS-RD2022": [
                "op.mon.1.r1.az.nf.1",
                "op.mon.3.az.nw.1",
                "mp.s.4.r1.az.nt.1"
            ],
            "MITRE-ATTACK": [
                "T1048",
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.1.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "title": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
        "types": [],
        "uid": "prowler-azure-network_flow_log_captured_sent-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-NetworkWatcher_westeurope"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westeurope",
                    "name": "NetworkWatcher_westeurope",
                    "location": "westeurope",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_westeurope",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westeurope"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Navigate to Network Watcher. 2. Select NSG flow logs. 3. Select + Create. 4. Select the desired Subscription. 5. Select + Select NSG. 6. Select a network security group. 7. Click Confirm selection. 8. Select or create a new Storage Account. 9. Input the retention in days to retain the log. 10. Click Next. 11. Under Configuration, select Version 2. 12. If rich analytics are required, select Enable Traffic Analytics, a processing interval, and a Log Analytics Workspace. 13. Select Next. 14. Optionally add Tags. 15. Select Review + create. 16. Select Create. Warning The remediation policy creates remediation deployment and names them by concatenating the subscription name and the resource group name. The MAXIMUM permitted length of a deployment name is 64 characters. Exceeding this will cause the remediation task to fail.",
        "references": [
            "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-portal"
        ]
    },
    "risk_details": "Network Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_eastus from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_more_than_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_eastus from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": " https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This will keep IP traffic logs for longer than 90 days. As a level 2, first determine your need to retain data, then apply your selection here. As this is data stored for longer, your monthly storage costs will increase depending on your data use.",
        "compliance": {
            "CIS-2.0": [
                "6.5"
            ],
            "CIS-2.1": [
                "6.5"
            ],
            "CIS-3.0": [
                "7.5"
            ],
            "PCI-4.0": [
                "10.2.1.1.34",
                "10.2.1.2.29",
                "10.2.1.3.29",
                "10.2.1.4.29",
                "10.2.1.5.29",
                "10.2.1.6.29",
                "10.2.1.7.29",
                "10.2.1.29",
                "10.2.2.29",
                "10.3.1.29",
                "10.6.3.39",
                "5.3.4.34",
                "A1.2.1.34"
            ],
            "ENS-RD2022": [
                "op.exp.8.r3.az.nt.1",
                "op.mon.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.",
        "title": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'",
        "types": [],
        "uid": "prowler-azure-network_flow_log_more_than_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-eastus-NetworkWatcher_eastus"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "eastus",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_eastus",
                    "name": "NetworkWatcher_eastus",
                    "location": "eastus",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_eastus",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_eastus"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "eastus"
    },
    "remediation": {
        "desc": "From Azure Portal 1. Go to Network Watcher 2. Select NSG flow logs blade in the Logs section 3. Select each Network Security Group from the list 4. Ensure Status is set to On 5. Ensure Retention (days) setting greater than 90 days 6. Select your storage account in the Storage account field 7. Select Save From Azure CLI Enable the NSG flow logs and set the Retention (days) to greater than or equal to 90 days. az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 --storage-account <NameorID of the storage account to save flow logs>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_1#terraform",
            "az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 -- storage-account <NameorID of the storage account to save flow logs>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/sufficient-nsg-flow-log-retention-period.html",
            "https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest"
        ]
    },
    "risk_details": "Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_polandcentral from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_more_than_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_polandcentral from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": " https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This will keep IP traffic logs for longer than 90 days. As a level 2, first determine your need to retain data, then apply your selection here. As this is data stored for longer, your monthly storage costs will increase depending on your data use.",
        "compliance": {
            "CIS-2.0": [
                "6.5"
            ],
            "CIS-2.1": [
                "6.5"
            ],
            "CIS-3.0": [
                "7.5"
            ],
            "PCI-4.0": [
                "10.2.1.1.34",
                "10.2.1.2.29",
                "10.2.1.3.29",
                "10.2.1.4.29",
                "10.2.1.5.29",
                "10.2.1.6.29",
                "10.2.1.7.29",
                "10.2.1.29",
                "10.2.2.29",
                "10.3.1.29",
                "10.6.3.39",
                "5.3.4.34",
                "A1.2.1.34"
            ],
            "ENS-RD2022": [
                "op.exp.8.r3.az.nt.1",
                "op.mon.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.",
        "title": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'",
        "types": [],
        "uid": "prowler-azure-network_flow_log_more_than_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-NetworkWatcher_polandcentral"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_polandcentral",
                    "name": "NetworkWatcher_polandcentral",
                    "location": "polandcentral",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_polandcentral",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_polandcentral"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "From Azure Portal 1. Go to Network Watcher 2. Select NSG flow logs blade in the Logs section 3. Select each Network Security Group from the list 4. Ensure Status is set to On 5. Ensure Retention (days) setting greater than 90 days 6. Select your storage account in the Storage account field 7. Select Save From Azure CLI Enable the NSG flow logs and set the Retention (days) to greater than or equal to 90 days. az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 --storage-account <NameorID of the storage account to save flow logs>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_1#terraform",
            "az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 -- storage-account <NameorID of the storage account to save flow logs>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/sufficient-nsg-flow-log-retention-period.html",
            "https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest"
        ]
    },
    "risk_details": "Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher NetworkWatcher_westeurope from subscription Azure for Students has no flow logs",
    "metadata": {
        "event_code": "network_flow_log_more_than_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_westeurope from subscription Azure for Students has no flow logs",
    "status_id": 1,
    "unmapped": {
        "related_url": " https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "This will keep IP traffic logs for longer than 90 days. As a level 2, first determine your need to retain data, then apply your selection here. As this is data stored for longer, your monthly storage costs will increase depending on your data use.",
        "compliance": {
            "CIS-2.0": [
                "6.5"
            ],
            "CIS-2.1": [
                "6.5"
            ],
            "CIS-3.0": [
                "7.5"
            ],
            "PCI-4.0": [
                "10.2.1.1.34",
                "10.2.1.2.29",
                "10.2.1.3.29",
                "10.2.1.4.29",
                "10.2.1.5.29",
                "10.2.1.6.29",
                "10.2.1.7.29",
                "10.2.1.29",
                "10.2.2.29",
                "10.3.1.29",
                "10.6.3.39",
                "5.3.4.34",
                "A1.2.1.34"
            ],
            "ENS-RD2022": [
                "op.exp.8.r3.az.nt.1",
                "op.mon.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1499"
            ],
            "ISO27001-2022": [
                "A.8.15",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.",
        "title": "Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'",
        "types": [],
        "uid": "prowler-azure-network_flow_log_more_than_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-NetworkWatcher_westeurope"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westeurope",
                    "name": "NetworkWatcher_westeurope",
                    "location": "westeurope",
                    "flow_logs": []
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "NetworkWatcher_westeurope",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westeurope"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From Azure Portal 1. Go to Network Watcher 2. Select NSG flow logs blade in the Logs section 3. Select each Network Security Group from the list 4. Ensure Status is set to On 5. Ensure Retention (days) setting greater than 90 days 6. Select your storage account in the Storage account field 7. Select Save From Azure CLI Enable the NSG flow logs and set the Retention (days) to greater than or equal to 90 days. az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 --storage-account <NameorID of the storage account to save flow logs>",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_1#terraform",
            "az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 -- storage-account <NameorID of the storage account to save flow logs>",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/sufficient-nsg-flow-log-retention-period.html",
            "https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest"
        ]
    },
    "risk_details": "Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group vv-vm-01-nsg from subscription Azure for Students has HTTP internet access allowed.",
    "metadata": {
        "event_code": "network_http_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Security Group vv-vm-01-nsg from subscription Azure for Students has HTTP internet access allowed.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.4"
            ],
            "CIS-2.1": [
                "6.4"
            ],
            "CIS-3.0": [
                "7.4"
            ],
            "PCI-4.0": [
                "1.2.5.5",
                "1.2.8.25",
                "1.3.1.28",
                "1.3.2.28",
                "1.4.1.6",
                "1.4.2.26",
                "1.4.4.6",
                "1.5.1.25",
                "2.2.5.5",
                "2.2.7.3",
                "4.2.1.1.7",
                "4.2.1.3",
                "8.3.2.6",
                "A1.1.3.25"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.1",
                "mp.com.4.r3.az.1",
                "mp.com.4.r4.az.nt.1",
                "mp.s.4.az.nt.1"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.",
        "title": "Ensure that HTTP(S) access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_http_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01-nsg"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg",
                    "name": "vv-vm-01-nsg",
                    "location": "polandcentral",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/SSH",
                            "name": "SSH",
                            "destination_port_range": "22",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTP",
                            "name": "HTTP",
                            "destination_port_range": "80",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTPS",
                            "name": "HTTPS",
                            "destination_port_range": "443",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom443Outbound",
                            "name": "AllowAnyCustom443Outbound",
                            "destination_port_range": "443",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom53Outbound",
                            "name": "AllowAnyCustom53Outbound",
                            "destination_port_range": "53",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom5432Inbound",
                            "name": "AllowAnyCustom5432Inbound",
                            "destination_port_range": "5432",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "vv-vm-01-nsg",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Where HTTP(S) is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-http-access.html"
        ]
    },
    "risk_details": "The potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group nsg-insecure-vm from subscription Azure for Students has HTTP internet access allowed.",
    "metadata": {
        "event_code": "network_http_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Security Group nsg-insecure-vm from subscription Azure for Students has HTTP internet access allowed.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.4"
            ],
            "CIS-2.1": [
                "6.4"
            ],
            "CIS-3.0": [
                "7.4"
            ],
            "PCI-4.0": [
                "1.2.5.5",
                "1.2.8.25",
                "1.3.1.28",
                "1.3.2.28",
                "1.4.1.6",
                "1.4.2.26",
                "1.4.4.6",
                "1.5.1.25",
                "2.2.5.5",
                "2.2.7.3",
                "4.2.1.1.7",
                "4.2.1.3",
                "8.3.2.6",
                "A1.1.3.25"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.1",
                "mp.com.4.r3.az.1",
                "mp.com.4.r4.az.nt.1",
                "mp.s.4.az.nt.1"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.",
        "title": "Ensure that HTTP(S) access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_http_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-nsg-insecure-vm"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm",
                    "name": "nsg-insecure-vm",
                    "location": "westeurope",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-MySQL",
                            "name": "AllowAll-MySQL",
                            "destination_port_range": "3306",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Mongo",
                            "name": "AllowAll-Mongo",
                            "destination_port_range": "27017",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-RDP",
                            "name": "AllowAll-RDP",
                            "destination_port_range": "3389",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Postgres",
                            "name": "AllowAll-Postgres",
                            "destination_port_range": "5432",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SSH",
                            "name": "AllowAll-SSH",
                            "destination_port_range": "22",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SQLServer",
                            "name": "AllowAll-SQLServer",
                            "destination_port_range": "1433",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-HTTP",
                            "name": "AllowAll-HTTP",
                            "destination_port_range": "80",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "nsg-insecure-vm",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Where HTTP(S) is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-http-access.html"
        ]
    },
    "risk_details": "The potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group vv-vm-01-nsg from subscription Azure for Students has RDP internet access restricted.",
    "metadata": {
        "event_code": "network_rdp_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group vv-vm-01-nsg from subscription Azure for Students has RDP internet access restricted.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.1"
            ],
            "CIS-2.1": [
                "6.1"
            ],
            "CIS-3.0": [
                "7.1"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that RDP access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_rdp_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01-nsg"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg",
                    "name": "vv-vm-01-nsg",
                    "location": "polandcentral",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/SSH",
                            "name": "SSH",
                            "destination_port_range": "22",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTP",
                            "name": "HTTP",
                            "destination_port_range": "80",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTPS",
                            "name": "HTTPS",
                            "destination_port_range": "443",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom443Outbound",
                            "name": "AllowAnyCustom443Outbound",
                            "destination_port_range": "443",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom53Outbound",
                            "name": "AllowAnyCustom53Outbound",
                            "destination_port_range": "53",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom5432Inbound",
                            "name": "AllowAnyCustom5432Inbound",
                            "destination_port_range": "5432",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "vv-vm-01-nsg",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Where RDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_2#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-rdp-access.html#",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
        ]
    },
    "risk_details": "The potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group nsg-insecure-vm from subscription Azure for Students has RDP internet access allowed.",
    "metadata": {
        "event_code": "network_rdp_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Security Group nsg-insecure-vm from subscription Azure for Students has RDP internet access allowed.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.1"
            ],
            "CIS-2.1": [
                "6.1"
            ],
            "CIS-3.0": [
                "7.1"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that RDP access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_rdp_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-nsg-insecure-vm"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm",
                    "name": "nsg-insecure-vm",
                    "location": "westeurope",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-MySQL",
                            "name": "AllowAll-MySQL",
                            "destination_port_range": "3306",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Mongo",
                            "name": "AllowAll-Mongo",
                            "destination_port_range": "27017",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-RDP",
                            "name": "AllowAll-RDP",
                            "destination_port_range": "3389",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Postgres",
                            "name": "AllowAll-Postgres",
                            "destination_port_range": "5432",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SSH",
                            "name": "AllowAll-SSH",
                            "destination_port_range": "22",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SQLServer",
                            "name": "AllowAll-SQLServer",
                            "destination_port_range": "1433",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-HTTP",
                            "name": "AllowAll-HTTP",
                            "destination_port_range": "80",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "nsg-insecure-vm",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Where RDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_2#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-rdp-access.html#",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
        ]
    },
    "risk_details": "The potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group vv-vm-01-nsg from subscription Azure for Students has SSH internet access allowed.",
    "metadata": {
        "event_code": "network_ssh_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Security Group vv-vm-01-nsg from subscription Azure for Students has SSH internet access allowed.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.2"
            ],
            "CIS-2.1": [
                "6.2"
            ],
            "CIS-3.0": [
                "7.2"
            ],
            "PCI-4.0": [
                "1.2.5.17",
                "1.2.8.17",
                "1.2.8.18",
                "1.2.8.21",
                "1.2.8.41",
                "1.3.1.19",
                "1.3.1.21",
                "1.3.1.24",
                "1.3.1.45",
                "1.3.2.19",
                "1.3.2.21",
                "1.3.2.24",
                "1.3.2.45",
                "1.4.1.5",
                "1.4.2.18",
                "1.4.2.19",
                "1.4.2.22",
                "1.4.2.43",
                "1.4.4.5",
                "1.5.1.17",
                "1.5.1.18",
                "1.5.1.21",
                "1.5.1.40",
                "2.2.5.17",
                "A1.1.3.17",
                "A1.1.3.18",
                "A1.1.3.21",
                "A1.1.3.40"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.2"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that SSH access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_ssh_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01-nsg"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg",
                    "name": "vv-vm-01-nsg",
                    "location": "polandcentral",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/SSH",
                            "name": "SSH",
                            "destination_port_range": "22",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTP",
                            "name": "HTTP",
                            "destination_port_range": "80",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTPS",
                            "name": "HTTPS",
                            "destination_port_range": "443",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom443Outbound",
                            "name": "AllowAnyCustom443Outbound",
                            "destination_port_range": "443",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom53Outbound",
                            "name": "AllowAnyCustom53Outbound",
                            "destination_port_range": "53",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom5432Inbound",
                            "name": "AllowAnyCustom5432Inbound",
                            "destination_port_range": "5432",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "vv-vm-01-nsg",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Where SSH is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_3#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-ssh-access.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
        ]
    },
    "risk_details": "The potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group nsg-insecure-vm from subscription Azure for Students has SSH internet access allowed.",
    "metadata": {
        "event_code": "network_ssh_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Security Group nsg-insecure-vm from subscription Azure for Students has SSH internet access allowed.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.2"
            ],
            "CIS-2.1": [
                "6.2"
            ],
            "CIS-3.0": [
                "7.2"
            ],
            "PCI-4.0": [
                "1.2.5.17",
                "1.2.8.17",
                "1.2.8.18",
                "1.2.8.21",
                "1.2.8.41",
                "1.3.1.19",
                "1.3.1.21",
                "1.3.1.24",
                "1.3.1.45",
                "1.3.2.19",
                "1.3.2.21",
                "1.3.2.24",
                "1.3.2.45",
                "1.4.1.5",
                "1.4.2.18",
                "1.4.2.19",
                "1.4.2.22",
                "1.4.2.43",
                "1.4.4.5",
                "1.5.1.17",
                "1.5.1.18",
                "1.5.1.21",
                "1.5.1.40",
                "2.2.5.17",
                "A1.1.3.17",
                "A1.1.3.18",
                "A1.1.3.21",
                "A1.1.3.40"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.2"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that SSH access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_ssh_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-nsg-insecure-vm"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm",
                    "name": "nsg-insecure-vm",
                    "location": "westeurope",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-MySQL",
                            "name": "AllowAll-MySQL",
                            "destination_port_range": "3306",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Mongo",
                            "name": "AllowAll-Mongo",
                            "destination_port_range": "27017",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-RDP",
                            "name": "AllowAll-RDP",
                            "destination_port_range": "3389",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Postgres",
                            "name": "AllowAll-Postgres",
                            "destination_port_range": "5432",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SSH",
                            "name": "AllowAll-SSH",
                            "destination_port_range": "22",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SQLServer",
                            "name": "AllowAll-SQLServer",
                            "destination_port_range": "1433",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-HTTP",
                            "name": "AllowAll-HTTP",
                            "destination_port_range": "80",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "nsg-insecure-vm",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Where SSH is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_3#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-ssh-access.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
        ]
    },
    "risk_details": "The potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group vv-vm-01-nsg from subscription Azure for Students has UDP internet access restricted.",
    "metadata": {
        "event_code": "network_udp_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group vv-vm-01-nsg from subscription Azure for Students has UDP internet access restricted.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices#secure-your-critical-azure-service-resources-to-only-your-virtual-networks",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.3"
            ],
            "CIS-2.1": [
                "6.3"
            ],
            "CIS-3.0": [
                "7.3"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.3"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that UDP access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_udp_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01-nsg"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg",
                    "name": "vv-vm-01-nsg",
                    "location": "polandcentral",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/SSH",
                            "name": "SSH",
                            "destination_port_range": "22",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTP",
                            "name": "HTTP",
                            "destination_port_range": "80",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/HTTPS",
                            "name": "HTTPS",
                            "destination_port_range": "443",
                            "protocol": "TCP",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom443Outbound",
                            "name": "AllowAnyCustom443Outbound",
                            "destination_port_range": "443",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom53Outbound",
                            "name": "AllowAnyCustom53Outbound",
                            "destination_port_range": "53",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Outbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg/securityRules/AllowAnyCustom5432Inbound",
                            "name": "AllowAnyCustom5432Inbound",
                            "destination_port_range": "5432",
                            "protocol": "*",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "vv-vm-01-nsg",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Network/networkSecurityGroups/vv-vm-01-nsg"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Where UDP is not explicitly required and narrowly configured for resources attached tothe Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRouteSite-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-udp-services-are-restricted-from-the-internet#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-udp-access.html#",
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/ddos-best-practices"
        ]
    },
    "risk_details": "The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Security Group nsg-insecure-vm from subscription Azure for Students has UDP internet access restricted.",
    "metadata": {
        "event_code": "network_udp_internet_access_restricted",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group nsg-insecure-vm from subscription Azure for Students has UDP internet access restricted.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices#secure-your-critical-azure-service-resources-to-only-your-virtual-networks",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "6.3"
            ],
            "CIS-2.1": [
                "6.3"
            ],
            "CIS-3.0": [
                "7.3"
            ],
            "ENS-RD2022": [
                "mp.com.1.az.nw.3"
            ],
            "MITRE-ATTACK": [
                "T1199",
                "T1048",
                "T1499",
                "T1498",
                "T1046"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "2.1.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
        "title": "Ensure that UDP access from the Internet is evaluated and restricted",
        "types": [],
        "uid": "prowler-azure-network_udp_internet_access_restricted-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-nsg-insecure-vm"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm",
                    "name": "nsg-insecure-vm",
                    "location": "westeurope",
                    "security_rules": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-MySQL",
                            "name": "AllowAll-MySQL",
                            "destination_port_range": "3306",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Mongo",
                            "name": "AllowAll-Mongo",
                            "destination_port_range": "27017",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-RDP",
                            "name": "AllowAll-RDP",
                            "destination_port_range": "3389",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-Postgres",
                            "name": "AllowAll-Postgres",
                            "destination_port_range": "5432",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SSH",
                            "name": "AllowAll-SSH",
                            "destination_port_range": "22",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-SQLServer",
                            "name": "AllowAll-SQLServer",
                            "destination_port_range": "1433",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm/securityRules/AllowAll-HTTP",
                            "name": "AllowAll-HTTP",
                            "destination_port_range": "80",
                            "protocol": "Tcp",
                            "source_address_prefix": "*",
                            "access": "Allow",
                            "direction": "Inbound"
                        }
                    ]
                }
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "nsg-insecure-vm",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Network/networkSecurityGroups/nsg-insecure-vm"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Where UDP is not explicitly required and narrowly configured for resources attached tothe Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRouteSite-to-site VPN Point-to-site VPN",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-udp-services-are-restricted-from-the-internet#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/unrestricted-udp-access.html#",
            "https://docs.microsoft.com/en-us/azure/security/fundamentals/ddos-best-practices"
        ]
    },
    "risk_details": "The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Network Watcher is not enabled for the following locations in subscription 'Azure for Students': swedencentral, southeastasia, uaecentral, australiasoutheast, canadacentral, norwayeast, northeurope, westus2, switzerlandwest, brazilus, eastus2, ukwest, australiaeast, centralus, japaneast, norwaywest, brazilsouth, indonesiacentral, japanwest, southafricanorth, southafricawest, westcentralus, newzealandnorth, jioindiacentral, malaysiawest, uaenorth, centralindia, jioindiawest, koreasouth, francesouth, mexicocentral, brazilsoutheast, spaincentral, switzerlandnorth, canadaeast, koreacentral, israelcentral, northcentralus, westus3, australiacentral2, germanywestcentral, chilecentral, italynorth, australiacentral, qatarcentral, southindia, uksouth, southcentralus, westindia, francecentral, eastasia, germanynorth, westus.",
    "metadata": {
        "event_code": "network_watcher_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher is not enabled for the following locations in subscription 'Azure for Students': swedencentral, southeastasia, uaecentral, australiasoutheast, canadacentral, norwayeast, northeurope, westus2, switzerlandwest, brazilus, eastus2, ukwest, australiaeast, centralus, japaneast, norwaywest, brazilsouth, indonesiacentral, japanwest, southafricanorth, southafricawest, westcentralus, newzealandnorth, jioindiacentral, malaysiawest, uaenorth, centralindia, jioindiawest, koreasouth, francesouth, mexicocentral, brazilsoutheast, spaincentral, switzerlandnorth, canadaeast, koreacentral, israelcentral, northcentralus, westus3, australiacentral2, germanywestcentral, chilecentral, italynorth, australiacentral, qatarcentral, southindia, uksouth, southcentralus, westindia, francecentral, eastasia, germanynorth, westus.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "There are additional costs per transaction to run and store network data. For high-volume networks these charges will add up quickly.",
        "compliance": {
            "CIS-2.0": [
                "6.6"
            ],
            "CIS-2.1": [
                "6.6"
            ],
            "CIS-3.0": [
                "7.6"
            ],
            "ENS-RD2022": [
                "op.mon.1.az.nw.1",
                "op.mon.2.r2.az.ma.1",
                "op.mon.3.az.nw.1",
                "mp.com.1.az.nw.1",
                "mp.com.1.az.nw.2",
                "mp.com.1.az.nw.3",
                "mp.com.3.az.nw.1"
            ],
            "MITRE-ATTACK": [
                "T1048",
                "T1499",
                "T1498",
                "T1046",
                "T1049"
            ],
            "ISO27001-2022": [
                "A.8.14",
                "A.8.20",
                "A.8.21",
                "A.8.22"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.14"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Network Watcher for Azure subscriptions.",
        "title": "Ensure that Network Watcher is 'Enabled' for all locations in the Azure subscription",
        "types": [],
        "uid": "prowler-azure-network_watcher_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-global-Network Watcher"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {}
            },
            "group": {
                "name": "network"
            },
            "labels": [],
            "name": "Network Watcher",
            "type": "Network",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_*"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "Opting out of Network Watcher automatic enablement is a permanent change. Once you opt-out you cannot opt-in without contacting support.",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Network/enable-network-watcher.html",
            "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v2-logging-threat-detection#lt-3-enable-logging-for-azure-network-activities"
        ]
    },
    "risk_details": "Network diagnostic and visualization tools available with Network Watcher help users understand, diagnose, and gain insights to the network in Azure.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Policy assigment '/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn' is configured with enforcement mode 'Default'.",
    "metadata": {
        "event_code": "policy_ensure_asc_enforcement_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Policy assigment '/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn' is configured with enforcement mode 'Default'.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/defender-for-cloud/security-policy-concept",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "2.1.14"
            ],
            "CIS-2.1": [
                "2.1.13"
            ],
            "CIS-3.0": [
                "3.1.11"
            ],
            "PCI-4.0": [
                "10.2.1.1.31",
                "10.4.1.1.5",
                "10.4.1.4",
                "10.4.2.5",
                "10.6.3.36",
                "10.7.1.6",
                "10.7.2.6",
                "A3.3.1.9",
                "A3.5.1.9"
            ],
            "ISO27001-2022": [
                "A.5.1"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.17"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "None of the settings offered by ASC Default policy should be set to effect Disabled.",
        "title": "Ensure Any of the ASC Default Policy Settings are Not Set to 'Disabled'",
        "types": [],
        "uid": "prowler-azure-policy_ensure_asc_enforcement_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-global-SecurityCenterBuiltIn"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "global",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
                    "name": "SecurityCenterBuiltIn",
                    "enforcement_mode": "Default"
                }
            },
            "group": {
                "name": "policy"
            },
            "labels": [],
            "name": "SecurityCenterBuiltIn",
            "type": "Microsoft.Authorization/policyAssignments",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "global"
    },
    "remediation": {
        "desc": "1. From Azure Home select the Portal Menu 2. Select Policy 3. Select ASC Default for each subscription 4. Click on 'view Assignment' 5. Click on 'Edit assignment' 6. Ensure Policy Enforcement is Enabled 7. Click 'Review + Save'",
        "references": [
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations"
        ]
    },
    "risk_details": "A security policy defines the desired configuration of your workloads and helps ensure compliance with company or regulatory security requirements. ASC Default policy is associated with every subscription by default. ASC default policy assignment is a set of security recommendations based on best practices. Enabling recommendations in ASC default policy ensures that Azure security center provides the ability to monitor all of the supported recommendations and optionally allow automated action for a few of the supported recommendations.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students does not have any auditing policy configured.",
    "metadata": {
        "event_code": "sqlserver_auditing_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students does not have any auditing policy configured.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.1"
            ],
            "CIS-2.1": [
                "4.1.1"
            ],
            "CIS-3.0": [
                "5.1.1"
            ],
            "PCI-4.0": [
                "10.2.1.1.26",
                "10.2.1.1.27",
                "10.2.1.2.23",
                "10.2.1.2.24",
                "10.2.1.3.23",
                "10.2.1.3.24",
                "10.2.1.4.23",
                "10.2.1.4.24",
                "10.2.1.5.23",
                "10.2.1.5.24",
                "10.2.1.6.23",
                "10.2.1.6.24",
                "10.2.1.7.23",
                "10.2.1.7.24",
                "10.2.1.23",
                "10.2.1.24",
                "10.2.2.23",
                "10.2.2.24",
                "10.3.1.23",
                "10.3.1.24",
                "10.6.3.29",
                "10.6.3.30",
                "5.3.4.28",
                "5.3.4.29",
                "A1.2.1.27",
                "A1.2.1.28"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.4"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there is an audit policy configured",
        "title": "Ensure that SQL Servers have an audit policy configured",
        "types": [],
        "uid": "prowler-azure-sqlserver_auditing_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Create an audit policy for the SQL server",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_2#terraform",
            "Set-AzureRmSqlServerAuditingPolicy -ResourceGroupName <RESOURCE_GROUP_NAME> -ServerName <SERVER_NAME> -AuditType <AUDIT_TYPE> -StorageAccountName <STORAGE_ACCOUNT_NAME>",
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/auditing.html"
        ]
    },
    "risk_details": "Audit policies are used to store logs associated to the SQL server (for instance, successful/unsuccesful log in attempts). These logs may be useful to detect anomalies or to perform an investigation in case a security incident is detected",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students does not have any auditing policy configured.",
    "metadata": {
        "event_code": "sqlserver_auditing_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students does not have any auditing policy configured.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.1"
            ],
            "CIS-2.1": [
                "4.1.1"
            ],
            "CIS-3.0": [
                "5.1.1"
            ],
            "PCI-4.0": [
                "10.2.1.1.26",
                "10.2.1.1.27",
                "10.2.1.2.23",
                "10.2.1.2.24",
                "10.2.1.3.23",
                "10.2.1.3.24",
                "10.2.1.4.23",
                "10.2.1.4.24",
                "10.2.1.5.23",
                "10.2.1.5.24",
                "10.2.1.6.23",
                "10.2.1.6.24",
                "10.2.1.7.23",
                "10.2.1.7.24",
                "10.2.1.23",
                "10.2.1.24",
                "10.2.2.23",
                "10.2.2.24",
                "10.3.1.23",
                "10.3.1.24",
                "10.6.3.29",
                "10.6.3.30",
                "5.3.4.28",
                "5.3.4.29",
                "A1.2.1.27",
                "A1.2.1.28"
            ],
            "ENS-RD2022": [
                "op.acc.6.r5.az.eid.4"
            ],
            "ProwlerThreatScore-1.0": [
                "3.3.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there is an audit policy configured",
        "title": "Ensure that SQL Servers have an audit policy configured",
        "types": [],
        "uid": "prowler-azure-sqlserver_auditing_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Create an audit policy for the SQL server",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_2#terraform",
            "Set-AzureRmSqlServerAuditingPolicy -ResourceGroupName <RESOURCE_GROUP_NAME> -ServerName <SERVER_NAME> -AuditType <AUDIT_TYPE> -StorageAccountName <STORAGE_ACCOUNT_NAME>",
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/auditing.html"
        ]
    },
    "risk_details": "Audit policies are used to store logs associated to the SQL server (for instance, successful/unsuccesful log in attempts). These logs may be useful to detect anomalies or to perform an investigation in case a security incident is detected",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has auditing disabled.",
    "metadata": {
        "event_code": "sqlserver_auditing_retention_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has auditing disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.6"
            ],
            "CIS-2.1": [
                "4.1.6"
            ],
            "CIS-3.0": [
                "5.1.6"
            ],
            "ENS-RD2022": [
                "op.exp.8.r3.az.nt.1",
                "op.mon.3.az.nw.1"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "SQL Server Audit Retention should be configured to be greater than 90 days.",
        "title": "Ensure that 'Auditing' Retention is 'greater than 90 days'",
        "types": [],
        "uid": "prowler-azure-sqlserver_auditing_retention_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. For each server instance 3. Click on Auditing 4. If storage is selected, expand Advanced properties 5. Set the Retention (days) setting greater than 90 days or 0 for unlimited retention. 6. Select Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_3",
            "Set-AzSqlServerAudit -ResourceGroupName resource_group_name -ServerName SQL_Server_name -RetentionInDays 100 -LogAnalyticsTargetState Enabled -WorkspaceResourceId '/subscriptions/subscription_ID/resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/workspace_name'",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/auditing-retention.html#",
            "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
        ]
    },
    "risk_details": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has auditing disabled.",
    "metadata": {
        "event_code": "sqlserver_auditing_retention_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has auditing disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.6"
            ],
            "CIS-2.1": [
                "4.1.6"
            ],
            "CIS-3.0": [
                "5.1.6"
            ],
            "ENS-RD2022": [
                "op.exp.8.r3.az.nt.1",
                "op.mon.3.az.nw.1"
            ],
            "ProwlerThreatScore-1.0": [
                "3.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "SQL Server Audit Retention should be configured to be greater than 90 days.",
        "title": "Ensure that 'Auditing' Retention is 'greater than 90 days'",
        "types": [],
        "uid": "prowler-azure-sqlserver_auditing_retention_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. For each server instance 3. Click on Auditing 4. If storage is selected, expand Advanced properties 5. Set the Retention (days) setting greater than 90 days or 0 for unlimited retention. 6. Select Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-logging-policies/bc_azr_logging_3",
            "Set-AzSqlServerAudit -ResourceGroupName resource_group_name -ServerName SQL_Server_name -RetentionInDays 100 -LogAnalyticsTargetState Enabled -WorkspaceResourceId '/subscriptions/subscription_ID/resourceGroups/insights-integration/providers/Microsoft.OperationalInsights/workspaces/workspace_name'",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/auditing-retention.html#",
            "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies"
        ]
    },
    "risk_details": "Audit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has an Active Directory administrator.",
    "metadata": {
        "event_code": "sqlserver_azuread_administrator_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has an Active Directory administrator.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.4"
            ],
            "CIS-2.1": [
                "4.1.4"
            ],
            "CIS-3.0": [
                "5.1.4"
            ],
            "PCI-4.0": [
                "7.2.1.20",
                "7.2.1.22",
                "7.2.1.23",
                "7.2.2.20",
                "7.2.2.22",
                "7.2.2.23",
                "7.2.5.14",
                "7.2.5.16",
                "7.2.5.17",
                "7.3.1.14",
                "7.3.1.16",
                "7.3.1.17",
                "7.3.2.14",
                "7.3.2.16",
                "7.3.2.17",
                "7.3.3.14",
                "7.3.3.16",
                "7.3.3.17",
                "8.2.7.14",
                "8.2.7.16",
                "8.2.7.17",
                "8.2.8.16",
                "8.2.8.18",
                "8.2.8.19",
                "8.3.4.14",
                "8.3.4.16",
                "8.3.4.17"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there is an Azure Active Directory administrator configured",
        "title": "Ensure that SQL Servers have an Azure Active Directory administrator",
        "types": [],
        "uid": "prowler-azure-sqlserver_azuread_administrator_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable an Azure Active Directory administrator",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-active-directory-admin-is-configured#terraform",
            "az sql server ad-admin create --resource-group resource_group_name --server server_name --display-name display_name --object-id user_object_id",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/active-directory-admin.html"
        ]
    },
    "risk_details": "Azure Active Directory provides a centralized way of managing identities. Using local SQL administrator identites makes it more difficult to manage user accounts. In addition, from Azure Active Directory, security policies can be enforced to users in centralized way.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has an Active Directory administrator.",
    "metadata": {
        "event_code": "sqlserver_azuread_administrator_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has an Active Directory administrator.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.4"
            ],
            "CIS-2.1": [
                "4.1.4"
            ],
            "CIS-3.0": [
                "5.1.4"
            ],
            "PCI-4.0": [
                "7.2.1.20",
                "7.2.1.22",
                "7.2.1.23",
                "7.2.2.20",
                "7.2.2.22",
                "7.2.2.23",
                "7.2.5.14",
                "7.2.5.16",
                "7.2.5.17",
                "7.3.1.14",
                "7.3.1.16",
                "7.3.1.17",
                "7.3.2.14",
                "7.3.2.16",
                "7.3.2.17",
                "7.3.3.14",
                "7.3.3.16",
                "7.3.3.17",
                "8.2.7.14",
                "8.2.7.16",
                "8.2.7.17",
                "8.2.8.16",
                "8.2.8.18",
                "8.2.8.19",
                "8.3.4.14",
                "8.3.4.16",
                "8.3.4.17"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there is an Azure Active Directory administrator configured",
        "title": "Ensure that SQL Servers have an Azure Active Directory administrator",
        "types": [],
        "uid": "prowler-azure-sqlserver_azuread_administrator_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable an Azure Active Directory administrator",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-azure-active-directory-admin-is-configured#terraform",
            "az sql server ad-admin create --resource-group resource_group_name --server server_name --display-name display_name --object-id user_object_id",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/active-directory-admin.html"
        ]
    },
    "risk_details": "Azure Active Directory provides a centralized way of managing identities. Using local SQL administrator identites makes it more difficult to manage user accounts. In addition, from Azure Active Directory, security policies can be enforced to users in centralized way.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has microsoft defender disabled.",
    "metadata": {
        "event_code": "sqlserver_microsoft_defender_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has microsoft defender disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/azure-sql/database/azure-defender-for-sql?view=azuresql",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Microsoft Defender for SQL is a paid feature and will incur additional cost for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Microsoft Defender for SQL is set to 'On' for critical SQL Servers",
        "title": "Ensure that Microsoft Defender for SQL is set to 'On' for critical SQL Servers",
        "types": [],
        "uid": "prowler-azure-sqlserver_microsoft_defender_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers For each production SQL server instance: 2. Click Microsoft Defender for Cloud 3. Click Enable Microsoft Defender for SQL",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/SecurityCenter/defender-azure-sql.html",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-sql-usage"
        ]
    },
    "risk_details": "Microsoft Defender for SQL is a unified package for advanced SQL security capabilities. Microsoft Defender is available for Azure SQL Database, Azure SQL Managed  classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your database. It provides a single go-to location for enabling and managing these capabilities.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has microsoft defender disabled.",
    "metadata": {
        "event_code": "sqlserver_microsoft_defender_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has microsoft defender disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/azure-sql/database/azure-defender-for-sql?view=azuresql",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Microsoft Defender for SQL is a paid feature and will incur additional cost for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.1"
            ],
            "ENS-RD2022": [
                "mp.s.4.r1.az.nt.4"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Microsoft Defender for SQL is set to 'On' for critical SQL Servers",
        "title": "Ensure that Microsoft Defender for SQL is set to 'On' for critical SQL Servers",
        "types": [],
        "uid": "prowler-azure-sqlserver_microsoft_defender_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers For each production SQL server instance: 2. Click Microsoft Defender for Cloud 3. Click Enable Microsoft Defender for SQL",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/SecurityCenter/defender-azure-sql.html",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/defender-for-sql-usage"
        ]
    },
    "risk_details": "Microsoft Defender for SQL is a unified package for advanced SQL security capabilities. Microsoft Defender is available for Azure SQL Database, Azure SQL Managed  classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your database. It provides a single go-to location for enabling and managing these capabilities.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students is using version 1.2 as minimal accepted which is recommended.",
    "metadata": {
        "event_code": "sqlserver_recommended_minimal_tls_version",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students is using version 1.2 as minimal accepted which is recommended.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/connectivity-settings?view=azuresql&tabs=azure-portal#configure-minimum-tls-version",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Verify support for the TLS version from the application side before changing the minimal version.",
        "compliance": {}
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that SQL Server instances are configured with the recommended minimal TLS version to maintain secure connections.",
        "title": "Ensure SQL server has a recommended minimal TLS version required.",
        "types": [],
        "uid": "prowler-azure-sqlserver_recommended_minimal_tls_version-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Azure SQL Server 2. Navigate to 'Security' -> 'Networking' 3. Select 'Connectivity' 4. Update the TLS version in the field 'Minimum TLS version' to a recommended minimal version (e.g., TLS 1.2).",
        "references": [
            "az sql server update -n sql-server-name -g sql-server-group --set minimalTlsVersion=<version>",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/connectivity-settings?view=azuresql&tabs=azure-portal#configure-minimum-tls-version"
        ]
    },
    "risk_details": "Using outdated or weak TLS versions can expose SQL Server instances to vulnerabilities, increasing the risk of data breaches and unauthorized access.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students is using version 1.2 as minimal accepted which is recommended.",
    "metadata": {
        "event_code": "sqlserver_recommended_minimal_tls_version",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students is using version 1.2 as minimal accepted which is recommended.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/azure-sql/database/connectivity-settings?view=azuresql&tabs=azure-portal#configure-minimum-tls-version",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Verify support for the TLS version from the application side before changing the minimal version.",
        "compliance": {}
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that SQL Server instances are configured with the recommended minimal TLS version to maintain secure connections.",
        "title": "Ensure SQL server has a recommended minimal TLS version required.",
        "types": [],
        "uid": "prowler-azure-sqlserver_recommended_minimal_tls_version-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Azure SQL Server 2. Navigate to 'Security' -> 'Networking' 3. Select 'Connectivity' 4. Update the TLS version in the field 'Minimum TLS version' to a recommended minimal version (e.g., TLS 1.2).",
        "references": [
            "az sql server update -n sql-server-name -g sql-server-group --set minimalTlsVersion=<version>",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/connectivity-settings?view=azuresql&tabs=azure-portal#configure-minimum-tls-version"
        ]
    },
    "risk_details": "Using outdated or weak TLS versions can expose SQL Server instances to vulnerabilities, increasing the risk of data breaches and unauthorized access.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has TDE disabled without CMK.",
    "metadata": {
        "event_code": "sqlserver_tde_encrypted_with_cmk",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has TDE disabled without CMK.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Once TDE protector is encrypted with a Customer-managed key, it transfers entire responsibility of respective key management on to you, and hence you should be more careful about doing any operations on the particular key in order to keep data from corresponding SQL server and Databases hosted accessible. When deploying Customer Managed Keys, it is prudent to ensure that you also deploy an automated toolset for managing these keys (this should include discovery and key rotation), and Keys should be stored in an HSM or hardware backed keystore, such as Azure Key Vault. As far as toolsets go, check with your cryptographic key provider, as they may well provide one as an add-on to their service.",
        "compliance": {
            "CIS-2.0": [
                "4.1.3"
            ],
            "CIS-2.1": [
                "4.1.3"
            ],
            "CIS-3.0": [
                "5.1.3"
            ],
            "MITRE-ATTACK": [
                "T1040",
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Transparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.",
        "title": "Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted with Customer-managed key",
        "types": [],
        "uid": "prowler-azure-sqlserver_tde_encrypted_with_cmk-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers For the desired server instance 2. Click On Transparent data encryption 3. Set Transparent data encryption to Customer-managed key 4. Browse through your key vaults to Select an existing key or create a new key in the Azure Key Vault. 5. Check Make selected key the default TDE protector",
        "references": [
            "az sql server tde-key set --resource-group resourceName --server dbServerName --server-key-type {AzureKeyVault} --kid keyIdentifier",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/use-byok-for-transparent-data-encryption.html#",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql"
        ]
    },
    "risk_details": "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure cloud-based external key management system, is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has TDE disabled without CMK.",
    "metadata": {
        "event_code": "sqlserver_tde_encrypted_with_cmk",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has TDE disabled without CMK.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-byok-azure-sql",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Once TDE protector is encrypted with a Customer-managed key, it transfers entire responsibility of respective key management on to you, and hence you should be more careful about doing any operations on the particular key in order to keep data from corresponding SQL server and Databases hosted accessible. When deploying Customer Managed Keys, it is prudent to ensure that you also deploy an automated toolset for managing these keys (this should include discovery and key rotation), and Keys should be stored in an HSM or hardware backed keystore, such as Azure Key Vault. As far as toolsets go, check with your cryptographic key provider, as they may well provide one as an add-on to their service.",
        "compliance": {
            "CIS-2.0": [
                "4.1.3"
            ],
            "CIS-2.1": [
                "4.1.3"
            ],
            "CIS-3.0": [
                "5.1.3"
            ],
            "MITRE-ATTACK": [
                "T1040",
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Transparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.",
        "title": "Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted with Customer-managed key",
        "types": [],
        "uid": "prowler-azure-sqlserver_tde_encrypted_with_cmk-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers For the desired server instance 2. Click On Transparent data encryption 3. Set Transparent data encryption to Customer-managed key 4. Browse through your key vaults to Select an existing key or create a new key in the Azure Key Vault. 5. Check Make selected key the default TDE protector",
        "references": [
            "az sql server tde-key set --resource-group resourceName --server dbServerName --server-key-type {AzureKeyVault} --kid keyIdentifier",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/use-byok-for-transparent-data-encryption.html#",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql"
        ]
    },
    "risk_details": "Customer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure cloud-based external key management system, is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Database sql-database-0169 from SQL Server sql-server-0169 from subscription Azure for Students has TDE enabled",
    "metadata": {
        "event_code": "sqlserver_tde_encryption_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Database sql-database-0169 from SQL Server sql-server-0169 from subscription Azure for Students has TDE enabled",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-with-azure-sql-database",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.5"
            ],
            "CIS-2.1": [
                "4.1.5"
            ],
            "CIS-3.0": [
                "5.1.5"
            ],
            "PCI-4.0": [
                "3.5.1.25",
                "3.5.1.26",
                "3.5.1.27",
                "8.3.2.42",
                "8.3.2.43",
                "8.3.2.44"
            ],
            "MITRE-ATTACK": [
                "T1040",
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Transparent Data Encryption on every SQL server.",
        "title": "Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted",
        "types": [],
        "uid": "prowler-azure-sqlserver_tde_encryption_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-database-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                    "name": "sql-database-0169",
                    "type": "Microsoft.Sql/servers/databases",
                    "location": "westeurope",
                    "managed_by": null,
                    "tde_encryption": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                        "location": "West Europe",
                        "status": "Enabled"
                    }
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-database-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL databases 2. For each DB instance 3. Click on Transparent data encryption 4. Set Data encryption to On",
        "references": [
            "az sql db tde set --resource-group resourceGroup --server dbServerName --database dbName --status Enabled",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/data-encryption.html#",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql"
        ]
    },
    "risk_details": "Azure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Database sql-database-0269 from SQL Server sql-server-0269 from subscription Azure for Students has TDE enabled",
    "metadata": {
        "event_code": "sqlserver_tde_encryption_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Database sql-database-0269 from SQL Server sql-server-0269 from subscription Azure for Students has TDE enabled",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption-with-azure-sql-database",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.5"
            ],
            "CIS-2.1": [
                "4.1.5"
            ],
            "CIS-3.0": [
                "5.1.5"
            ],
            "PCI-4.0": [
                "3.5.1.25",
                "3.5.1.26",
                "3.5.1.27",
                "8.3.2.42",
                "8.3.2.43",
                "8.3.2.44"
            ],
            "MITRE-ATTACK": [
                "T1040",
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.12",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Transparent Data Encryption on every SQL server.",
        "title": "Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted",
        "types": [],
        "uid": "prowler-azure-sqlserver_tde_encryption_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-database-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                    "name": "sql-database-0269",
                    "type": "Microsoft.Sql/servers/databases",
                    "location": "westeurope",
                    "managed_by": null,
                    "tde_encryption": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                        "location": "West Europe",
                        "status": "Enabled"
                    }
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-database-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL databases 2. For each DB instance 3. Click on Transparent data encryption 4. Set Data encryption to On",
        "references": [
            "az sql db tde set --resource-group resourceGroup --server dbServerName --database dbName --status Enabled",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/data-encryption.html#",
            "https://learn.microsoft.com/en-us/azure/azure-sql/database/transparent-data-encryption-byok-overview?view=azuresql"
        ]
    },
    "risk_details": "Azure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students does not have firewall rules allowing 0.0.0.0-255.255.255.255.",
    "metadata": {
        "event_code": "sqlserver_unrestricted_inbound_access",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 5,
    "severity": "Critical",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students does not have firewall rules allowing 0.0.0.0-255.255.255.255.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-vnet-service-endpoint-rule-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.2"
            ],
            "CIS-2.1": [
                "4.1.2"
            ],
            "CIS-3.0": [
                "5.1.2"
            ],
            "PCI-4.0": [
                "1.2.8.27",
                "1.2.8.28",
                "1.3.1.30",
                "1.3.1.31",
                "1.3.2.30",
                "1.3.2.31",
                "1.4.2.28",
                "1.4.2.29",
                "1.5.1.27",
                "1.5.1.28",
                "10.3.2.15",
                "10.3.2.16",
                "3.5.1.3.20",
                "3.5.1.3.21",
                "A1.1.2.11",
                "A1.1.2.12",
                "A1.1.3.27",
                "A1.1.3.28",
                "A3.4.1.13",
                "A3.4.1.14"
            ],
            "ENS-RD2022": [
                "op.mon.3.r5.az.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there are no firewall rules allowing traffic from 0.0.0.0-255.255.255.255",
        "title": "Ensure no Azure SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)",
        "types": [],
        "uid": "prowler-azure-sqlserver_unrestricted_inbound_access-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Remove firewall rules allowing all sources and, instead, use more granular rules",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_4#terraform",
            "az sql server firewall-rule delete --resource-group resource_group_name --server sql_server_name --name rule_name",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/unrestricted-sql-database-access.html"
        ]
    },
    "risk_details": "Azure SQL servers provide a firewall that, by default, blocks all Internet connections. When the rule (0.0.0.0-255.255.255.255) is used, the server can be accessed by any source from the Internet, incrementing significantly the attack surface of the SQL Server. It is recommended to use more granular firewall rules.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students does not have firewall rules allowing 0.0.0.0-255.255.255.255.",
    "metadata": {
        "event_code": "sqlserver_unrestricted_inbound_access",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 5,
    "severity": "Critical",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students does not have firewall rules allowing 0.0.0.0-255.255.255.255.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-database-vnet-service-endpoint-rule-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "4.1.2"
            ],
            "CIS-2.1": [
                "4.1.2"
            ],
            "CIS-3.0": [
                "5.1.2"
            ],
            "PCI-4.0": [
                "1.2.8.27",
                "1.2.8.28",
                "1.3.1.30",
                "1.3.1.31",
                "1.3.2.30",
                "1.3.2.31",
                "1.4.2.28",
                "1.4.2.29",
                "1.5.1.27",
                "1.5.1.28",
                "10.3.2.15",
                "10.3.2.16",
                "3.5.1.3.20",
                "3.5.1.3.21",
                "A1.1.2.11",
                "A1.1.2.12",
                "A1.1.3.27",
                "A1.1.3.28",
                "A3.4.1.13",
                "A3.4.1.14"
            ],
            "ENS-RD2022": [
                "op.mon.3.r5.az.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that there are no firewall rules allowing traffic from 0.0.0.0-255.255.255.255",
        "title": "Ensure no Azure SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)",
        "types": [],
        "uid": "prowler-azure-sqlserver_unrestricted_inbound_access-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Remove firewall rules allowing all sources and, instead, use more granular rules",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/bc_azr_networking_4#terraform",
            "az sql server firewall-rule delete --resource-group resource_group_name --server sql_server_name --name rule_name",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/Sql/unrestricted-sql-database-access.html"
        ]
    },
    "risk_details": "Azure SQL servers provide a firewall that, by default, blocks all Internet connections. When the rule (0.0.0.0-255.255.255.255) is used, the server can be accessed by any source from the Internet, incrementing significantly the attack surface of the SQL Server. It is recommended to use more granular firewall rules.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_emails_notifications_admins_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.5"
            ],
            "ENS-RD2022": [
                "op.mon.2.r2.az.ma.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners' is set for each SQL Server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_emails_notifications_admins_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Click on Security Center 4. Select Configure next to Enabled at subscription-level 5. In Section Vulnerability Assessment Settings, configure Storage Accounts if not already 6. Check/enable 'Also send email notifications to admins and subscription owners' 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-also-send-email-notifications-to-admins-and-subscription-owners-is-set-for-an-sql-server#terraform",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "VA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_emails_notifications_admins_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.5"
            ],
            "ENS-RD2022": [
                "op.mon.2.r2.az.ma.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners' is set for each SQL Server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_emails_notifications_admins_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Click on Security Center 4. Select Configure next to Enabled at subscription-level 5. In Section Vulnerability Assessment Settings, configure Storage Accounts if not already 6. Check/enable 'Also send email notifications to admins and subscription owners' 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-also-send-email-notifications-to-admins-and-subscription-owners-is-set-for-an-sql-server#terraform",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "VA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_periodic_recurring_scans_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Azure Defender for SQL feature will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.3"
            ],
            "ENS-RD2022": [
                "op.con.3.az.pd.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Periodic recurring scans' is set to 'on' for each SQL server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_periodic_recurring_scans_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. For each server instance 3. Click on Security Center 4. In Section Vulnerability Assessment Settings, set Storage Account if not already 5. Toggle 'Periodic recurring scans' to ON. 6. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-periodic-recurring-scans-is-enabled-on-a-sql-server#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/periodic-vulnerability-scans.html#",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_periodic_recurring_scans_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Azure Defender for SQL feature will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.3"
            ],
            "ENS-RD2022": [
                "op.con.3.az.pd.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Periodic recurring scans' is set to 'on' for each SQL server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_periodic_recurring_scans_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. For each server instance 3. Click on Security Center 4. In Section Vulnerability Assessment Settings, set Storage Account if not already 5. Toggle 'Periodic recurring scans' to ON. 6. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-periodic-recurring-scans-is-enabled-on-a-sql-server#terraform",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/periodic-vulnerability-scans.html#",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_scan_reports_configured",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.4"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Configure 'Send scan reports to' with email addresses of concerned data owners/stakeholders for a critical SQL servers.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Send scan reports to' is configured for a SQL server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_scan_reports_configured-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Select Microsoft Defender for Cloud 4. Select Configure next to Enablement status 5. Set Microsoft Defender for SQL to On 6. Under Vulnerability Assessment Settings, select a Storage Account 7. Set Periodic recurring scans to On 8. Under Send scan reports to, provide email addresses for data owners and stakeholders 9. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-send-scan-reports-to-is-configured-for-a-sql-server#terraform",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "Vulnerability Assessment (VA) scan reports and alerts will be sent to email addresses configured at 'Send scan reports to'. This may help in reducing time required for identifying risks and taking corrective measures",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_va_scan_reports_configured",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.4"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Configure 'Send scan reports to' with email addresses of concerned data owners/stakeholders for a critical SQL servers.",
        "title": "Ensure that Vulnerability Assessment (VA) setting 'Send scan reports to' is configured for a SQL server",
        "types": [],
        "uid": "prowler-azure-sqlserver_va_scan_reports_configured-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Select Microsoft Defender for Cloud 4. Select Configure next to Enablement status 5. Set Microsoft Defender for SQL to On 6. Under Vulnerability Assessment Settings, select a Storage Account 7. Set Periodic recurring scans to On 8. Under Send scan reports to, provide email addresses for data owners and stakeholders 9. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-va-setting-send-scan-reports-to-is-configured-for-a-sql-server#terraform",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "Vulnerability Assessment (VA) scan reports and alerts will be sent to email addresses configured at 'Send scan reports to'. This may help in reducing time required for identifying risks and taking corrective measures",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_vulnerability_assessment_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0169 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.2"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.",
        "title": "Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account",
        "types": [],
        "uid": "prowler-azure-sqlserver_vulnerability_assessment_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                    "name": "sql-server-0169",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169",
                            "name": "sql-database-0169",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/sql-database-0169/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0169",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Click on Security Center 4. Select Configure next to Enabled at subscription-level 5. In Section Vulnerability Assessment Settings, Click Select Storage account 6. Choose Storage Account (Existing or Create New). Click Ok 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account",
            "Update-AzSqlServerVulnerabilityAssessmentSetting -ResourceGroupName resource_group_name -ServerName Server_Name -StorageAccountName Storage_Name_from_same_subscription_and_same_Location -ScanResultsContainerName vulnerability-assessment -RecurringScansInterval Weekly -EmailSubscriptionAdmins $true -NotificationEmail @('mail1@mail.com' , 'mail2@mail.com')",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/vulnerability-assessment-sql-servers.html#",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "The Vulnerability Assessment service scans databases for known security vulnerabilities and highlights deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. Results of the scan include actionable steps to resolve each issue and provide customized remediation scripts where applicable. Additionally, an assessment report can be customized by setting an acceptable baseline for permission configurations, feature configurations, and database settings.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "metadata": {
        "event_code": "sqlserver_vulnerability_assessment_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "SQL Server sql-server-0269 from subscription Azure for Students has vulnerability assessment disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Enabling the Microsoft Defender for SQL features will incur additional costs for each SQL server.",
        "compliance": {
            "CIS-2.0": [
                "4.2.2"
            ],
            "ENS-RD2022": [
                "op.mon.3.r3.az.de.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.",
        "title": "Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account",
        "types": [],
        "uid": "prowler-azure-sqlserver_vulnerability_assessment_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sql-server-0269"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                    "name": "sql-server-0269",
                    "public_network_access": "Enabled",
                    "minimal_tls_version": "1.2",
                    "administrators": {
                        "sid": "374643ec-c525-4fca-89f4-c75326f1f161",
                        "administrator_type": "ActiveDirectory"
                    },
                    "auditing_policies": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/auditingSettings/Default",
                            "name": "Default",
                            "type": "Microsoft.Sql/servers/auditingSettings",
                            "state": "Disabled",
                            "retention_days": 0
                        }
                    ],
                    "firewall_rules": [],
                    "location": "westeurope",
                    "encryption_protector": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/encryptionProtector/current",
                        "name": "current",
                        "type": "Microsoft.Sql/servers/encryptionProtector",
                        "server_key_name": "ServiceManaged",
                        "server_key_type": "ServiceManaged"
                    },
                    "vulnerability_assessment": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/vulnerabilityAssessments/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/vulnerabilityAssessments",
                        "storage_container_path": null,
                        "recurring_scans": {
                            "is_enabled": false,
                            "emails": null,
                            "email_subscription_admins": true
                        }
                    },
                    "security_alert_policies": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/securityAlertPolicies/Default",
                        "name": "Default",
                        "type": "Microsoft.Sql/servers/securityAlertPolicies",
                        "state": "Disabled"
                    },
                    "databases": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269",
                            "name": "sql-database-0269",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": null,
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/sql-database-0269/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Enabled"
                            }
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master",
                            "name": "master",
                            "type": "Microsoft.Sql/servers/databases",
                            "location": "westeurope",
                            "managed_by": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269",
                            "tde_encryption": {
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269/databases/master/transparentDataEncryption/current",
                                "name": "current",
                                "type": "Microsoft.Sql/servers/databases/transparentDataEncryption",
                                "location": "West Europe",
                                "status": "Disabled"
                            }
                        }
                    ]
                }
            },
            "group": {
                "name": "sqlserver"
            },
            "labels": [],
            "name": "sql-server-0269",
            "type": "SQLServer",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Sql/servers/sql-server-0269"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to SQL servers 2. Select a server instance 3. Click on Security Center 4. Select Configure next to Enabled at subscription-level 5. In Section Vulnerability Assessment Settings, Click Select Storage account 6. Choose Storage Account (Existing or Create New). Click Ok 7. Click Save",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-vulnerability-assessment-va-is-enabled-on-a-sql-server-by-setting-a-storage-account",
            "Update-AzSqlServerVulnerabilityAssessmentSetting -ResourceGroupName resource_group_name -ServerName Server_Name -StorageAccountName Storage_Name_from_same_subscription_and_same_Location -ScanResultsContainerName vulnerability-assessment -RecurringScansInterval Weekly -EmailSubscriptionAdmins $true -NotificationEmail @('mail1@mail.com' , 'mail2@mail.com')",
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/Sql/vulnerability-assessment-sql-servers.html#",
            "https://learn.microsoft.com/en-us/azure/defender-for-cloud/sql-azure-vulnerability-assessment-enable"
        ]
    },
    "risk_details": "The Vulnerability Assessment service scans databases for known security vulnerabilities and highlights deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. Results of the scan include actionable steps to resolve each issue and provide customized remediation scripts where applicable. Additionally, an assessment report can be customized by setting an acceptable baseline for permission configurations, feature configurations, and database settings.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has allow blob public access disabled.",
    "metadata": {
        "event_code": "storage_blob_public_access_level_is_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has allow blob public access disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.7"
            ],
            "CIS-2.1": [
                "3.7"
            ],
            "CIS-3.0": [
                "4.6"
            ],
            "PCI-4.0": [
                "1.2.8.30",
                "1.2.8.31",
                "1.2.8.32",
                "1.2.8.33",
                "1.2.8.34",
                "1.2.8.35",
                "1.3.1.34",
                "1.3.1.35",
                "1.3.1.36",
                "1.3.1.37",
                "1.3.1.38",
                "1.3.1.39",
                "1.3.2.34",
                "1.3.2.35",
                "1.3.2.36",
                "1.3.2.37",
                "1.3.2.38",
                "1.3.2.39",
                "1.4.2.32",
                "1.4.2.33",
                "1.4.2.34",
                "1.4.2.35",
                "1.4.2.36",
                "1.4.2.37",
                "1.5.1.30",
                "1.5.1.31",
                "1.5.1.32",
                "1.5.1.33",
                "1.5.1.34",
                "1.5.1.35",
                "10.3.2.18",
                "10.3.2.19",
                "10.3.2.20",
                "10.3.2.21",
                "10.3.2.23",
                "10.3.2.24",
                "10.3.3.23",
                "10.3.4.8",
                "10.6.3.33",
                "3.5.1.3.23",
                "3.5.1.3.24",
                "3.5.1.3.25",
                "3.5.1.3.26",
                "3.5.1.3.28",
                "3.5.1.3.29",
                "7.2.1.25",
                "7.2.2.25",
                "7.2.5.19",
                "7.2.6.4",
                "7.3.1.19",
                "7.3.2.19",
                "7.3.3.19",
                "8.2.7.19",
                "8.2.8.21",
                "8.3.4.19",
                "A1.1.2.14",
                "A1.1.2.15",
                "A1.1.2.16",
                "A1.1.2.17",
                "A1.1.2.19",
                "A1.1.2.20",
                "A1.1.3.30",
                "A1.1.3.31",
                "A1.1.3.32",
                "A1.1.3.33",
                "A1.1.3.34",
                "A1.1.3.35",
                "A1.2.1.31",
                "A3.4.1.16",
                "A3.4.1.17",
                "A3.4.1.18",
                "A3.4.1.19",
                "A3.4.1.21",
                "A3.4.1.22"
            ],
            "ENS-RD2022": [
                "op.mon.3.r5.az.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that the 'Public access level' configuration setting is set to 'Private (no anonymous access)' for all blob containers in your storage account in order to block anonymous access to these Microsoft Azure resources.",
        "title": "Ensure that the 'Public access level' is set to 'Private (no anonymous access)' for all blob containers in your storage account",
        "types": [],
        "uid": "prowler-azure-storage_blob_public_access_level_is_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Set 'Public access level' configuration setting to 'Private (no anonymous access)'",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/disable-blob-anonymous-access-for-storage-accounts.html"
        ]
    },
    "risk_details": "A user that accesses blob containers anonymously can use constructors that do not require credentials such as shared access signatures.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has allow blob public access enabled.",
    "metadata": {
        "event_code": "storage_blob_public_access_level_is_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has allow blob public access enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.7"
            ],
            "CIS-2.1": [
                "3.7"
            ],
            "CIS-3.0": [
                "4.6"
            ],
            "PCI-4.0": [
                "1.2.8.30",
                "1.2.8.31",
                "1.2.8.32",
                "1.2.8.33",
                "1.2.8.34",
                "1.2.8.35",
                "1.3.1.34",
                "1.3.1.35",
                "1.3.1.36",
                "1.3.1.37",
                "1.3.1.38",
                "1.3.1.39",
                "1.3.2.34",
                "1.3.2.35",
                "1.3.2.36",
                "1.3.2.37",
                "1.3.2.38",
                "1.3.2.39",
                "1.4.2.32",
                "1.4.2.33",
                "1.4.2.34",
                "1.4.2.35",
                "1.4.2.36",
                "1.4.2.37",
                "1.5.1.30",
                "1.5.1.31",
                "1.5.1.32",
                "1.5.1.33",
                "1.5.1.34",
                "1.5.1.35",
                "10.3.2.18",
                "10.3.2.19",
                "10.3.2.20",
                "10.3.2.21",
                "10.3.2.23",
                "10.3.2.24",
                "10.3.3.23",
                "10.3.4.8",
                "10.6.3.33",
                "3.5.1.3.23",
                "3.5.1.3.24",
                "3.5.1.3.25",
                "3.5.1.3.26",
                "3.5.1.3.28",
                "3.5.1.3.29",
                "7.2.1.25",
                "7.2.2.25",
                "7.2.5.19",
                "7.2.6.4",
                "7.3.1.19",
                "7.3.2.19",
                "7.3.3.19",
                "8.2.7.19",
                "8.2.8.21",
                "8.3.4.19",
                "A1.1.2.14",
                "A1.1.2.15",
                "A1.1.2.16",
                "A1.1.2.17",
                "A1.1.2.19",
                "A1.1.2.20",
                "A1.1.3.30",
                "A1.1.3.31",
                "A1.1.3.32",
                "A1.1.3.33",
                "A1.1.3.34",
                "A1.1.3.35",
                "A1.2.1.31",
                "A3.4.1.16",
                "A3.4.1.17",
                "A3.4.1.18",
                "A3.4.1.19",
                "A3.4.1.21",
                "A3.4.1.22"
            ],
            "ENS-RD2022": [
                "op.mon.3.r5.az.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that the 'Public access level' configuration setting is set to 'Private (no anonymous access)' for all blob containers in your storage account in order to block anonymous access to these Microsoft Azure resources.",
        "title": "Ensure that the 'Public access level' is set to 'Private (no anonymous access)' for all blob containers in your storage account",
        "types": [],
        "uid": "prowler-azure-storage_blob_public_access_level_is_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Set 'Public access level' configuration setting to 'Private (no anonymous access)'",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/disable-blob-anonymous-access-for-storage-accounts.html"
        ]
    },
    "risk_details": "A user that accesses blob containers anonymously can use constructors that do not require credentials such as shared access signatures.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has allow blob public access enabled.",
    "metadata": {
        "event_code": "storage_blob_public_access_level_is_disabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has allow blob public access enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.7"
            ],
            "CIS-2.1": [
                "3.7"
            ],
            "CIS-3.0": [
                "4.6"
            ],
            "PCI-4.0": [
                "1.2.8.30",
                "1.2.8.31",
                "1.2.8.32",
                "1.2.8.33",
                "1.2.8.34",
                "1.2.8.35",
                "1.3.1.34",
                "1.3.1.35",
                "1.3.1.36",
                "1.3.1.37",
                "1.3.1.38",
                "1.3.1.39",
                "1.3.2.34",
                "1.3.2.35",
                "1.3.2.36",
                "1.3.2.37",
                "1.3.2.38",
                "1.3.2.39",
                "1.4.2.32",
                "1.4.2.33",
                "1.4.2.34",
                "1.4.2.35",
                "1.4.2.36",
                "1.4.2.37",
                "1.5.1.30",
                "1.5.1.31",
                "1.5.1.32",
                "1.5.1.33",
                "1.5.1.34",
                "1.5.1.35",
                "10.3.2.18",
                "10.3.2.19",
                "10.3.2.20",
                "10.3.2.21",
                "10.3.2.23",
                "10.3.2.24",
                "10.3.3.23",
                "10.3.4.8",
                "10.6.3.33",
                "3.5.1.3.23",
                "3.5.1.3.24",
                "3.5.1.3.25",
                "3.5.1.3.26",
                "3.5.1.3.28",
                "3.5.1.3.29",
                "7.2.1.25",
                "7.2.2.25",
                "7.2.5.19",
                "7.2.6.4",
                "7.3.1.19",
                "7.3.2.19",
                "7.3.3.19",
                "8.2.7.19",
                "8.2.8.21",
                "8.3.4.19",
                "A1.1.2.14",
                "A1.1.2.15",
                "A1.1.2.16",
                "A1.1.2.17",
                "A1.1.2.19",
                "A1.1.2.20",
                "A1.1.3.30",
                "A1.1.3.31",
                "A1.1.3.32",
                "A1.1.3.33",
                "A1.1.3.34",
                "A1.1.3.35",
                "A1.2.1.31",
                "A3.4.1.16",
                "A3.4.1.17",
                "A3.4.1.18",
                "A3.4.1.19",
                "A3.4.1.21",
                "A3.4.1.22"
            ],
            "ENS-RD2022": [
                "op.mon.3.r5.az.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.1"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.6"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that the 'Public access level' configuration setting is set to 'Private (no anonymous access)' for all blob containers in your storage account in order to block anonymous access to these Microsoft Azure resources.",
        "title": "Ensure that the 'Public access level' is set to 'Private (no anonymous access)' for all blob containers in your storage account",
        "types": [],
        "uid": "prowler-azure-storage_blob_public_access_level_is_disabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Set 'Public access level' configuration setting to 'Private (no anonymous access)'",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-accounts-disallow-public-access#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/disable-blob-anonymous-access-for-storage-accounts.html"
        ]
    },
    "risk_details": "A user that accesses blob containers anonymously can use constructors that do not require credentials such as shared access signatures.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has network access rule set to Allow.",
    "metadata": {
        "event_code": "storage_default_network_access_rule_is_denied",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has network access rule set to Allow.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "All allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.",
        "compliance": {
            "CIS-2.0": [
                "3.8"
            ],
            "CIS-2.1": [
                "3.8"
            ],
            "CIS-3.0": [
                "4.7"
            ],
            "ENS-RD2022": [
                "op.exp.8.r4.az.sa.2"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access toselected networks, the default action must be changed.",
        "title": "Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
        "types": [],
        "uid": "prowler-azure-storage_default_network_access_rule_is_denied-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Storage Accounts 2. For each storage account, Click on the Networking blade 3. Click the Firewalls and virtual networks heading. 4. Ensure that you have elected to allow access from Selected networks 5. Add rules to allow traffic from specific network. 6. Click Save to apply your changes.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --default-action Deny",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/restrict-default-network-access.html"
        ]
    },
    "risk_details": "Storage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtualnetworks, allowing a secure network boundary for specific applications to be built.Access can also be granted to public internet IP address ranges to enable connectionsfrom specific internet or on-premises clients. When network rules are configured, onlyapplications from allowed networks can access a storage account. When calling from anallowed network, applications continue to require proper authorization (a valid accesskey or SAS token) to access the storage account.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has network access rule set to Deny.",
    "metadata": {
        "event_code": "storage_default_network_access_rule_is_denied",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has network access rule set to Deny.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "All allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.",
        "compliance": {
            "CIS-2.0": [
                "3.8"
            ],
            "CIS-2.1": [
                "3.8"
            ],
            "CIS-3.0": [
                "4.7"
            ],
            "ENS-RD2022": [
                "op.exp.8.r4.az.sa.2"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access toselected networks, the default action must be changed.",
        "title": "Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
        "types": [],
        "uid": "prowler-azure-storage_default_network_access_rule_is_denied-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Storage Accounts 2. For each storage account, Click on the Networking blade 3. Click the Firewalls and virtual networks heading. 4. Ensure that you have elected to allow access from Selected networks 5. Add rules to allow traffic from specific network. 6. Click Save to apply your changes.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --default-action Deny",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/restrict-default-network-access.html"
        ]
    },
    "risk_details": "Storage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtualnetworks, allowing a secure network boundary for specific applications to be built.Access can also be granted to public internet IP address ranges to enable connectionsfrom specific internet or on-premises clients. When network rules are configured, onlyapplications from allowed networks can access a storage account. When calling from anallowed network, applications continue to require proper authorization (a valid accesskey or SAS token) to access the storage account.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has network access rule set to Allow.",
    "metadata": {
        "event_code": "storage_default_network_access_rule_is_denied",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has network access rule set to Allow.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "All allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.",
        "compliance": {
            "CIS-2.0": [
                "3.8"
            ],
            "CIS-2.1": [
                "3.8"
            ],
            "CIS-3.0": [
                "4.7"
            ],
            "ENS-RD2022": [
                "op.exp.8.r4.az.sa.2"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.7"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access toselected networks, the default action must be changed.",
        "title": "Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
        "types": [],
        "uid": "prowler-azure-storage_default_network_access_rule_is_denied-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Storage Accounts 2. For each storage account, Click on the Networking blade 3. Click the Firewalls and virtual networks heading. 4. Ensure that you have elected to allow access from Selected networks 5. Add rules to allow traffic from specific network. 6. Click Save to apply your changes.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/set-default-network-access-rule-for-storage-accounts-to-deny#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --default-action Deny",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/restrict-default-network-access.html"
        ]
    },
    "risk_details": "Storage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtualnetworks, allowing a secure network boundary for specific applications to be built.Access can also be granted to public internet IP address ranges to enable connectionsfrom specific internet or on-premises clients. When network rules are configured, onlyapplications from allowed networks can access a storage account. When calling from anallowed network, applications continue to require proper authorization (a valid accesskey or SAS token) to access the storage account.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "metadata": {
        "event_code": "storage_ensure_azure_services_are_trusted_to_access_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.9"
            ],
            "CIS-2.1": [
                "3.9"
            ],
            "CIS-3.0": [
                "4.8"
            ],
            "PCI-4.0": [
                "10.6.3.35",
                "11.5.2.5",
                "11.6.1.5",
                "12.10.5.5",
                "7.2.1.27",
                "7.2.2.27",
                "7.2.5.21",
                "7.2.6.5",
                "7.3.1.21",
                "7.3.2.21",
                "7.3.3.21",
                "8.2.7.21",
                "8.2.8.23",
                "8.3.4.21",
                "A3.3.1.8",
                "A3.5.1.8"
            ],
            "ENS-RD2022": [
                "mp.info.6.r2.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled within your Azure Storage account configuration settings to grant access to trusted cloud services.",
        "title": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled for storage accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_azure_services_are_trusted_to_access_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "To allow these Azure services to work as intended and be able to access your storage account resources, you have to add an exception so that the trusted Microsoft Azure services can bypass your network rules",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --bypass AzureServices",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/enable-trusted-microsoft-services.html"
        ]
    },
    "risk_details": "Not allowing to access storage account by Azure services the following services: Azure Backup, Azure Event Grid, Azure Site Recovery, Azure DevTest Labs, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are not granted access to your storage account",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "metadata": {
        "event_code": "storage_ensure_azure_services_are_trusted_to_access_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa0169 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.9"
            ],
            "CIS-2.1": [
                "3.9"
            ],
            "CIS-3.0": [
                "4.8"
            ],
            "PCI-4.0": [
                "10.6.3.35",
                "11.5.2.5",
                "11.6.1.5",
                "12.10.5.5",
                "7.2.1.27",
                "7.2.2.27",
                "7.2.5.21",
                "7.2.6.5",
                "7.3.1.21",
                "7.3.2.21",
                "7.3.3.21",
                "8.2.7.21",
                "8.2.8.23",
                "8.3.4.21",
                "A3.3.1.8",
                "A3.5.1.8"
            ],
            "ENS-RD2022": [
                "mp.info.6.r2.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled within your Azure Storage account configuration settings to grant access to trusted cloud services.",
        "title": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled for storage accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_azure_services_are_trusted_to_access_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "To allow these Azure services to work as intended and be able to access your storage account resources, you have to add an exception so that the trusted Microsoft Azure services can bypass your network rules",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --bypass AzureServices",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/enable-trusted-microsoft-services.html"
        ]
    },
    "risk_details": "Not allowing to access storage account by Azure services the following services: Azure Backup, Azure Event Grid, Azure Site Recovery, Azure DevTest Labs, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are not granted access to your storage account",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "metadata": {
        "event_code": "storage_ensure_azure_services_are_trusted_to_access_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa026969 from subscription Azure for Students allows trusted Microsoft services to access this storage account.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.9"
            ],
            "CIS-2.1": [
                "3.9"
            ],
            "CIS-3.0": [
                "4.8"
            ],
            "PCI-4.0": [
                "10.6.3.35",
                "11.5.2.5",
                "11.6.1.5",
                "12.10.5.5",
                "7.2.1.27",
                "7.2.2.27",
                "7.2.5.21",
                "7.2.6.5",
                "7.3.1.21",
                "7.3.2.21",
                "7.3.3.21",
                "8.2.7.21",
                "8.2.8.23",
                "8.3.4.21",
                "A3.3.1.8",
                "A3.5.1.8"
            ],
            "ENS-RD2022": [
                "mp.info.6.r2.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.3"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.8"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled within your Azure Storage account configuration settings to grant access to trusted cloud services.",
        "title": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled for storage accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_azure_services_are_trusted_to_access_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "To allow these Azure services to work as intended and be able to access your storage account resources, you have to add an exception so that the trusted Microsoft Azure services can bypass your network rules",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/enable-trusted-microsoft-services-for-storage-account-access#terraform",
            "az storage account update --name <StorageAccountName> --resource-group <resourceGroupName> --bypass AzureServices",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/enable-trusted-microsoft-services.html"
        ]
    },
    "risk_details": "Not allowing to access storage account by Azure services the following services: Azure Backup, Azure Event Grid, Azure Site Recovery, Azure DevTest Labs, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are not granted access to your storage account",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students does not encrypt with CMKs.",
    "metadata": {
        "event_code": "storage_ensure_encryption_with_customer_managed_keys",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students does not encrypt with CMKs.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.12"
            ],
            "CIS-2.1": [
                "3.12"
            ],
            "CIS-3.0": [
                "4.11"
            ],
            "PCI-4.0": [
                "3.5.1.34",
                "8.3.2.53"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "title": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "types": [],
        "uid": "prowler-azure-storage_ensure_encryption_with_customer_managed_keys-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-storage-accounts-use-customer-managed-key-for-encryption#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/cmk-encryption.html"
        ]
    },
    "risk_details": "If you want to control and manage storage account contents encryption key yourself you must specify a customer-managed key",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students does not encrypt with CMKs.",
    "metadata": {
        "event_code": "storage_ensure_encryption_with_customer_managed_keys",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa0169 from subscription Azure for Students does not encrypt with CMKs.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.12"
            ],
            "CIS-2.1": [
                "3.12"
            ],
            "CIS-3.0": [
                "4.11"
            ],
            "PCI-4.0": [
                "3.5.1.34",
                "8.3.2.53"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "title": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "types": [],
        "uid": "prowler-azure-storage_ensure_encryption_with_customer_managed_keys-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-storage-accounts-use-customer-managed-key-for-encryption#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/cmk-encryption.html"
        ]
    },
    "risk_details": "If you want to control and manage storage account contents encryption key yourself you must specify a customer-managed key",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students does not encrypt with CMKs.",
    "metadata": {
        "event_code": "storage_ensure_encryption_with_customer_managed_keys",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students does not encrypt with CMKs.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.12"
            ],
            "CIS-2.1": [
                "3.12"
            ],
            "CIS-3.0": [
                "4.11"
            ],
            "PCI-4.0": [
                "3.5.1.34",
                "8.3.2.53"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ],
            "ProwlerThreatScore-1.0": [
                "4.2.1"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "title": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
        "types": [],
        "uid": "prowler-azure-storage_ensure_encryption_with_customer_managed_keys-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-that-storage-accounts-use-customer-managed-key-for-encryption#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/cmk-encryption.html"
        ]
    },
    "risk_details": "If you want to control and manage storage account contents encryption key yourself you must specify a customer-managed key",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has TLS version set to 1.2.",
    "metadata": {
        "event_code": "storage_ensure_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has TLS version set to 1.2.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.15"
            ],
            "CIS-2.1": [
                "3.15"
            ],
            "CIS-3.0": [
                "4.15"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.3"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "title": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "types": [],
        "uid": "prowler-azure-storage_ensure_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that all your Microsoft Azure Storage accounts are using the latest available version of the TLS protocol.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2#terraform",
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/minimum-tls-version.html"
        ]
    },
    "risk_details": "TLS versions 1.0 and 1.1 are known to be susceptible to certain Common Vulnerabilities and Exposures (CVE) weaknesses and attacks such as POODLE and BEAST",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has TLS version set to 1.2.",
    "metadata": {
        "event_code": "storage_ensure_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has TLS version set to 1.2.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.15"
            ],
            "CIS-2.1": [
                "3.15"
            ],
            "CIS-3.0": [
                "4.15"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.3"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "title": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "types": [],
        "uid": "prowler-azure-storage_ensure_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that all your Microsoft Azure Storage accounts are using the latest available version of the TLS protocol.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2#terraform",
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/minimum-tls-version.html"
        ]
    },
    "risk_details": "TLS versions 1.0 and 1.1 are known to be susceptible to certain Common Vulnerabilities and Exposures (CVE) weaknesses and attacks such as POODLE and BEAST",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has TLS version set to 1.2.",
    "metadata": {
        "event_code": "storage_ensure_minimum_tls_version_12",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has TLS version set to 1.2.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.15"
            ],
            "CIS-2.1": [
                "3.15"
            ],
            "CIS-3.0": [
                "4.15"
            ],
            "ENS-RD2022": [
                "mp.com.3.r2.az.tls.3"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ProwlerThreatScore-1.0": [
                "4.1.3"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "title": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
        "types": [],
        "uid": "prowler-azure-storage_ensure_minimum_tls_version_12-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that all your Microsoft Azure Storage accounts are using the latest available version of the TLS protocol.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2#terraform",
            "https://docs.prowler.com/checks/azure/azure-storage-policies/bc_azr_storage_2",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/minimum-tls-version.html"
        ]
    },
    "risk_details": "TLS versions 1.0 and 1.1 are known to be susceptible to certain Common Vulnerabilities and Exposures (CVE) weaknesses and attacks such as POODLE and BEAST",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students does not have private endpoint connections.",
    "metadata": {
        "event_code": "storage_ensure_private_endpoints_in_storage_accounts",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students does not have private endpoint connections.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-private-endpoints",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.10"
            ],
            "CIS-2.1": [
                "3.10"
            ],
            "CIS-3.0": [
                "4.9"
            ],
            "ENS-RD2022": [
                "mp.com.4.r2..az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.",
        "title": "Ensure Private Endpoints are used to access Storage Accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_private_endpoints_in_storage_accounts-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Use Private Endpoints to access Storage Accounts",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/private-endpoints.html#",
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Storage accounts that are not configured to use Private Endpoints are accessible over the public internet. This can lead to data exfiltration and other security issues.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has private endpoint connections.",
    "metadata": {
        "event_code": "storage_ensure_private_endpoints_in_storage_accounts",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has private endpoint connections.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-private-endpoints",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.10"
            ],
            "CIS-2.1": [
                "3.10"
            ],
            "CIS-3.0": [
                "4.9"
            ],
            "ENS-RD2022": [
                "mp.com.4.r2..az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.",
        "title": "Ensure Private Endpoints are used to access Storage Accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_private_endpoints_in_storage_accounts-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Use Private Endpoints to access Storage Accounts",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/private-endpoints.html#",
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Storage accounts that are not configured to use Private Endpoints are accessible over the public internet. This can lead to data exfiltration and other security issues.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students does not have private endpoint connections.",
    "metadata": {
        "event_code": "storage_ensure_private_endpoints_in_storage_accounts",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students does not have private endpoint connections.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-private-endpoints",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.10"
            ],
            "CIS-2.1": [
                "3.10"
            ],
            "CIS-3.0": [
                "4.9"
            ],
            "ENS-RD2022": [
                "mp.com.4.r2..az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ],
            "ProwlerThreatScore-1.0": [
                "2.2.9"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.",
        "title": "Ensure Private Endpoints are used to access Storage Accounts",
        "types": [],
        "uid": "prowler-azure-storage_ensure_private_endpoints_in_storage_accounts-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Use Private Endpoints to access Storage Accounts",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/private-endpoints.html#",
            "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
        ]
    },
    "risk_details": "Storage accounts that are not configured to use Private Endpoints are accessible over the public internet. This can lead to data exfiltration and other security issues.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has soft delete disabled.",
    "metadata": {
        "event_code": "storage_ensure_soft_delete_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has soft delete disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "Additional storage costs may be incurred as snapshots are retained.",
        "compliance": {
            "CIS-2.0": [
                "3.11"
            ],
            "CIS-2.1": [
                "3.11"
            ],
            "CIS-3.0": [
                "4.10"
            ],
            "PCI-4.0": [
                "10.3.2.22",
                "3.5.1.3.27",
                "8.4.1.5",
                "8.4.2.5",
                "8.4.3.5",
                "A1.1.2.18",
                "A3.4.1.20"
            ],
            "MITRE-ATTACK": [
                "T1485"
            ],
            "ISO27001-2022": [
                "A.8.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.",
        "title": "Ensure Soft Delete is Enabled for Azure Containers and Blob Storage",
        "types": [],
        "uid": "prowler-azure-storage_ensure_soft_delete_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From the Azure home page, open the hamburger menu in the top left or click on the arrow pointing right with 'More services' underneath. 2. Select Storage. 3. Select Storage Accounts. 4. For each Storage Account, navigate to Data protection in the left scroll column. 5. Check soft delete for both blobs and containers. Set the retention period to a sufficient length for your organization",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/enable-soft-delete.html#",
            "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete"
        ]
    },
    "risk_details": "Containers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the Retention policies ranging from 7 days to 365 days.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has soft delete disabled.",
    "metadata": {
        "event_code": "storage_ensure_soft_delete_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has soft delete disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "Additional storage costs may be incurred as snapshots are retained.",
        "compliance": {
            "CIS-2.0": [
                "3.11"
            ],
            "CIS-2.1": [
                "3.11"
            ],
            "CIS-3.0": [
                "4.10"
            ],
            "PCI-4.0": [
                "10.3.2.22",
                "3.5.1.3.27",
                "8.4.1.5",
                "8.4.2.5",
                "8.4.3.5",
                "A1.1.2.18",
                "A3.4.1.20"
            ],
            "MITRE-ATTACK": [
                "T1485"
            ],
            "ISO27001-2022": [
                "A.8.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.",
        "title": "Ensure Soft Delete is Enabled for Azure Containers and Blob Storage",
        "types": [],
        "uid": "prowler-azure-storage_ensure_soft_delete_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From the Azure home page, open the hamburger menu in the top left or click on the arrow pointing right with 'More services' underneath. 2. Select Storage. 3. Select Storage Accounts. 4. For each Storage Account, navigate to Data protection in the left scroll column. 5. Check soft delete for both blobs and containers. Set the retention period to a sufficient length for your organization",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/enable-soft-delete.html#",
            "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete"
        ]
    },
    "risk_details": "Containers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the Retention policies ranging from 7 days to 365 days.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has soft delete disabled.",
    "metadata": {
        "event_code": "storage_ensure_soft_delete_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has soft delete disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "Additional storage costs may be incurred as snapshots are retained.",
        "compliance": {
            "CIS-2.0": [
                "3.11"
            ],
            "CIS-2.1": [
                "3.11"
            ],
            "CIS-3.0": [
                "4.10"
            ],
            "PCI-4.0": [
                "10.3.2.22",
                "3.5.1.3.27",
                "8.4.1.5",
                "8.4.2.5",
                "8.4.3.5",
                "A1.1.2.18",
                "A3.4.1.20"
            ],
            "MITRE-ATTACK": [
                "T1485"
            ],
            "ISO27001-2022": [
                "A.8.10"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.",
        "title": "Ensure Soft Delete is Enabled for Azure Containers and Blob Storage",
        "types": [],
        "uid": "prowler-azure-storage_ensure_soft_delete_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "From the Azure home page, open the hamburger menu in the top left or click on the arrow pointing right with 'More services' underneath. 2. Select Storage. 3. Select Storage Accounts. 4. For each Storage Account, navigate to Data protection in the left scroll column. 5. Check soft delete for both blobs and containers. Set the retention period to a sufficient length for your organization",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/enable-soft-delete.html#",
            "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete"
        ]
    },
    "risk_details": "Containers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the Retention policies ranging from 7 days to 365 days.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has infrastructure encryption disabled.",
    "metadata": {
        "event_code": "storage_infrastructure_encryption_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has infrastructure encryption disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.2"
            ],
            "CIS-2.1": [
                "3.2"
            ],
            "CIS-3.0": [
                "4.3"
            ],
            "PCI-4.0": [
                "3.5.1.22",
                "8.3.2.37"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "title": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "types": [],
        "uid": "prowler-azure-storage_infrastructure_encryption_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureRole",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enabling double encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.",
        "references": []
    },
    "risk_details": "Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has infrastructure encryption disabled.",
    "metadata": {
        "event_code": "storage_infrastructure_encryption_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has infrastructure encryption disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.2"
            ],
            "CIS-2.1": [
                "3.2"
            ],
            "CIS-3.0": [
                "4.3"
            ],
            "PCI-4.0": [
                "3.5.1.22",
                "8.3.2.37"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "title": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "types": [],
        "uid": "prowler-azure-storage_infrastructure_encryption_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureRole",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enabling double encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.",
        "references": []
    },
    "risk_details": "Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has infrastructure encryption disabled.",
    "metadata": {
        "event_code": "storage_infrastructure_encryption_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has infrastructure encryption disabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.2"
            ],
            "CIS-2.1": [
                "3.2"
            ],
            "CIS-3.0": [
                "4.3"
            ],
            "PCI-4.0": [
                "3.5.1.22",
                "8.3.2.37"
            ],
            "ENS-RD2022": [
                "op.exp.10.az.kv.2"
            ],
            "MITRE-ATTACK": [
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.5",
                "A.8.11",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "title": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
        "types": [],
        "uid": "prowler-azure-storage_infrastructure_encryption_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureRole",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enabling double encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.",
        "references": []
    },
    "risk_details": "Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has no key expiration period set.",
    "metadata": {
        "event_code": "storage_key_rotation_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has no key expiration period set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.4"
            ],
            "CIS-2.1": [
                "3.4"
            ],
            "CIS-3.0": [
                "4.4"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "title": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "types": [],
        "uid": "prowler-azure-storage_key_rotation_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that Azure Storage account access keys are regenerated every 90 days in order to decrease the likelihood of accidental exposures and protect your storage account resources against unauthorized access.",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/regenerate-storage-account-access-keys-periodically.html#",
            "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-create?tabs=azure-portal#regenerate-storage-access-keys"
        ]
    },
    "risk_details": "If the access keys are not regenerated periodically, the likelihood of accidental exposures increases, which can lead to unauthorized access to your storage account resources.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has no key expiration period set.",
    "metadata": {
        "event_code": "storage_key_rotation_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has no key expiration period set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.4"
            ],
            "CIS-2.1": [
                "3.4"
            ],
            "CIS-3.0": [
                "4.4"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "title": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "types": [],
        "uid": "prowler-azure-storage_key_rotation_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that Azure Storage account access keys are regenerated every 90 days in order to decrease the likelihood of accidental exposures and protect your storage account resources against unauthorized access.",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/regenerate-storage-account-access-keys-periodically.html#",
            "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-create?tabs=azure-portal#regenerate-storage-access-keys"
        ]
    },
    "risk_details": "If the access keys are not regenerated periodically, the likelihood of accidental exposures increases, which can lead to unauthorized access to your storage account resources.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has no key expiration period set.",
    "metadata": {
        "event_code": "storage_key_rotation_90_days",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has no key expiration period set.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.4"
            ],
            "CIS-2.1": [
                "3.4"
            ],
            "CIS-3.0": [
                "4.4"
            ],
            "ENS-RD2022": [
                "op.acc.6.r1.az.eid.2"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "title": "Ensure that Storage Account Access Keys are Periodically Regenerated",
        "types": [],
        "uid": "prowler-azure-storage_key_rotation_90_days-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Ensure that Azure Storage account access keys are regenerated every 90 days in order to decrease the likelihood of accidental exposures and protect your storage account resources against unauthorized access.",
        "references": [
            "https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/azure/StorageAccounts/regenerate-storage-account-access-keys-periodically.html#",
            "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-create?tabs=azure-portal#regenerate-storage-access-keys"
        ]
    },
    "risk_details": "If the access keys are not regenerated periodically, the likelihood of accidental exposures increases, which can lead to unauthorized access to your storage account resources.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account csb10032000e64cb007 from subscription Azure for Students has secure transfer required enabled.",
    "metadata": {
        "event_code": "storage_secure_transfer_required_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account csb10032000e64cb007 from subscription Azure for Students has secure transfer required enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.1"
            ],
            "CIS-2.1": [
                "3.1"
            ],
            "CIS-3.0": [
                "4.1"
            ],
            "PCI-4.0": [
                "1.2.5.15",
                "2.2.5.15",
                "2.2.7.19",
                "3.5.1.30",
                "4.2.1.1.27",
                "4.2.1.19",
                "8.3.2.48",
                "8.3.2.49"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.12",
                "A.8.14",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "title": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "types": [],
        "uid": "prowler-azure-storage_secure_transfer_required_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-csb10032000e64cb007"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007",
                    "name": "csb10032000e64cb007",
                    "resouce_group_name": "cloud-shell-storage-westeurope",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": false,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "csb10032000e64cb007",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/cloud-shell-storage-westeurope/providers/Microsoft.Storage/storageAccounts/csb10032000e64cb007"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable data encryption in transit.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-account-enables-secure-transfer",
            "az storage account update --name <STORAGE_ACCOUNT_NAME> --https-only true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/secure-transfer-required.html"
        ]
    },
    "risk_details": "Requests to the storage account sent outside of a secure connection can be eavesdropped",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa0169 from subscription Azure for Students has secure transfer required enabled.",
    "metadata": {
        "event_code": "storage_secure_transfer_required_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa0169 from subscription Azure for Students has secure transfer required enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.1"
            ],
            "CIS-2.1": [
                "3.1"
            ],
            "CIS-3.0": [
                "4.1"
            ],
            "PCI-4.0": [
                "1.2.5.15",
                "2.2.5.15",
                "2.2.7.19",
                "3.5.1.30",
                "4.2.1.1.27",
                "4.2.1.19",
                "8.3.2.48",
                "8.3.2.49"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.12",
                "A.8.14",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "title": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "types": [],
        "uid": "prowler-azure-storage_secure_transfer_required_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa0169"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169",
                    "name": "sa0169",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Deny"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/privateEndpointConnections/sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "name": "sa0169.f09aef68-beea-440a-8335-41a85192d837",
                            "type": "Microsoft.Storage/storageAccounts/privateEndpointConnections"
                        }
                    ],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa0169",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa0169"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable data encryption in transit.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-account-enables-secure-transfer",
            "az storage account update --name <STORAGE_ACCOUNT_NAME> --https-only true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/secure-transfer-required.html"
        ]
    },
    "risk_details": "Requests to the storage account sent outside of a secure connection can be eavesdropped",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Storage account sa026969 from subscription Azure for Students has secure transfer required enabled.",
    "metadata": {
        "event_code": "storage_secure_transfer_required_is_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account sa026969 from subscription Azure for Students has secure transfer required enabled.",
    "status_id": 1,
    "unmapped": {
        "related_url": "",
        "categories": [
            "encryption"
        ],
        "depends_on": [],
        "related_to": [],
        "notes": "",
        "compliance": {
            "CIS-2.0": [
                "3.1"
            ],
            "CIS-2.1": [
                "3.1"
            ],
            "CIS-3.0": [
                "4.1"
            ],
            "PCI-4.0": [
                "1.2.5.15",
                "2.2.5.15",
                "2.2.7.19",
                "3.5.1.30",
                "4.2.1.1.27",
                "4.2.1.19",
                "8.3.2.48",
                "8.3.2.49"
            ],
            "ENS-RD2022": [
                "mp.com.3.az.sa.1"
            ],
            "MITRE-ATTACK": [
                "T1040"
            ],
            "ISO27001-2022": [
                "A.8.12",
                "A.8.14",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "title": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
        "types": [],
        "uid": "prowler-azure-storage_secure_transfer_required_is_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-sa026969"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969",
                    "name": "sa026969",
                    "resouce_group_name": "terrasec",
                    "enable_https_traffic_only": true,
                    "infrastructure_encryption": null,
                    "allow_blob_public_access": true,
                    "network_rule_set": {
                        "bypass": "AzureServices",
                        "default_action": "Allow"
                    },
                    "encryption_type": "Microsoft.Storage",
                    "minimum_tls_version": "TLS1_2",
                    "private_endpoint_connections": [],
                    "key_expiration_period_in_days": null,
                    "location": "westeurope",
                    "blob_properties": {
                        "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969/blobServices/default",
                        "name": "default",
                        "type": "Microsoft.Storage/storageAccounts/blobServices",
                        "default_service_version": null,
                        "container_delete_retention_policy": {
                            "enabled": false,
                            "days": 0
                        }
                    }
                }
            },
            "group": {
                "name": "storage"
            },
            "labels": [],
            "name": "sa026969",
            "type": "AzureStorageAccount",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Storage/storageAccounts/sa026969"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Enable data encryption in transit.",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-networking-policies/ensure-that-storage-account-enables-secure-transfer",
            "az storage account update --name <STORAGE_ACCOUNT_NAME> --https-only true",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/secure-transfer-required.html"
        ]
    },
    "risk_details": "Requests to the storage account sent outside of a secure connection can be eavesdropped",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Disk '32361818-afa6-4810-8cc6-0fcfe0f7cfbf' is not encrypted with a customer-managed key in subscription Azure for Students.",
    "metadata": {
        "event_code": "vm_ensure_attached_disks_encrypted_with_cmk",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Disk '32361818-afa6-4810-8cc6-0fcfe0f7cfbf' is not encrypted with a customer-managed key in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Using CMK/BYOK will entail additional management of keys.",
        "compliance": {
            "CIS-2.0": [
                "7.3"
            ],
            "CIS-2.1": [
                "7.3"
            ],
            "CIS-3.0": [
                "8.3"
            ],
            "MITRE-ATTACK": [
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.11",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE).",
        "title": "Ensure that 'OS and Data' disks are encrypted with Customer Managed Key (CMK)",
        "types": [],
        "uid": "prowler-azure-vm_ensure_attached_disks_encrypted_with_cmk-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/disks/vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                    "resource_name": "vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                    "vms_attached": [
                        "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/volt_value/providers/Microsoft.Compute/virtualMachines/vv-vm-01"
                    ],
                    "encryption_type": "EncryptionAtRestWithPlatformKey",
                    "location": "polandcentral"
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/disks/vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "Note: Disks must be detached from VMs to have encryption changed. 1. Go to Virtual machines 2. For each virtual machine, go to Settings 3. Click on Disks 4. Click the ellipsis (...), then click Detach to detach the disk from the VM 5. Now search for Disks and locate the unattached disk 6. Click the disk then select Encryption 7. Change your encryption type, then select your encryption set 8. Click Save 9. Go back to the VM and re-attach the disk",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_1#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/VirtualMachines/sse-boot-disk-cmk.html#",
            "https://learn.microsoft.com/en-us/azure/security/fundamentals/data-encryption-best-practices#protect-data-at-rest"
        ]
    },
    "risk_details": "Encrypting the IaaS VM's OS disk (boot volume) and Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key, thus protecting the volume from unwanted reads. PMK (Platform Managed Keys) are enabled by default in Azure-managed disks and allow encryption at rest. CMK is recommended because it gives the customer the option to control which specific keys are used for the encryption and decryption of the disk. The customer can then change keys and increase security by disabling them instead of relying on the PMK key that remains unchanging. There is also the option to increase security further by using automatically rotating keys so that access to disk is ensured to be limited. Organizations should evaluate what their security requirements are, however, for the data stored on the disk. For high-risk data using CMK is a must, as it provides extra steps of security. If the data is low risk, PMK is enabled by default and provides sufficient data security.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "Disk '948d35bc-62bf-4afe-be3a-47fca5fbc7e9' is not encrypted with a customer-managed key in subscription Azure for Students.",
    "metadata": {
        "event_code": "vm_ensure_attached_disks_encrypted_with_cmk",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Disk '948d35bc-62bf-4afe-be3a-47fca5fbc7e9' is not encrypted with a customer-managed key in subscription Azure for Students.",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/disk-encryption-overview",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Using CMK/BYOK will entail additional management of keys.",
        "compliance": {
            "CIS-2.0": [
                "7.3"
            ],
            "CIS-2.1": [
                "7.3"
            ],
            "CIS-3.0": [
                "8.3"
            ],
            "MITRE-ATTACK": [
                "T1119",
                "T1530"
            ],
            "ISO27001-2022": [
                "A.8.11",
                "A.8.24"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE).",
        "title": "Ensure that 'OS and Data' disks are encrypted with Customer Managed Key (CMK)",
        "types": [],
        "uid": "prowler-azure-vm_ensure_attached_disks_encrypted_with_cmk-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/disks/vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                    "resource_name": "vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                    "vms_attached": [
                        "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Compute/virtualMachines/vm-01"
                    ],
                    "encryption_type": "EncryptionAtRestWithPlatformKey",
                    "location": "westeurope"
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/disks/vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "Note: Disks must be detached from VMs to have encryption changed. 1. Go to Virtual machines 2. For each virtual machine, go to Settings 3. Click on Disks 4. Click the ellipsis (...), then click Detach to detach the disk from the VM 5. Now search for Disks and locate the unattached disk 6. Click the disk then select Encryption 7. Change your encryption type, then select your encryption set 8. Click Save 9. Go back to the VM and re-attach the disk",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/bc_azr_general_1#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/VirtualMachines/sse-boot-disk-cmk.html#",
            "https://learn.microsoft.com/en-us/azure/security/fundamentals/data-encryption-best-practices#protect-data-at-rest"
        ]
    },
    "risk_details": "Encrypting the IaaS VM's OS disk (boot volume) and Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key, thus protecting the volume from unwanted reads. PMK (Platform Managed Keys) are enabled by default in Azure-managed disks and allow encryption at rest. CMK is recommended because it gives the customer the option to control which specific keys are used for the encryption and decryption of the disk. The customer can then change keys and increase security by disabling them instead of relying on the PMK key that remains unchanging. There is also the option to increase security further by using automatically rotating keys so that access to disk is ensured to be limited. Organizations should evaluate what their security requirements are, however, for the data stored on the disk. For high-risk data using CMK is a must, as it provides extra steps of security. If the data is low risk, PMK is enabled by default and provides sufficient data security.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "VM vv-vm-01 is using managed disks in subscription Azure for Students",
    "metadata": {
        "event_code": "vm_ensure_using_managed_disks",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "VM vv-vm-01 is using managed disks in subscription Azure for Students",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/unmanaged-disks-deprecation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "There are additional costs for managed disks based off of disk space allocated. When converting to managed disks, VMs will be powered off and back on.",
        "compliance": {
            "CIS-2.0": [
                "7.2"
            ],
            "CIS-2.1": [
                "7.2"
            ],
            "CIS-3.0": [
                "8.2"
            ],
            "PCI-4.0": [
                "10.5.1.7",
                "3.2.1.6",
                "3.3.1.1.6",
                "3.3.1.3.6",
                "3.3.2.6",
                "3.3.3.6",
                "3.5.1.13",
                "8.3.2.20"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Migrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include: 1. Default Disk Encryption 2. Resilience, as Microsoft will managed the disk storage and move around if underlying hardware goes faulty 3. Reduction of costs over storage accounts",
        "title": "Ensure Virtual Machines are utilizing Managed Disks",
        "types": [],
        "uid": "prowler-azure-vm_ensure_using_managed_disks-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01",
                    "resource_name": "vv-vm-01",
                    "location": "polandcentral",
                    "security_profile": {
                        "additional_properties": {},
                        "uefi_settings": {
                            "additional_properties": {},
                            "secure_boot_enabled": true,
                            "v_tpm_enabled": true
                        },
                        "encryption_at_host": null,
                        "security_type": "TrustedLaunch",
                        "encryption_identity": null,
                        "proxy_agent_settings": null
                    },
                    "extensions": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01/extensions/AADSSHLoginForLinux"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01/extensions/enablevmAccess"
                        }
                    ],
                    "storage_profile": {
                        "os_disk": {
                            "name": "vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                            "managed_disk": {
                                "additional_properties": {},
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/disks/vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                                "storage_account_type": "Premium_LRS",
                                "disk_encryption_set": null,
                                "security_profile": null
                            }
                        },
                        "data_disks": []
                    }
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vv-vm-01",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "1. Using the search feature, go to Virtual Machines 2. Select the virtual machine you would like to convert 3. Select Disks in the menu for the VM 4. At the top select Migrate to managed disks 5. You may follow the prompts to convert the disk and finish by selecting Migrate to start the process",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-virtual-machines-are-utilizing-managed-disks#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/VirtualMachines/managed-disks-in-use.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-4-enable-data-at-rest-encryption-by-default"
        ]
    },
    "risk_details": "Managed disks are by default encrypted on the underlying hardware, so no additional encryption is required for basic protection. It is available if additional encryption is required. Managed disks are by design more resilient that storage accounts. For ARM-deployed Virtual Machines, Azure Adviser will at some point recommend moving VHDs to managed disks both from a security and cost management perspective.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "VM vm-01 is using managed disks in subscription Azure for Students",
    "metadata": {
        "event_code": "vm_ensure_using_managed_disks",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "VM vm-01 is using managed disks in subscription Azure for Students",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/unmanaged-disks-deprecation",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "There are additional costs for managed disks based off of disk space allocated. When converting to managed disks, VMs will be powered off and back on.",
        "compliance": {
            "CIS-2.0": [
                "7.2"
            ],
            "CIS-2.1": [
                "7.2"
            ],
            "CIS-3.0": [
                "8.2"
            ],
            "PCI-4.0": [
                "10.5.1.7",
                "3.2.1.6",
                "3.3.1.1.6",
                "3.3.1.3.6",
                "3.3.2.6",
                "3.3.3.6",
                "3.5.1.13",
                "8.3.2.20"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "Migrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include: 1. Default Disk Encryption 2. Resilience, as Microsoft will managed the disk storage and move around if underlying hardware goes faulty 3. Reduction of costs over storage accounts",
        "title": "Ensure Virtual Machines are utilizing Managed Disks",
        "types": [],
        "uid": "prowler-azure-vm_ensure_using_managed_disks-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-vm-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/virtualMachines/vm-01",
                    "resource_name": "vm-01",
                    "location": "westeurope",
                    "security_profile": null,
                    "extensions": [],
                    "storage_profile": {
                        "os_disk": {
                            "name": "vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                            "managed_disk": {
                                "additional_properties": {},
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Compute/disks/vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                                "storage_account_type": "Standard_LRS",
                                "disk_encryption_set": null,
                                "security_profile": null
                            }
                        },
                        "data_disks": []
                    }
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vm-01",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/virtualMachines/vm-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Using the search feature, go to Virtual Machines 2. Select the virtual machine you would like to convert 3. Select Disks in the menu for the VM 4. At the top select Migrate to managed disks 5. You may follow the prompts to convert the disk and finish by selecting Migrate to start the process",
        "references": [
            "https://docs.prowler.com/checks/azure/azure-general-policies/ensure-virtual-machines-are-utilizing-managed-disks#terraform",
            "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/VirtualMachines/managed-disks-in-use.html",
            "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-data-protection#dp-4-enable-data-at-rest-encryption-by-default"
        ]
    },
    "risk_details": "Managed disks are by default encrypted on the underlying hardware, so no additional encryption is required for basic protection. It is available if additional encryption is required. Managed disks are by design more resilient that storage accounts. For ARM-deployed Virtual Machines, Azure Adviser will at some point recommend moving VHDs to managed disks both from a security and cost management perspective.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "VM vv-vm-01 has trusted launch enabled in subscription Azure for Students",
    "metadata": {
        "event_code": "vm_trusted_launch_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "VM vv-vm-01 has trusted launch enabled in subscription Azure for Students",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/trusted-launch-existing-vm?tabs=portal",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secure Boot and vTPM are not currently supported for Azure Generation 1 VMs. IMPORTANT: Before enabling Secure Boot and vTPM on a Generation 2 VM which does not already have both enabled, it is highly recommended to create a restore point of the VM prior to remediation.",
        "compliance": {
            "CIS-2.1": [
                "7.9"
            ],
            "CIS-3.0": [
                "8.11"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "When Secure Boot and vTPM are enabled together, they provide a strong foundation for protecting your VM from boot attacks. For example, if an attacker attempts to replace the bootloader with a malicious version, Secure Boot will prevent the VM from booting. If the attacker is able to bypass Secure Boot and install a malicious bootloader, vTPM can be used to detect the intrusion and alert you.",
        "title": "Ensure Trusted Launch is enabled on Virtual Machines",
        "types": [],
        "uid": "prowler-azure-vm_trusted_launch_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-polandcentral-vv-vm-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "polandcentral",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01",
                    "resource_name": "vv-vm-01",
                    "location": "polandcentral",
                    "security_profile": {
                        "additional_properties": {},
                        "uefi_settings": {
                            "additional_properties": {},
                            "secure_boot_enabled": true,
                            "v_tpm_enabled": true
                        },
                        "encryption_at_host": null,
                        "security_type": "TrustedLaunch",
                        "encryption_identity": null,
                        "proxy_agent_settings": null
                    },
                    "extensions": [
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01/extensions/AADSSHLoginForLinux"
                        },
                        {
                            "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01/extensions/enablevmAccess"
                        }
                    ],
                    "storage_profile": {
                        "os_disk": {
                            "name": "vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                            "managed_disk": {
                                "additional_properties": {},
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/disks/vv-vm-01_OsDisk_1_32361818afa648108cc60fcfe0f7cfbf",
                                "storage_account_type": "Premium_LRS",
                                "disk_encryption_set": null,
                                "security_profile": null
                            }
                        },
                        "data_disks": []
                    }
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vv-vm-01",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/VOLT_VALUE/providers/Microsoft.Compute/virtualMachines/vv-vm-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "polandcentral"
    },
    "remediation": {
        "desc": "1. Go to Virtual Machines 2. For each VM, under Settings, click on Configuration on the left blade 3. Under Security Type, select 'Trusted Launch Virtual Machines' 4. Make sure Enable Secure Boot & Enable vTPM are checked 5. Click on Apply.",
        "references": [
            "https://learn.microsoft.com/en-us/azure/virtual-machines/trusted-launch-existing-vm?tabs=portal#enable-trusted-launch-on-existing-vm"
        ]
    },
    "risk_details": "Secure Boot and vTPM work together to protect your VM from a variety of boot attacks, including bootkits, rootkits, and firmware rootkits. Not enabling Trusted Launch in Azure VM can lead to increased vulnerability to rootkits and boot-level malware, reduced ability to detect and prevent unauthorized changes to the boot process, and a potential compromise of system integrity and data security.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
},{
    "message": "VM vm-01 has trusted launch disabled in subscription Azure for Students",
    "metadata": {
        "event_code": "vm_trusted_launch_enabled",
        "product": {
            "name": "Prowler",
            "uid": "prowler",
            "vendor_name": "Prowler",
            "version": "5.7.1"
        },
        "profiles": [
            "cloud",
            "datetime"
        ],
        "tenant_uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db",
        "version": "1.4.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "VM vm-01 has trusted launch disabled in subscription Azure for Students",
    "status_id": 1,
    "unmapped": {
        "related_url": "https://learn.microsoft.com/en-us/azure/virtual-machines/trusted-launch-existing-vm?tabs=portal",
        "categories": [],
        "depends_on": [],
        "related_to": [],
        "notes": "Secure Boot and vTPM are not currently supported for Azure Generation 1 VMs. IMPORTANT: Before enabling Secure Boot and vTPM on a Generation 2 VM which does not already have both enabled, it is highly recommended to create a restore point of the VM prior to remediation.",
        "compliance": {
            "CIS-2.1": [
                "7.9"
            ],
            "CIS-3.0": [
                "8.11"
            ],
            "ISO27001-2022": [
                "A.8.14"
            ]
        }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
        "created_time": 1747858815,
        "created_time_dt": "2025-05-21T20:20:15.306815",
        "desc": "When Secure Boot and vTPM are enabled together, they provide a strong foundation for protecting your VM from boot attacks. For example, if an attacker attempts to replace the bootloader with a malicious version, Secure Boot will prevent the VM from booting. If the attacker is able to bypass Secure Boot and install a malicious bootloader, vTPM can be used to detect the intrusion and alert you.",
        "title": "Ensure Trusted Launch is enabled on Virtual Machines",
        "types": [],
        "uid": "prowler-azure-vm_trusted_launch_enabled-31661dbb-923c-429d-b434-b6bd19dcd287-westeurope-vm-01"
    },
    "resources": [
        {
            "cloud_partition": "AzureCloud",
            "region": "westeurope",
            "data": {
                "details": "",
                "metadata": {
                    "resource_id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/virtualMachines/vm-01",
                    "resource_name": "vm-01",
                    "location": "westeurope",
                    "security_profile": null,
                    "extensions": [],
                    "storage_profile": {
                        "os_disk": {
                            "name": "vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                            "managed_disk": {
                                "additional_properties": {},
                                "id": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/terrasec/providers/Microsoft.Compute/disks/vm-01_disk1_948d35bc62bf4afebe3a47fca5fbc7e9",
                                "storage_account_type": "Standard_LRS",
                                "disk_encryption_set": null,
                                "security_profile": null
                            }
                        },
                        "data_disks": []
                    }
                }
            },
            "group": {
                "name": "vm"
            },
            "labels": [],
            "name": "vm-01",
            "type": "Microsoft.Compute/virtualMachines",
            "uid": "/subscriptions/31661dbb-923c-429d-b434-b6bd19dcd287/resourceGroups/TERRASEC/providers/Microsoft.Compute/virtualMachines/vm-01"
        }
    ],
    "category_name": "Findings",
    "category_uid": 2,
    "class_name": "Detection Finding",
    "class_uid": 2004,
    "cloud": {
        "account": {
            "name": "Azure for Students",
            "type": "Azure AD Account",
            "type_id": 6,
            "uid": "31661dbb-923c-429d-b434-b6bd19dcd287",
            "labels": []
        },
        "org": {
            "name": "Unknown tenant domain (missing AAD permissions)",
            "uid": "d0da435b-a7e7-4d74-a4ae-f72cf8f3b2db"
        },
        "provider": "azure",
        "region": "westeurope"
    },
    "remediation": {
        "desc": "1. Go to Virtual Machines 2. For each VM, under Settings, click on Configuration on the left blade 3. Under Security Type, select 'Trusted Launch Virtual Machines' 4. Make sure Enable Secure Boot & Enable vTPM are checked 5. Click on Apply.",
        "references": [
            "https://learn.microsoft.com/en-us/azure/virtual-machines/trusted-launch-existing-vm?tabs=portal#enable-trusted-launch-on-existing-vm"
        ]
    },
    "risk_details": "Secure Boot and vTPM work together to protect your VM from a variety of boot attacks, including bootkits, rootkits, and firmware rootkits. Not enabling Trusted Launch in Azure VM can lead to increased vulnerability to rootkits and boot-level malware, reduced ability to detect and prevent unauthorized changes to the boot process, and a potential compromise of system integrity and data security.",
    "time": 1747858815,
    "time_dt": "2025-05-21T20:20:15.306815",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create"
}]